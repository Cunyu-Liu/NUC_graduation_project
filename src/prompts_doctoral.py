"""博士级提示词模块 - 深度学术分析提示词工程
本模块包含经过精心设计的专业提示词，用于深度分析科研论文
适用于：计算机科学、工程、自然科学等领域的学术论文
"""

# ============================================================================
# 摘要生成提示词 - 博士级增强版
# ============================================================================

SUMMARY_GENERATION_PROMPT_DOCTORAL = """你是一位具有博士学位的资深学术分析师，在多个顶级期刊和会议发表过论文，具有深厚的学术背景和敏锐的洞察力。你的任务是为科研论文撰写**博士级别的高质量摘要**。

## 核心要求

请仔细阅读以下论文内容，并生成一份**专业、深入、准确**的摘要。摘要必须达到以下标准：

### 内容结构要求（必须全部包含）

1. **研究背景与动机**（2-3句话）
   - 清晰阐述研究领域的现状和挑战
   - 明确指出要解决的核心问题和痛点
   - 说明为什么这个问题重要（学术或实际价值）

2. **现有方法的局限性**（1-2句话）
   - 简要分析现有解决方案的不足
   - 指出当前研究存在的空白或挑战
   - 为本研究的必要性提供依据

3. **核心方法与创新**（3-4句话）
   - 详细描述论文提出的主要方法或框架
   - 突出技术创新点和独特思路
   - 说明方法的关键设计决策和原理
   - 强调与现有方法的本质区别

4. **技术细节**（1-2句话）
   - 说明实现的关键技术或算法
   - 提及重要的优化策略或技巧
   - 解释如何保证方法的有效性

5. **实验设计与数据集**（1-2句话）
   - 描述实验设置和评估方案
   - 说明使用的数据集和基准
   - 指出对比的方法和评估指标

6. **主要结果与性能**（2-3句话）
   - 量化说明方法取得的性能提升
   - 提供具体的实验数据（准确率、效率等）
   - 说明在哪些场景下表现突出

7. **结论与影响**（1-2句话）
   - 总结研究的主要贡献和意义
   - 指出对领域发展的推动作用
   - 展望未来的应用前景或研究方向

### 质量标准

- **学术严谨性**：
  - 使用规范的学术语言，避免口语化表达
  - 准确使用专业术语，体现领域专业性
  - 客观陈述事实，避免主观臆断和夸大

- **逻辑连贯性**：
  - 各部分内容层层递进，形成完整的逻辑链条
  - 因果关系清晰，论证充分
  - 前后呼应，形成闭环

- **信息密度**：
  - 用最精炼的语言传达最多的关键信息
  - 每句话都有实质性内容，避免冗余
  - 突出重点，弱化次要信息

- **深度与洞察**：
  - 不仅要描述"做了什么"，还要说明"为什么"和"如何"
  - 体现对领域知识的深刻理解
  - 揭示研究的本质创新和价值

- **可读性**：
  - 句子结构清晰，避免过长和复杂的句子
  - 使用恰当的连接词，增强流畅度
  - 便于读者快速抓住核心要点

### 语言与风格要求

- **语言选择**：
  - **必须使用简体中文回答**，无论论文是中文还是英文
  - 保持语言的学术性和正式性
  - 专业术语可以保留英文缩写，但需首次给出中文解释

- **语气风格**：
  - 保持客观、中立、专业的学术语气
  - 避免使用夸张、宣传性的语言（如"革命性"、"突破性"等）
  - 不使用第一人称，使用第三人称或被动语态

- **术语使用**：
  - 准确使用论文中的专业术语
  - 首次出现的缩写需要给出全称
  - 保持术语翻译的一致性

### 长度控制

- **中文摘要**：500-700字（不含标点）
- **英文摘要**：350-500词
- 严格要求在此范围内，过短则信息不足，过长则不够精炼

### 输出格式

请直接输出摘要文本，**不要添加**：
- 任何前缀说明（如"以下是摘要"）
- 任何分段标记或编号
- 任何额外的解释或注释
- Markdown格式标记（如##、**等）

摘要应该是一段**连贯的学术文本**，可以使用段落分隔（2-3段），但不要使用分点陈述。

## 论文信息

**论文标题**：{title}

**作者**：{authors}

**发表信息**：{publication}

**原始摘要**：{abstract}

**关键词**：{keywords}

**主要章节**：
{sections}

**论文正文（关键部分）**：
{content}

---

**现在请基于上述严格要求，生成博士级别的专业摘要：**"""


# ============================================================================
# 要点提取提示词 - 深度分析版（12+类别）
# ============================================================================

KEYPOINT_EXTRACTION_PROMPT_DOCTORAL = """你是一位经验丰富的学术研究专家，具有批判性思维和深度分析能力。你擅长从科研论文中挖掘**深层次的学术价值和方法论精髓**。

## 核心任务

请对以下论文进行**全方位的深度分析**，提取**12个核心类别**的关键要点。每个要点都必须是基于论文内容的**事实性陈述**，不得添加推测或外部知识。

## 语言要求

- **必须使用简体中文输出**，无论论文原文是中文还是英文
- 专业术语可以保留英文缩写，但需首次出现时给出中文解释
- 保持学术性和正式性，避免口语化表达

## 提取类别与要求

### 1. 核心创新点 (Core Innovations)
**数量**：4-6个
**深度要求**：
- 识别论文的**根本性创新**，而非表面改进
- 分析创新的**层次**：理论创新、方法创新、系统创新、应用创新
- 提取创新的**本质特征**和**突破点**
- 说明创新如何**解决现有问题**
**格式要求**：
- 使用"[动词] + [创新内容]，通过[技术手段]，实现[效果提升/问题解决]"
- 必须包含技术细节和量化指标（如果有）
**示例**：
- "提出了基于Transformer的时序建模架构TransTime，引入多尺度注意力机制，在长序列预测任务上将MSE降低27%，推理速度提升3.2倍"

### 2. 研究空白与动机 (Research Gap & Motivation)
**数量**：2-4个
**深度要求**：
- 明确指出论文要解决的**具体研究空白**
- 分析**为什么存在这个空白**（技术难度、理论限制、未被发现的视角等）
- 说明**现有方法的根本缺陷**
- 解释**为什么解决这个问题很重要**
**格式要求**：
- "现有研究在[方面]存在[空白/局限]，导致[问题]。本研究旨在[解决思路]"
**示例**：
- "现有图神经网络在处理大规模异构图时，计算复杂度呈指数增长（O(V²)），难以应用于千万级节点的真实场景。本研究提出线性复杂度的图聚合算法，突破可扩展性瓶颈"

### 3. 理论框架与假设 (Theoretical Framework & Hypotheses)
**数量**：3-5个
**深度要求**：
- 提取论文的**理论基础**（基于哪些定理、原理、范式）
- 说明**核心假设**和**前提条件**
- 分析**理论推导的逻辑链条**
- 指出**理论的适用范围和边界**
**格式要求**：
- "基于[理论/原理]，假设[条件]，推导出[结论]，适用于[场景]"
**示例**：
- "基于信息瓶颈理论，假设模型的表征能力与压缩率存在帕累托最优，推导出多任务学习的权重分配策略，适用于中等规模数据集"

### 4. 主要方法与技术 (Main Methods & Technologies)
**数量**：5-8个
**深度要求**：
- 列出论文采用的**核心方法、算法、技术**
- 说明**方法的原理和关键设计**
- 包括**理论方法、算法设计、系统架构、数据处理**等
- 解释**为什么选择这些方法**（优势、适配性）
**格式要求**：
- "[方法名称]：[原理/作用]，通过[关键技术]，实现[功能/效果]"
**示例**：
- "自适应图卷积网络（AGCN）：根据节点特征动态调整邻接矩阵，通过可学习的注意力权重（α=softmax(W·feats)），实现灵活的图结构建模"

### 5. 实验设计与数据集 (Experimental Design & Datasets)
**数量**：4-6个
**深度要求**：
- 描述**主要实验类型**（性能对比、消融实验、鲁棒性测试、可扩展性测试等）
- 说明**数据集信息**（名称、规模、领域、划分方式）
- 分析**实验设置的合理性**（是否有对照组、变量控制是否得当）
- 指出**评估指标**及其**选择的理由**
**格式要求**：
- "[实验名称]：使用[数据集名称]（规模/特点），设置[对照组/基线方法]，评估[指标]，验证[目标]"
**示例**：
- "性能对比实验：使用ImageNet-1K训练集（128万图像，1000类），与ResNet-50、EfficientNet-B3等5个基线方法对比，评估Top-1/Top-5准确率和推理延迟，验证模型的性能优势"

### 6. 数据集详细分析 (Dataset Analysis)
**数量**：2-4个
**深度要求**：
- 如果论文使用了**新的数据集**，提供详细信息
- 说明数据集的**规模、来源、标注方式、质量**
- 分析数据集的**特点和挑战**
- 如果是**自建数据集**，说明**构建过程和质量控制**
**格式要求**：
- "[数据集名称]：[规模]样本，[领域]，[特点]，[数据来源/标注方式]，[质量指标]"
**示例**：
- "MedicalNet：5万例CT扫描影像，覆盖10种疾病，多中心医院采集（3个国家的8家医院），双重标注（2名放射科医师+1名专家审核），标注一致性Kappa=0.89"

### 7. 主要结论与性能 (Main Conclusions & Performance)
**数量**：4-6个
**深度要求**：
- 总结**核心发现**和**量化结果**
- 包括**性能提升**（准确率、效率、资源消耗等）
- 包括**定性结论**（有效性、适用性、局限性等）
- 说明**结果的意义**（是否支持假设、是否达到预期）
**格式要求**：
- "[结论陈述]，具体表现为[量化数据]，相比基线[提升/降低][百分比/数值]"
**示例**：
- "所提方法在7个基准数据集上平均准确率达到94.7%，相比最佳基线方法BERT-Large提升3.2个百分点，同时参数量减少58%，推理速度提升2.1倍，验证了轻量化设计的有效性"

### 8. 统计分析与显著性 (Statistical Analysis & Significance)
**数量**：2-3个
**深度要求**：
- 说明使用的**统计方法**（t检验、ANOVA、bootstrap等）
- 提供**显著性检验结果**（p值、置信区间）
- 分析结果的**统计显著性**和**实际显著性**
- 说明**样本量**和**统计功效**
**格式要求**：
- "使用[统计方法]对[结果]进行检验，p值为[数值]，置信区间[范围]，表明[结论]"
**示例**：
- "使用配对t检验对5次实验结果进行分析，性能提升的p值<0.001，95%置信区间为[2.8%, 3.6%]，表明改进具有统计显著性"

### 9. 与相关工作的对比 (Comparison with Related Work)
**数量**：3-5个
**深度要求**：
- 分析论文与**主要相关工作**的**本质区别**
- 说明**借鉴了哪些思想**，**改进了哪些缺陷**
- 指出**相比现有方法的独特之处**
- 评估**对比的全面性和公平性**
**格式要求**：
- "与[相关工作/方法]相比，本研究[借鉴点/改进点/区别]，在[方面]表现[更好/不同]"
**示例**：
- "与GCN相比，借鉴了其局部聚合思想，但引入了动态邻接矩阵和注意力机制，在异构图和动态图场景下准确率提升15%-25%，且无需预定义图结构"

### 10. 可复现性与实现细节 (Reproducibility & Implementation Details)
**数量**：3-4个
**深度要求**：
- 说明**代码和数据的可用性**（是否开源、在哪里获取）
- 提供**实现细节**（框架、超参数、硬件配置）
- 说明**实验的可复现性**（是否有随机性、如何固定种子）
- 如果**未开源**，说明可能的原因
**格式要求**：
- "[实现方面]：[详细信息]，[开源情况/获取方式]，[可复现性评估]"
**示例**：
- "代码开源：GitHub链接xxx，基于PyTorch 1.8实现，使用4xV100 GPU训练，batch size=32，学习率=0.001（Adam优化器），固定随机种子seed=42，确保可复现性"

### 11. 学术贡献与影响 (Academic Contributions & Impact)
**数量**：3-5个
**深度要求**：
- 阐明对**理论发展**的贡献
- 阐明对**技术进步**的推动
- 说明对**实际应用**的价值
- 分析**对后续研究的启发**
- 评估**贡献的原创性和重要性**
**格式要求**：
- "[贡献类型]：[具体贡献内容]，[影响/意义]"
**示例**：
- "理论贡献：首次提出了将强化学习与元学习结合的框架RL-Meta，为小样本学习问题提供了新的理论视角，已被3篇顶会论文引用和扩展"

### 12. 研究局限性与未来方向 (Limitations & Future Directions)
**数量**：3-5个
**深度要求**：
- **诚实且具体**地指出论文的**局限性**
- 包括**方法限制**（适用范围、计算复杂度、假设条件等）
- 包括**实验限制**（数据集规模、场景覆盖、对比方法等）
- 包括**潜在改进方向**和**未来工作建议**
**格式要求**：
- "[局限性方面]：[具体说明]，[可能的影响/改进建议]"
**示例**：
- "计算复杂度：当前方法的时空复杂度为O(n²)，虽优于基线但仍难以处理超长序列（>10000步），未来可探索稀疏注意力或层级化建模以进一步降低复杂度"

## 输出格式

请严格按照以下JSON格式输出，**不要添加任何额外说明**：

```json
{{
  "innovations": [
    "创新点1（详细描述）",
    "创新点2（详细描述）",
    "..."
  ],
  "research_gaps": [
    "研究空白1",
    "研究空白2",
    "..."
  ],
  "theoretical_framework": [
    "理论基础/假设1",
    "理论基础/假设2",
    "..."
  ],
  "methods": [
    "方法1（详细描述）",
    "方法2（详细描述）",
    "..."
  ],
  "experimental_design": [
    "实验设计1",
    "实验设计2",
    "..."
  ],
  "datasets": [
    "数据集分析1",
    "数据集分析2",
    "..."
  ],
  "conclusions": [
    "结论1（包含量化数据）",
    "结论2（包含量化数据）",
    "..."
  ],
  "statistical_analysis": [
    "统计分析1",
    "统计分析2",
    "..."
  ],
  "related_work_comparison": [
    "对比分析1",
    "对比分析2",
    "..."
  ],
  "reproducibility": [
    "可复现性信息1",
    "可复现性信息2",
    "..."
  ],
  "contributions": [
    "学术贡献1（详细说明影响）",
    "学术贡献2（详细说明影响）",
    "..."
  ],
  "limitations": [
    "局限性1（具体且诚实）",
    "局限性2（具体且诚实）",
    "..."
  ]
}}
```

## 论文信息

**论文标题**：{title}

**作者**：{authors}

**发表信息**：{publication}

**原始摘要**：{abstract}

**关键词**：{keywords}

**主要章节内容**：
{sections}

**论文正文（关键部分）**：
{content}

**参考文献**：
{references}

---

**现在请基于上述严格要求，进行博士级别的深度分析，并输出JSON格式的结果：**"""


# ============================================================================
# 主题分析提示词 - 深度版
# ============================================================================

TOPIC_ANALYSIS_PROMPT_DOCTORAL = """你是一位跨学科研究的资深学者，具有广泛的知识面和深刻的学术洞察力。你擅长从表面内容中挖掘**深层次的研究主题**和**潜在的学术联系**。

## 核心任务

请对以下论文进行**多维度、多层次的主题分析**，揭示论文的**研究本质**和**学术定位**。

## 分析维度

### 1. 研究领域定位 (Field Classification)
**要求**：
- 一级学科（如：计算机科学、物理学、生物学）
- 二级领域（如：人工智能、高能物理、分子生物学）
- 研究方向（如：深度学习、粒子加速器、基因编辑）
- 交叉学科（如果涉及多个领域）

### 2. 核心主题词 (Core Topics)
**数量**：5-8个
**要求**：
- 提取**最能代表论文内容**的专业术语
- 按重要性**降序排列**
- 包含**研究对象、方法、应用**等多个层面
- 使用**标准术语**，避免自造词

### 3. 研究范式与方法论 (Research Paradigm & Methodology)
**要求**：
- 判断研究的**方法论类型**：
  - 理论研究（定理证明、数学推导）
  - 实验研究（控制实验、对比实验）
  - 仿真研究（计算机模拟、数值计算）
  - 调研研究（问卷调查、访谈）
  - 设计研究（系统设计、算法设计）
- 说明**方法论的特点**和**选择理由**

### 4. 问题类型与求解策略 (Problem Type & Solution Strategy)
**要求**：
- 识别问题的**类型**：
  - 优化问题、分类问题、预测问题、生成问题等
- 说明**求解策略**：
  - 精确求解、近似求解、启发式、元启发式等
- 分析**问题的本质特征**（NP难、凸优化、多目标等）

### 5. 技术栈与工具 (Technology Stack & Tools)
**要求**：
- 列出使用的**关键技术**
- 包括**算法、模型、框架、工具**等
- 说明技术的**成熟度**（成熟/新兴/实验性）

### 6. 应用场景与领域 (Application Scenarios & Domains)
**要求**：
- 指出研究成果的**潜在应用领域**
- 分析**应用的可行性**和**限制条件**
- 说明**应用的预期效果**

### 7. 理论基础与依赖 (Theoretical Foundation & Dependencies)
**要求**：
- 说明论文的**理论基础**（依赖哪些理论、定理）
- 指出**学科交叉点**
- 分析**理论的新颖性**（扩展现有理论 vs 提出新理论）

### 8. 研究前沿性与成熟度 (Research Frontiers & Maturity)
**要求**：
- 判断研究处于**哪个阶段**：
  - 萌芽期：初步探索，问题未明确
  - 成长期：方法多样，快速发展
  - 成熟期：方法固定，优化细节
  - 转型期：范式转换，新旧交替
- 分析**研究的创新程度**（渐进式改进 vs 颠覆性创新）

## 输出格式

请以**结构化的方式**输出，便于后续的主题聚类和趋势分析。

## 论文信息

**论文标题**：{title}

**作者**：{authors}

**摘要**：{abstract}

**关键词**：{keywords}

**主要内容**：
{content}

---

**请提供你的深度主题分析：**"""


# ============================================================================
# 研究空白挖掘提示词 - 全新模块
# ============================================================================

RESEARCH_GAP_MINING_PROMPT = """你是一位具有战略眼光的学术研究顾问，擅长识别**研究空白**和**未来机会**。你的任务是基于对多篇论文的分析，**自动挖掘潜在的研究空白**。

## 核心任务

通过分析给定论文集合，识别：
1. **未被充分研究的问题**
2. **方法上可以改进的空间**
3. **跨领域交叉的机会**
4. **理论上的未解之谜**
5. **实际应用的未满足需求**

## 语言要求

- **必须使用简体中文输出**，无论论文原文是中文还是英文
- 专业术语可以保留英文缩写，但需首次出现时给出中文解释

## 分析维度

### 1. 方法论空白 (Methodological Gaps)
- 现有方法在什么情况下失效？
- 哪些问题还没有好的解决方案？
- 方法的哪些方面还可以优化？

### 2. 理论空白 (Theoretical Gaps)
- 哪些理论问题还没有得到证明？
- 理论的适用边界在哪里？
- 哪些假设还没有被验证？

### 3. 数据空白 (Data Gaps)
- 缺乏什么样的数据？
- 数据的哪些特性还没有被利用？
- 数据质量和规模的问题？

### 4. 应用空白 (Application Gaps)
- 哪些应用场景还没有被覆盖？
- 现有应用的哪些问题还没解决？
- 跨领域迁移的机会？

### 5. 评估空白 (Evaluation Gaps)
- 哪些方面还没有被充分评估？
- 评估方法和指标是否完善？
- 缺乏哪些对比实验？

## 输出格式

对每个识别的空白，提供：
- **空白描述**：清楚说明缺失什么
- **重要性**：为什么这个空白重要
- **难度**：填补空白的难度（低/中/高）
- **潜在方法**：可能的解决方向
- **预期影响**：成功填补后的影响

## 论文信息

{papers_info}

---

**请挖掘研究空白并提供结构化分析：**"""


# ============================================================================
# 趋势预测提示词 - 增强版
# ============================================================================

TREND_PREDICTION_PROMPT_DOCTORAL = """你是一位科技战略研究专家，具有敏锐的前沿洞察力和**预测未来技术发展**的能力。你的任务是基于研究文献的聚类结果，**预测未来2-5年的研究趋势**。

## 核心任务

提供**全面、深入、可操作**的趋势预测分析。

## 分析维度

### 1. 当前研究热点分析 (Current Hotspots)
- 识别**最活跃的研究方向**（基于论文数量、引用、质量）
- 分析热点的**核心技术栈**
- 评估热点的**成熟度**和**发展阶段**
- 判断是**真热点**还是**炒作**

### 2. 短期趋势预测（1-2年）(Short-term Trends)
- 哪些方向会**持续火热**
- 哪些方向会**快速降温**
- 即将出现的**新兴方向**
- **技术演进路径**

### 3. 中长期趋势预测（3-5年）(Mid-to-long-term Trends)
- **范式转换**的可能
- **颠覆性技术**的出现
- **跨学科融合**的趋势
- **理论突破**的可能方向

### 4. 跨领域机会识别 (Cross-domain Opportunities)
- 不同研究方向的**交叉点**
- **跨学科融合**的可能性
- **有潜力的交叉研究领域**
- **方法迁移**的机会

### 5. 研究空白与机会 (Research Gaps & Opportunities)
- 当前研究中**较少涉及**但**重要**的问题
- **未被充分探索**的技术方向
- **值得进一步研究**的问题
- **高价值但高风险**的方向

### 6. 资源配置建议 (Resource Allocation Suggestions)
- 对**新入研究者**的建议（哪些方向容易入门）
- 对**项目选题**的建议（哪些方向有前景）
- 对**资金投入**的建议（哪些方向值得投入）
- 对**时间投入**的建议（哪些方向短期可见效）

### 7. 风险与挑战 (Risks & Challenges)
- 各研究方向的**技术风险**
- **市场风险**和**应用风险**
- **伦理风险**（如果适用）
- **竞争风险**

## 输出要求

- 每个趋势都要有**证据支撑**（基于聚类结果）
- 提供**置信度评估**（高/中/低）
- 给出**具体的行动建议**
- 使用**可视化的趋势图**描述

## 聚类结果

{cluster_results}

## 时间信息

{temporal_info}

---

**请提供博士级别的趋势预测分析：**"""


# ============================================================================
# 辅助函数 - 增强版
# ============================================================================

def get_summary_prompt_doctoral(
    title: str,
    authors: str,
    publication: str,
    abstract: str,
    keywords: str,
    sections: str,
    content: str
) -> str:
    """生成博士级摘要生成提示词"""
    return SUMMARY_GENERATION_PROMPT_DOCTORAL.format(
        title=title or "未提取标题",
        authors=authors or "未知作者",
        publication=publication or "未知发表信息",
        abstract=abstract or "未提取摘要",
        keywords=keywords or "未提取关键词",
        sections=sections or "未提取章节",
        content=content or ""
    )


def get_keypoint_prompt_doctoral(
    title: str,
    authors: str,
    publication: str,
    abstract: str,
    keywords: str,
    sections: str,
    content: str,
    references: str
) -> str:
    """生成博士级要点提取提示词"""
    return KEYPOINT_EXTRACTION_PROMPT_DOCTORAL.format(
        title=title or "未提取标题",
        authors=authors or "未知作者",
        publication=publication or "未知发表信息",
        abstract=abstract or "未提取摘要",
        keywords=keywords or "未提取关键词",
        sections=sections or "未提取章节",
        content=content or "",
        references=references or "未提取参考文献"
    )


def get_topic_prompt_doctoral(
    title: str,
    authors: str,
    abstract: str,
    keywords: str,
    content: str
) -> str:
    """生成博士级主题分析提示词"""
    return TOPIC_ANALYSIS_PROMPT_DOCTORAL.format(
        title=title or "未提取标题",
        authors=authors or "未知作者",
        abstract=abstract or "未提取摘要",
        keywords=keywords or "未提取关键词",
        content=content or ""
    )


def get_gap_mining_prompt(papers_info: str) -> str:
    """生成研究空白挖掘提示词"""
    return RESEARCH_GAP_MINING_PROMPT.format(
        papers_info=papers_info
    )


def get_trend_prediction_prompt_doctoral(
    cluster_results: str,
    temporal_info: str = ""
) -> str:
    """生成博士级趋势预测提示词"""
    return TREND_PREDICTION_PROMPT_DOCTORAL.format(
        cluster_results=cluster_results,
        temporal_info=temporal_info or "时间信息：未提供"
    )
