{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport { ref, onMounted, computed, watch, nextTick } from 'vue';\nimport * as d3 from 'd3';\nimport { ElMessage } from 'element-plus';\nimport api from '@/api';\n\n// Props\n\nexport default {\n  __name: 'KnowledgeGraph',\n  props: {\n    paperIds: {\n      type: Array,\n      default: () => []\n    }\n  },\n  emits: ['build'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    const props = __props;\n    const emit = __emit;\n\n    // 响应式数据\n    const loading = ref(false);\n    const graphData = ref({\n      nodes: {},\n      edges: []\n    });\n    const drawerVisible = ref(false);\n    const selectedNode = ref(null);\n    const connectedNodes = ref([]);\n    const relationFilter = ref([]);\n\n    // D3相关\n    const svgElement = ref(null);\n    const graphContainer = ref(null);\n    let svg, g, simulation, zoom;\n\n    // 关系类型颜色映射（支持中文和英文）\n    const relationColors = {\n      // 中文关系类型 - 新增多种有价值关系\n      '主题相似': '#E74C3C',\n      // 红色 - 内容相似\n      '关键词共享': '#3498DB',\n      // 蓝色 - 关键词\n      '同一会刊': '#9B59B6',\n      // 紫色 - 会刊\n      '共同作者': '#F39C12',\n      // 橙色 - 作者\n      '引用关系': '#27AE60',\n      // 绿色 - 引用\n      '方法相似': '#1ABC9C',\n      // 青色 - 方法\n      '研究脉络': '#E91E63',\n      // 粉色 - 演进\n      // 英文关系类型（兼容旧数据）\n      'cites': '#27AE60',\n      'extends': '#3498DB',\n      'improves': '#1ABC9C',\n      'applies': '#F39C12',\n      'contradicts': '#E74C3C',\n      'related': '#9B59B6',\n      'similar': '#E74C3C',\n      'similar_topic': '#E74C3C',\n      'shares_keywords': '#3498DB',\n      'same_venue': '#9B59B6',\n      'same_author': '#F39C12',\n      'method_similar': '#1ABC9C',\n      'evolution': '#E91E63'\n    };\n\n    // 关系类型中文映射\n    const relationTypeNames = {\n      // 中文关系类型 - 新增关系\n      '主题相似': '主题相似',\n      '关键词共享': '关键词共享',\n      '同一会刊': '同一会刊',\n      '共同作者': '共同作者',\n      '引用关系': '引用关系',\n      '方法相似': '方法相似',\n      '研究脉络': '研究脉络',\n      // 英文关系类型映射为中文（兼容旧数据）\n      'cites': '引用',\n      'extends': '扩展',\n      'improves': '改进',\n      'applies': '应用',\n      'contradicts': '矛盾',\n      'related': '相关',\n      'similar': '相似',\n      'similar_topic': '主题相似',\n      'shares_keywords': '关键词共享',\n      'same_venue': '同一会刊',\n      'same_author': '共同作者',\n      'method_similar': '方法相似',\n      'evolution': '研究脉络'\n    };\n\n    // 计算属性\n    const relationTypes = computed(() => {\n      const types = new Set();\n      graphData.value.edges.forEach(edge => {\n        if (edge.type) types.add(edge.type);\n      });\n      return Array.from(types);\n    });\n    const filteredEdges = computed(() => {\n      if (relationFilter.value.length === 0) {\n        return graphData.value.edges;\n      }\n      return graphData.value.edges.filter(edge => relationFilter.value.includes(edge.type));\n    });\n\n    // 方法\n    const initGraph = () => {\n      if (!svgElement.value) return;\n      const container = graphContainer.value;\n      const width = container.clientWidth;\n      const height = container.clientHeight;\n\n      // 清除之前的SVG内容\n      d3.select(svgElement.value).selectAll('*').remove();\n\n      // 创建SVG\n      svg = d3.select(svgElement.value).attr('width', width).attr('height', height);\n\n      // 添加缩放行为\n      zoom = d3.zoom().scaleExtent([0.1, 4]).on('zoom', event => {\n        g.attr('transform', event.transform);\n      });\n      svg.call(zoom);\n\n      // 创建主分组\n      g = svg.append('g');\n\n      // 添加箭头标记 - 调整位置以适应更大的节点间距\n      const defs = svg.append('defs');\n      Object.keys(relationColors).forEach(type => {\n        defs.append('marker').attr('id', `arrow-${type}`).attr('viewBox', '0 0 10 10').attr('refX', 35) // 从25增加到35，适应更大的节点间距\n        .attr('refY', 5).attr('markerWidth', 8) // 稍微增大箭头\n        .attr('markerHeight', 8).attr('orient', 'auto-start-reverse').append('path').attr('d', 'M 0 0 L 10 5 L 0 10 z').attr('fill', relationColors[type]);\n      });\n    };\n    const updateGraph = () => {\n      if (!g) return;\n\n      // 清除之前的内容\n      g.selectAll('*').remove();\n\n      // 准备节点数据\n      const nodes = Object.entries(graphData.value.nodes).map(([id, data]) => ({\n        id: parseInt(id),\n        ...data\n      }));\n\n      // 检查是否有数据\n      if (nodes.length === 0) {\n        console.log('[DEBUG] 没有节点数据');\n        return;\n      }\n      console.log(`[DEBUG] 渲染图谱: ${nodes.length} 个节点, ${filteredEdges.value.length} 条边`);\n\n      // 创建节点映射用于边的连接\n      const nodeMap = new Map(nodes.map(n => [n.id, n]));\n\n      // 准备边数据 - 确保source和target引用节点对象\n      const links = filteredEdges.value.map(edge => ({\n        ...edge,\n        source: nodeMap.get(edge.source),\n        target: nodeMap.get(edge.target)\n      })).filter(edge => edge.source && edge.target); // 过滤掉无效的边\n\n      // 创建力导向布局 - 调整参数使节点间距更大\n      simulation = d3.forceSimulation(nodes).force('link', d3.forceLink(links).id(d => d.id).distance(250) // 从150增加到250，连接节点距离更远\n      ).force('charge', d3.forceManyBody().strength(-800) // 从-400增加到-800，斥力更强，节点更分散\n      .distanceMin(50) // 最小作用距离，防止节点过度聚集\n      .distanceMax(800) // 最大作用距离\n      ).force('center', d3.forceCenter(graphContainer.value.clientWidth / 2, graphContainer.value.clientHeight / 2)).force('collision', d3.forceCollide().radius(d => {\n        // 根据节点连接数动态调整碰撞半径\n        const connectionCount = links.filter(l => l.source.id === d.id || l.target.id === d.id).length;\n        return 60 + Math.min(connectionCount * 5, 30); // 基础60，根据连接数增加\n      })).force('x', d3.forceX(graphContainer.value.clientWidth / 2).strength(0.05)) // 添加水平方向弱引力\n      .force('y', d3.forceY(graphContainer.value.clientHeight / 2).strength(0.05)); // 添加垂直方向弱引力\n\n      // 绘制边 - 加粗线条以适应更大的间距\n      const linkElements = g.append('g').attr('class', 'links').selectAll('line').data(links).join('line').attr('stroke', d => relationColors[d.type] || '#999').attr('stroke-width', d => Math.max(2.5, d.strength * 5 || 2.5)) // 加粗线条\n      .attr('marker-end', d => `url(#arrow-${d.type})`).attr('opacity', 0.75);\n\n      // 绘制边标签 - 优化显示\n      const linkLabels = g.append('g').attr('class', 'link-labels').selectAll('text').data(links).join('text').text(d => relationTypeNames[d.type] || d.type).attr('font-size', '11px') // 稍大字体\n      .attr('fill', '#444') // 更深的颜色\n      .attr('text-anchor', 'middle').attr('dy', -8) // 离线条更远\n      .attr('font-weight', '500') // 加粗\n      .style('text-shadow', '1px 1px 2px white, -1px -1px 2px white, 1px -1px 2px white, -1px 1px 2px white'); // 添加白色描边\n\n      // 绘制节点组\n      const nodeElements = g.append('g').attr('class', 'nodes').selectAll('g').data(nodes).join('g').attr('class', 'node').call(d3.drag().on('start', dragstarted).on('drag', dragged).on('end', dragended)).on('click', (event, d) => showNodeDetail(d));\n\n      // 节点圆形 - 增大节点大小以适应更大的间距\n      nodeElements.append('circle').attr('r', d => {\n        const connectionCount = links.filter(l => l.source.id === d.id || l.target.id === d.id).length;\n        return 28 + Math.min(connectionCount * 4, 20); // 从20增加到28，节点更大\n      }).attr('fill', d => {\n        const connectionCount = links.filter(l => l.source.id === d.id || l.target.id === d.id).length;\n        // 连接越多，颜色越深\n        return d3.interpolateBlues(0.3 + Math.min(connectionCount * 0.1, 0.5));\n      }).attr('stroke', '#fff').attr('stroke-width', 3) // 边框加粗\n      .style('cursor', 'pointer');\n\n      // 节点标签 - 调整位置，显示更多文字\n      nodeElements.append('text').text(d => {\n        const title = d.title || d.data?.title || 'Paper';\n        return title.length > 16 ? title.substring(0, 16) + '...' : title; // 从12增加到16\n      }).attr('x', 0).attr('y', 45) // 从35增加到45，适应更大的节点\n      .attr('text-anchor', 'middle').attr('font-size', '12px') // 字体稍大\n      .attr('fill', '#333').attr('font-weight', '500');\n\n      // 更新位置\n      simulation.on('tick', () => {\n        linkElements.attr('x1', d => d.source.x).attr('y1', d => d.source.y).attr('x2', d => d.target.x).attr('y2', d => d.target.y);\n        linkLabels.attr('x', d => (d.source.x + d.target.x) / 2).attr('y', d => (d.source.y + d.target.y) / 2);\n        nodeElements.attr('transform', d => `translate(${d.x},${d.y})`);\n      });\n    };\n    const showNodeDetail = nodeData => {\n      selectedNode.value = {\n        data: nodeData\n      };\n\n      // 查找关联节点\n      connectedNodes.value = [];\n      filteredEdges.value.forEach(edge => {\n        const sourceId = typeof edge.source === 'object' ? edge.source.id : edge.source;\n        const targetId = typeof edge.target === 'object' ? edge.target.id : edge.target;\n        if (sourceId === nodeData.id) {\n          const connected = graphData.value.nodes[targetId];\n          if (connected) {\n            connectedNodes.value.push({\n              data: connected,\n              relation: edge.type\n            });\n          }\n        } else if (targetId === nodeData.id) {\n          const connected = graphData.value.nodes[sourceId];\n          if (connected) {\n            connectedNodes.value.push({\n              data: connected,\n              relation: edge.type\n            });\n          }\n        }\n      });\n      drawerVisible.value = true;\n    };\n    const focusNode = nodeId => {\n      // 缩放到指定节点\n      const node = graphData.value.nodes[nodeId];\n      if (node && svg) {\n        const transform = d3.zoomIdentity.translate(graphContainer.value.clientWidth / 2, graphContainer.value.clientHeight / 2).scale(2).translate(-node.x || 0, -node.y || 0);\n        svg.transition().duration(750).call(zoom.transform, transform);\n      }\n    };\n    const dragstarted = (event, d) => {\n      if (!event.active) simulation.alphaTarget(0.3).restart();\n      d.fx = d.x;\n      d.fy = d.y;\n    };\n    const dragged = (event, d) => {\n      d.fx = event.x;\n      d.fy = event.y;\n    };\n    const dragended = (event, d) => {\n      if (!event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    };\n    const getRelationColor = type => {\n      return relationColors[type] || '#999';\n    };\n    const refreshGraph = async () => {\n      loading.value = true;\n      try {\n        const response = await api.getKnowledgeGraph(props.paperIds);\n        if (response.success) {\n          graphData.value = response.data;\n          console.log('[DEBUG] 获取到图谱数据:', graphData.value);\n\n          // 等待DOM更新后再初始化图谱\n          await nextTick();\n          initGraph();\n          updateGraph();\n\n          // 自适应缩放，使所有节点可见\n          setTimeout(() => {\n            fitGraphToView();\n          }, 500);\n          const nodeCount = Object.keys(graphData.value.nodes).length;\n          const edgeCount = graphData.value.edges.length;\n          if (nodeCount > 0) {\n            ElMessage.success(`图谱加载成功: ${nodeCount} 个节点, ${edgeCount} 条边`);\n          } else {\n            ElMessage.info('暂无图谱数据，请先分析论文');\n          }\n        } else {\n          ElMessage.error(response.error || '图谱加载失败');\n        }\n      } catch (error) {\n        console.error('图谱加载失败:', error);\n        ElMessage.error('图谱加载失败: ' + (error.message || '未知错误'));\n      } finally {\n        loading.value = false;\n      }\n    };\n    const fitGraphToView = () => {\n      // 自适应缩放，使所有节点可见\n      if (!g || !svg) return;\n      const nodeElements = g.selectAll('.node');\n      if (nodeElements.empty()) return;\n      const containerWidth = graphContainer.value.clientWidth;\n      const containerHeight = graphContainer.value.clientHeight;\n\n      // 获取所有节点的位置范围\n      let minX = Infinity,\n        maxX = -Infinity,\n        minY = Infinity,\n        maxY = -Infinity;\n      nodeElements.each(function (d) {\n        if (d.x !== undefined && d.y !== undefined) {\n          minX = Math.min(minX, d.x);\n          maxX = Math.max(maxX, d.x);\n          minY = Math.min(minY, d.y);\n          maxY = Math.max(maxY, d.y);\n        }\n      });\n      if (minX === Infinity) return;\n\n      // 添加边距\n      const padding = 100;\n      minX -= padding;\n      maxX += padding;\n      minY -= padding;\n      maxY += padding;\n      const graphWidth = maxX - minX;\n      const graphHeight = maxY - minY;\n      if (graphWidth === 0 || graphHeight === 0) return;\n\n      // 计算合适的缩放比例\n      const scaleX = containerWidth / graphWidth;\n      const scaleY = containerHeight / graphHeight;\n      const scale = Math.min(scaleX, scaleY, 1) * 0.9; // 最大缩放1，留10%边距\n\n      // 计算平移量，使图谱居中\n      const translateX = (containerWidth - (minX + maxX) * scale) / 2;\n      const translateY = (containerHeight - (minY + maxY) * scale) / 2;\n      const transform = d3.zoomIdentity.translate(translateX, translateY).scale(scale);\n      svg.transition().duration(750).call(zoom.transform, transform);\n    };\n    const resetZoom = () => {\n      if (svg && zoom) {\n        svg.transition().duration(750).call(zoom.transform, d3.zoomIdentity);\n      }\n    };\n\n    // 暴露方法给父组件\n    __expose({\n      refreshGraph\n    });\n\n    // 生命周期\n    onMounted(async () => {\n      await refreshGraph();\n\n      // 响应式调整\n      window.addEventListener('resize', () => {\n        if (graphContainer.value && svgElement.value) {\n          const width = graphContainer.value.clientWidth;\n          const height = graphContainer.value.clientHeight;\n          d3.select(svgElement.value).attr('width', width).attr('height', height);\n        }\n      });\n    });\n\n    // 监听props变化\n    watch(() => props.paperIds, () => {\n      refreshGraph();\n    });\n\n    // 监听过滤器变化\n    watch(relationFilter, () => {\n      updateGraph();\n    });\n    const __returned__ = {\n      props,\n      emit,\n      loading,\n      graphData,\n      drawerVisible,\n      selectedNode,\n      connectedNodes,\n      relationFilter,\n      svgElement,\n      graphContainer,\n      get svg() {\n        return svg;\n      },\n      set svg(v) {\n        svg = v;\n      },\n      get g() {\n        return g;\n      },\n      set g(v) {\n        g = v;\n      },\n      get simulation() {\n        return simulation;\n      },\n      set simulation(v) {\n        simulation = v;\n      },\n      get zoom() {\n        return zoom;\n      },\n      set zoom(v) {\n        zoom = v;\n      },\n      relationColors,\n      relationTypeNames,\n      relationTypes,\n      filteredEdges,\n      initGraph,\n      updateGraph,\n      showNodeDetail,\n      focusNode,\n      dragstarted,\n      dragged,\n      dragended,\n      getRelationColor,\n      refreshGraph,\n      fitGraphToView,\n      resetZoom,\n      ref,\n      onMounted,\n      computed,\n      watch,\n      nextTick,\n      get d3() {\n        return d3;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get api() {\n        return api;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","watch","nextTick","d3","ElMessage","api","props","__props","emit","__emit","loading","graphData","nodes","edges","drawerVisible","selectedNode","connectedNodes","relationFilter","svgElement","graphContainer","svg","g","simulation","zoom","relationColors","relationTypeNames","relationTypes","types","Set","value","forEach","edge","type","add","Array","from","filteredEdges","length","filter","includes","initGraph","container","width","clientWidth","height","clientHeight","select","selectAll","remove","attr","scaleExtent","on","event","transform","call","append","defs","Object","keys","updateGraph","entries","map","id","data","parseInt","console","log","nodeMap","Map","n","links","source","get","target","forceSimulation","force","forceLink","d","distance","forceManyBody","strength","distanceMin","distanceMax","forceCenter","forceCollide","radius","connectionCount","l","Math","min","forceX","forceY","linkElements","join","max","linkLabels","text","style","nodeElements","drag","dragstarted","dragged","dragended","showNodeDetail","interpolateBlues","title","substring","x","y","nodeData","sourceId","targetId","connected","push","relation","focusNode","nodeId","node","zoomIdentity","translate","scale","transition","duration","active","alphaTarget","restart","fx","fy","getRelationColor","refreshGraph","response","getKnowledgeGraph","paperIds","success","setTimeout","fitGraphToView","nodeCount","edgeCount","info","error","message","empty","containerWidth","containerHeight","minX","Infinity","maxX","minY","maxY","each","undefined","padding","graphWidth","graphHeight","scaleX","scaleY","translateX","translateY","resetZoom","__expose","window","addEventListener"],"sources":["/Users/liucunyu/Documents/all_code/NUC_graduation_project/frontend/src/components/KnowledgeGraph.vue"],"sourcesContent":["<template>\n  <div class=\"knowledge-graph-container\">\n    <div class=\"graph-header\">\n      <h2>知识图谱可视化</h2>\n      <div class=\"controls\">\n        <el-button @click=\"refreshGraph\" icon=\"Refresh\" :loading=\"loading\">刷新</el-button>\n        <el-button @click=\"resetZoom\" icon=\"ZoomOut\">重置视图</el-button>\n        <el-select v-model=\"relationFilter\" placeholder=\"关系类型\" multiple style=\"width: 200px\">\n          <el-option v-for=\"type in relationTypes\" :key=\"type\" :label=\"relationTypeNames[type] || type\" :value=\"type\" />\n        </el-select>\n      </div>\n    </div>\n\n    <!-- SVG容器 -->\n    <div ref=\"graphContainer\" class=\"graph-container\">\n      <svg ref=\"svgElement\" width=\"100%\" height=\"100%\"></svg>\n\n      <!-- 空状态 -->\n      <el-empty\n        v-if=\"!loading && Object.keys(graphData.nodes).length === 0\"\n        description=\"暂无图谱数据，请先分析论文或构建图谱\"\n        class=\"graph-empty\"\n      >\n        <el-button type=\"primary\" @click=\"$emit('build')\">构建知识图谱</el-button>\n      </el-empty>\n\n      <!-- 只有节点没有边的情况 -->\n      <el-alert\n        v-if=\"!loading && Object.keys(graphData.nodes).length > 0 && filteredEdges.length === 0\"\n        title=\"论文已加载，暂无关系数据\"\n        type=\"info\"\n        :closable=\"false\"\n        class=\"graph-info\"\n      />\n    </div>\n\n    <!-- 加载状态 -->\n    <div v-if=\"loading\" class=\"loading-overlay\">\n      <el-icon class=\"is-loading\" :size=\"40\"><Loading /></el-icon>\n      <p>正在构建知识图谱...</p>\n    </div>\n\n    <!-- 节点详情面板 -->\n    <el-drawer v-model=\"drawerVisible\" title=\"节点详情\" size=\"400px\" direction=\"rtl\">\n      <div v-if=\"selectedNode\" class=\"node-detail\">\n        <h3>{{ selectedNode.data.title || '未命名论文' }}</h3>\n        <el-divider />\n\n        <el-descriptions :column=\"1\" border>\n          <el-descriptions-item label=\"ID\">{{ selectedNode.data.id }}</el-descriptions-item>\n          <el-descriptions-item label=\"年份\">{{ selectedNode.data.year || 'N/A' }}</el-descriptions-item>\n          <el-descriptions-item label=\"发表场所\">{{ selectedNode.data.venue || 'N/A' }}</el-descriptions-item>\n          <el-descriptions-item label=\"作者数量\">\n            {{ selectedNode.data.authors?.length || 0 }}\n          </el-descriptions-item>\n          <el-descriptions-item label=\"摘要长度\">\n            {{ selectedNode.data.abstract?.length || 0 }} 字符\n          </el-descriptions-item>\n        </el-descriptions>\n\n        <el-divider />\n\n        <!-- 关联论文 -->\n        <h4>关联论文</h4>\n        <div v-if=\"connectedNodes.length > 0\" class=\"connected-papers\">\n          <el-card\n            v-for=\"node in connectedNodes\"\n            :key=\"node.data.id\"\n            class=\"paper-card\"\n            shadow=\"hover\"\n          >\n            <div class=\"paper-title\" @click=\"focusNode(node.data.id)\">\n              {{ node.data.title || '未命名论文' }}\n            </div>\n            <div class=\"paper-meta\">\n              <el-tag size=\"small\" type=\"info\">{{ relationTypeNames[node.relation] || node.relation }}</el-tag>\n              <span>{{ node.data.year || '未知年份' }}</span>\n              <span>{{ node.data.venue || '未知期刊' }}</span>\n            </div>\n          </el-card>\n        </div>\n        <el-empty v-else description=\"无关联论文\" />\n      </div>\n    </el-drawer>\n\n    <!-- 图例 -->\n    <div class=\"legend-panel\" v-if=\"relationTypes.length > 0\">\n      <div class=\"legend-title\">关系类型</div>\n      <div v-for=\"type in relationTypes\" :key=\"type\" class=\"legend-item\">\n        <span class=\"legend-color\" :style=\"{ backgroundColor: getRelationColor(type) }\"></span>\n        <span class=\"legend-label\">{{ relationTypeNames[type] || type }}</span>\n      </div>\n    </div>\n\n    <!-- 统计信息 -->\n    <div class=\"stats-panel\" v-if=\"!loading\">\n      <el-tag type=\"info\">节点: {{ Object.keys(graphData.nodes).length }}</el-tag>\n      <el-tag type=\"success\" style=\"margin-left: 8px;\">关系: {{ filteredEdges.length }}</el-tag>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed, watch, nextTick } from 'vue'\nimport * as d3 from 'd3'\nimport { ElMessage } from 'element-plus'\nimport api from '@/api'\n\n// Props\nconst props = defineProps({\n  paperIds: {\n    type: Array,\n    default: () => []\n  }\n})\n\nconst emit = defineEmits(['build'])\n\n// 响应式数据\nconst loading = ref(false)\nconst graphData = ref({ nodes: {}, edges: [] })\nconst drawerVisible = ref(false)\nconst selectedNode = ref(null)\nconst connectedNodes = ref([])\nconst relationFilter = ref([])\n\n// D3相关\nconst svgElement = ref(null)\nconst graphContainer = ref(null)\nlet svg, g, simulation, zoom\n\n// 关系类型颜色映射（支持中文和英文）\nconst relationColors = {\n  // 中文关系类型 - 新增多种有价值关系\n  '主题相似': '#E74C3C',      // 红色 - 内容相似\n  '关键词共享': '#3498DB',    // 蓝色 - 关键词\n  '同一会刊': '#9B59B6',      // 紫色 - 会刊\n  '共同作者': '#F39C12',      // 橙色 - 作者\n  '引用关系': '#27AE60',      // 绿色 - 引用\n  '方法相似': '#1ABC9C',      // 青色 - 方法\n  '研究脉络': '#E91E63',      // 粉色 - 演进\n  // 英文关系类型（兼容旧数据）\n  'cites': '#27AE60',\n  'extends': '#3498DB',\n  'improves': '#1ABC9C',\n  'applies': '#F39C12',\n  'contradicts': '#E74C3C',\n  'related': '#9B59B6',\n  'similar': '#E74C3C',\n  'similar_topic': '#E74C3C',\n  'shares_keywords': '#3498DB',\n  'same_venue': '#9B59B6',\n  'same_author': '#F39C12',\n  'method_similar': '#1ABC9C',\n  'evolution': '#E91E63'\n}\n\n// 关系类型中文映射\nconst relationTypeNames = {\n  // 中文关系类型 - 新增关系\n  '主题相似': '主题相似',\n  '关键词共享': '关键词共享',\n  '同一会刊': '同一会刊',\n  '共同作者': '共同作者',\n  '引用关系': '引用关系',\n  '方法相似': '方法相似',\n  '研究脉络': '研究脉络',\n  // 英文关系类型映射为中文（兼容旧数据）\n  'cites': '引用',\n  'extends': '扩展',\n  'improves': '改进',\n  'applies': '应用',\n  'contradicts': '矛盾',\n  'related': '相关',\n  'similar': '相似',\n  'similar_topic': '主题相似',\n  'shares_keywords': '关键词共享',\n  'same_venue': '同一会刊',\n  'same_author': '共同作者',\n  'method_similar': '方法相似',\n  'evolution': '研究脉络',\n\n}\n\n// 计算属性\nconst relationTypes = computed(() => {\n  const types = new Set()\n  graphData.value.edges.forEach(edge => {\n    if (edge.type) types.add(edge.type)\n  })\n  return Array.from(types)\n})\n\nconst filteredEdges = computed(() => {\n  if (relationFilter.value.length === 0) {\n    return graphData.value.edges\n  }\n  return graphData.value.edges.filter(edge =>\n    relationFilter.value.includes(edge.type)\n  )\n})\n\n// 方法\nconst initGraph = () => {\n  if (!svgElement.value) return\n\n  const container = graphContainer.value\n  const width = container.clientWidth\n  const height = container.clientHeight\n\n  // 清除之前的SVG内容\n  d3.select(svgElement.value).selectAll('*').remove()\n\n  // 创建SVG\n  svg = d3.select(svgElement.value)\n    .attr('width', width)\n    .attr('height', height)\n\n  // 添加缩放行为\n  zoom = d3.zoom()\n    .scaleExtent([0.1, 4])\n    .on('zoom', (event) => {\n      g.attr('transform', event.transform)\n    })\n\n  svg.call(zoom)\n\n  // 创建主分组\n  g = svg.append('g')\n\n  // 添加箭头标记 - 调整位置以适应更大的节点间距\n  const defs = svg.append('defs')\n  Object.keys(relationColors).forEach(type => {\n    defs.append('marker')\n      .attr('id', `arrow-${type}`)\n      .attr('viewBox', '0 0 10 10')\n      .attr('refX', 35)  // 从25增加到35，适应更大的节点间距\n      .attr('refY', 5)\n      .attr('markerWidth', 8)  // 稍微增大箭头\n      .attr('markerHeight', 8)\n      .attr('orient', 'auto-start-reverse')\n      .append('path')\n      .attr('d', 'M 0 0 L 10 5 L 0 10 z')\n      .attr('fill', relationColors[type])\n  })\n}\n\nconst updateGraph = () => {\n  if (!g) return\n\n  // 清除之前的内容\n  g.selectAll('*').remove()\n\n  // 准备节点数据\n  const nodes = Object.entries(graphData.value.nodes).map(([id, data]) => ({\n    id: parseInt(id),\n    ...data\n  }))\n\n  // 检查是否有数据\n  if (nodes.length === 0) {\n    console.log('[DEBUG] 没有节点数据')\n    return\n  }\n\n  console.log(`[DEBUG] 渲染图谱: ${nodes.length} 个节点, ${filteredEdges.value.length} 条边`)\n\n  // 创建节点映射用于边的连接\n  const nodeMap = new Map(nodes.map(n => [n.id, n]))\n\n  // 准备边数据 - 确保source和target引用节点对象\n  const links = filteredEdges.value.map(edge => ({\n    ...edge,\n    source: nodeMap.get(edge.source),\n    target: nodeMap.get(edge.target)\n  })).filter(edge => edge.source && edge.target) // 过滤掉无效的边\n\n  // 创建力导向布局 - 调整参数使节点间距更大\n  simulation = d3.forceSimulation(nodes)\n    .force('link', d3.forceLink(links)\n      .id(d => d.id)\n      .distance(250)  // 从150增加到250，连接节点距离更远\n    )\n    .force('charge', d3.forceManyBody()\n      .strength(-800)  // 从-400增加到-800，斥力更强，节点更分散\n      .distanceMin(50)  // 最小作用距离，防止节点过度聚集\n      .distanceMax(800) // 最大作用距离\n    )\n    .force('center', d3.forceCenter(\n      graphContainer.value.clientWidth / 2,\n      graphContainer.value.clientHeight / 2\n    ))\n    .force('collision', d3.forceCollide().radius(d => {\n      // 根据节点连接数动态调整碰撞半径\n      const connectionCount = links.filter(l => l.source.id === d.id || l.target.id === d.id).length\n      return 60 + Math.min(connectionCount * 5, 30)  // 基础60，根据连接数增加\n    }))\n    .force('x', d3.forceX(graphContainer.value.clientWidth / 2).strength(0.05))  // 添加水平方向弱引力\n    .force('y', d3.forceY(graphContainer.value.clientHeight / 2).strength(0.05)) // 添加垂直方向弱引力\n\n  // 绘制边 - 加粗线条以适应更大的间距\n  const linkElements = g.append('g')\n    .attr('class', 'links')\n    .selectAll('line')\n    .data(links)\n    .join('line')\n    .attr('stroke', d => relationColors[d.type] || '#999')\n    .attr('stroke-width', d => Math.max(2.5, d.strength * 5 || 2.5))  // 加粗线条\n    .attr('marker-end', d => `url(#arrow-${d.type})`)\n    .attr('opacity', 0.75)\n\n  // 绘制边标签 - 优化显示\n  const linkLabels = g.append('g')\n    .attr('class', 'link-labels')\n    .selectAll('text')\n    .data(links)\n    .join('text')\n    .text(d => relationTypeNames[d.type] || d.type)\n    .attr('font-size', '11px')  // 稍大字体\n    .attr('fill', '#444')  // 更深的颜色\n    .attr('text-anchor', 'middle')\n    .attr('dy', -8)  // 离线条更远\n    .attr('font-weight', '500')  // 加粗\n    .style('text-shadow', '1px 1px 2px white, -1px -1px 2px white, 1px -1px 2px white, -1px 1px 2px white')  // 添加白色描边\n\n  // 绘制节点组\n  const nodeElements = g.append('g')\n    .attr('class', 'nodes')\n    .selectAll('g')\n    .data(nodes)\n    .join('g')\n    .attr('class', 'node')\n    .call(d3.drag()\n      .on('start', dragstarted)\n      .on('drag', dragged)\n      .on('end', dragended)\n    )\n    .on('click', (event, d) => showNodeDetail(d))\n\n  // 节点圆形 - 增大节点大小以适应更大的间距\n  nodeElements.append('circle')\n    .attr('r', d => {\n      const connectionCount = links.filter(l => l.source.id === d.id || l.target.id === d.id).length\n      return 28 + Math.min(connectionCount * 4, 20)  // 从20增加到28，节点更大\n    })\n    .attr('fill', d => {\n      const connectionCount = links.filter(l => l.source.id === d.id || l.target.id === d.id).length\n      // 连接越多，颜色越深\n      return d3.interpolateBlues(0.3 + Math.min(connectionCount * 0.1, 0.5))\n    })\n    .attr('stroke', '#fff')\n    .attr('stroke-width', 3)  // 边框加粗\n    .style('cursor', 'pointer')\n\n  // 节点标签 - 调整位置，显示更多文字\n  nodeElements.append('text')\n    .text(d => {\n      const title = d.title || d.data?.title || 'Paper'\n      return title.length > 16 ? title.substring(0, 16) + '...' : title  // 从12增加到16\n    })\n    .attr('x', 0)\n    .attr('y', 45)  // 从35增加到45，适应更大的节点\n    .attr('text-anchor', 'middle')\n    .attr('font-size', '12px')  // 字体稍大\n    .attr('fill', '#333')\n    .attr('font-weight', '500')\n\n  // 更新位置\n  simulation.on('tick', () => {\n    linkElements\n      .attr('x1', d => d.source.x)\n      .attr('y1', d => d.source.y)\n      .attr('x2', d => d.target.x)\n      .attr('y2', d => d.target.y)\n\n    linkLabels\n      .attr('x', d => (d.source.x + d.target.x) / 2)\n      .attr('y', d => (d.source.y + d.target.y) / 2)\n\n    nodeElements\n      .attr('transform', d => `translate(${d.x},${d.y})`)\n  })\n}\n\nconst showNodeDetail = (nodeData) => {\n  selectedNode.value = { data: nodeData }\n\n  // 查找关联节点\n  connectedNodes.value = []\n  filteredEdges.value.forEach(edge => {\n    const sourceId = typeof edge.source === 'object' ? edge.source.id : edge.source\n    const targetId = typeof edge.target === 'object' ? edge.target.id : edge.target\n\n    if (sourceId === nodeData.id) {\n      const connected = graphData.value.nodes[targetId]\n      if (connected) {\n        connectedNodes.value.push({ data: connected, relation: edge.type })\n      }\n    } else if (targetId === nodeData.id) {\n      const connected = graphData.value.nodes[sourceId]\n      if (connected) {\n        connectedNodes.value.push({ data: connected, relation: edge.type })\n      }\n    }\n  })\n\n  drawerVisible.value = true\n}\n\nconst focusNode = (nodeId) => {\n  // 缩放到指定节点\n  const node = graphData.value.nodes[nodeId]\n  if (node && svg) {\n    const transform = d3.zoomIdentity\n      .translate(\n        graphContainer.value.clientWidth / 2,\n        graphContainer.value.clientHeight / 2\n      )\n      .scale(2)\n      .translate(-node.x || 0, -node.y || 0)\n\n    svg.transition()\n      .duration(750)\n      .call(zoom.transform, transform)\n  }\n}\n\nconst dragstarted = (event, d) => {\n  if (!event.active) simulation.alphaTarget(0.3).restart()\n  d.fx = d.x\n  d.fy = d.y\n}\n\nconst dragged = (event, d) => {\n  d.fx = event.x\n  d.fy = event.y\n}\n\nconst dragended = (event, d) => {\n  if (!event.active) simulation.alphaTarget(0)\n  d.fx = null\n  d.fy = null\n}\n\nconst getRelationColor = (type) => {\n  return relationColors[type] || '#999'\n}\n\nconst refreshGraph = async () => {\n  loading.value = true\n  try {\n    const response = await api.getKnowledgeGraph(props.paperIds)\n    if (response.success) {\n      graphData.value = response.data\n      console.log('[DEBUG] 获取到图谱数据:', graphData.value)\n\n      // 等待DOM更新后再初始化图谱\n      await nextTick()\n      initGraph()\n      updateGraph()\n\n      // 自适应缩放，使所有节点可见\n      setTimeout(() => {\n        fitGraphToView()\n      }, 500)\n\n      const nodeCount = Object.keys(graphData.value.nodes).length\n      const edgeCount = graphData.value.edges.length\n\n      if (nodeCount > 0) {\n        ElMessage.success(`图谱加载成功: ${nodeCount} 个节点, ${edgeCount} 条边`)\n      } else {\n        ElMessage.info('暂无图谱数据，请先分析论文')\n      }\n    } else {\n      ElMessage.error(response.error || '图谱加载失败')\n    }\n  } catch (error) {\n    console.error('图谱加载失败:', error)\n    ElMessage.error('图谱加载失败: ' + (error.message || '未知错误'))\n  } finally {\n    loading.value = false\n  }\n}\n\nconst fitGraphToView = () => {\n  // 自适应缩放，使所有节点可见\n  if (!g || !svg) return\n  \n  const nodeElements = g.selectAll('.node')\n  if (nodeElements.empty()) return\n  \n  const containerWidth = graphContainer.value.clientWidth\n  const containerHeight = graphContainer.value.clientHeight\n  \n  // 获取所有节点的位置范围\n  let minX = Infinity, maxX = -Infinity, minY = Infinity, maxY = -Infinity\n  \n  nodeElements.each(function(d) {\n    if (d.x !== undefined && d.y !== undefined) {\n      minX = Math.min(minX, d.x)\n      maxX = Math.max(maxX, d.x)\n      minY = Math.min(minY, d.y)\n      maxY = Math.max(maxY, d.y)\n    }\n  })\n  \n  if (minX === Infinity) return\n  \n  // 添加边距\n  const padding = 100\n  minX -= padding\n  maxX += padding\n  minY -= padding\n  maxY += padding\n  \n  const graphWidth = maxX - minX\n  const graphHeight = maxY - minY\n  \n  if (graphWidth === 0 || graphHeight === 0) return\n  \n  // 计算合适的缩放比例\n  const scaleX = containerWidth / graphWidth\n  const scaleY = containerHeight / graphHeight\n  const scale = Math.min(scaleX, scaleY, 1) * 0.9  // 最大缩放1，留10%边距\n  \n  // 计算平移量，使图谱居中\n  const translateX = (containerWidth - (minX + maxX) * scale) / 2\n  const translateY = (containerHeight - (minY + maxY) * scale) / 2\n  \n  const transform = d3.zoomIdentity\n    .translate(translateX, translateY)\n    .scale(scale)\n  \n  svg.transition()\n    .duration(750)\n    .call(zoom.transform, transform)\n}\n\nconst resetZoom = () => {\n  if (svg && zoom) {\n    svg.transition()\n      .duration(750)\n      .call(zoom.transform, d3.zoomIdentity)\n  }\n}\n\n// 暴露方法给父组件\ndefineExpose({\n  refreshGraph\n})\n\n// 生命周期\nonMounted(async () => {\n  await refreshGraph()\n\n  // 响应式调整\n  window.addEventListener('resize', () => {\n    if (graphContainer.value && svgElement.value) {\n      const width = graphContainer.value.clientWidth\n      const height = graphContainer.value.clientHeight\n      d3.select(svgElement.value)\n        .attr('width', width)\n        .attr('height', height)\n    }\n  })\n})\n\n// 监听props变化\nwatch(() => props.paperIds, () => {\n  refreshGraph()\n})\n\n// 监听过滤器变化\nwatch(relationFilter, () => {\n  updateGraph()\n})\n</script>\n\n<style scoped>\n.knowledge-graph-container {\n  width: 100%;\n  height: calc(100vh - 200px);\n  display: flex;\n  flex-direction: column;\n  background: #f8f9fa;\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.graph-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px;\n  border-bottom: 1px solid #e0e0e0;\n  background: white;\n}\n\n.graph-header h2 {\n  margin: 0;\n  font-size: 20px;\n  font-weight: 600;\n}\n\n.controls {\n  display: flex;\n  gap: 12px;\n}\n\n.graph-container {\n  flex: 1;\n  position: relative;\n  overflow: hidden;\n}\n\n.graph-empty {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n\n.graph-info {\n  position: absolute;\n  top: 10px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: auto;\n}\n\n.loading-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  background: rgba(255, 255, 255, 0.9);\n  z-index: 10;\n}\n\n.node-detail h3 {\n  font-size: 18px;\n  margin-bottom: 16px;\n  color: #303133;\n}\n\n.connected-papers {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.paper-card {\n  cursor: pointer;\n}\n\n.paper-title {\n  font-size: 14px;\n  font-weight: 600;\n  color: #409EFF;\n  margin-bottom: 8px;\n}\n\n.paper-title:hover {\n  text-decoration: underline;\n}\n\n.paper-meta {\n  display: flex;\n  gap: 12px;\n  font-size: 12px;\n  color: #909399;\n}\n\n.legend-panel {\n  position: absolute;\n  bottom: 20px;\n  right: 20px;\n  background: rgba(255, 255, 255, 0.95);\n  padding: 16px;\n  border-radius: 8px;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.legend-title {\n  font-weight: 600;\n  margin-bottom: 12px;\n}\n\n.legend-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 8px;\n  font-size: 12px;\n}\n\n.legend-color {\n  width: 20px;\n  height: 4px;\n  border-radius: 2px;\n}\n\n.stats-panel {\n  position: absolute;\n  bottom: 20px;\n  left: 20px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}