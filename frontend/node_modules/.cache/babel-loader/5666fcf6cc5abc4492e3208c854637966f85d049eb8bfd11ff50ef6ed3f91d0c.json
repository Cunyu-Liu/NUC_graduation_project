{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport { inject, getCurrentInstance, computed, watch, nextTick } from 'vue';\nimport { checkboxGroupContextKey } from '../constants.mjs';\nimport { useFormItem } from '../../../form/src/hooks/use-form-item.mjs';\nimport { debugWarn } from '../../../../utils/error.mjs';\nimport { CHANGE_EVENT } from '../../../../constants/event.mjs';\nconst useCheckboxEvent = (props, {\n  model,\n  isLimitExceeded,\n  hasOwnLabel,\n  isDisabled,\n  isLabeledByFormItem\n}) => {\n  const checkboxGroup = inject(checkboxGroupContextKey, void 0);\n  const {\n    formItem\n  } = useFormItem();\n  const {\n    emit\n  } = getCurrentInstance();\n  function getLabeledValue(value) {\n    var _a, _b, _c, _d;\n    return [true, props.trueValue, props.trueLabel].includes(value) ? (_b = (_a = props.trueValue) != null ? _a : props.trueLabel) != null ? _b : true : (_d = (_c = props.falseValue) != null ? _c : props.falseLabel) != null ? _d : false;\n  }\n  function emitChangeEvent(checked, e) {\n    emit(CHANGE_EVENT, getLabeledValue(checked), e);\n  }\n  function handleChange(e) {\n    if (isLimitExceeded.value) return;\n    const target = e.target;\n    emit(CHANGE_EVENT, getLabeledValue(target.checked), e);\n  }\n  async function onClickRoot(e) {\n    if (isLimitExceeded.value) return;\n    if (!hasOwnLabel.value && !isDisabled.value && isLabeledByFormItem.value) {\n      const eventTargets = e.composedPath();\n      const hasLabel = eventTargets.some(item => item.tagName === \"LABEL\");\n      if (!hasLabel) {\n        model.value = getLabeledValue([false, props.falseValue, props.falseLabel].includes(model.value));\n        await nextTick();\n        emitChangeEvent(model.value, e);\n      }\n    }\n  }\n  const validateEvent = computed(() => (checkboxGroup == null ? void 0 : checkboxGroup.validateEvent) || props.validateEvent);\n  watch(() => props.modelValue, () => {\n    if (validateEvent.value) {\n      formItem == null ? void 0 : formItem.validate(\"change\").catch(err => debugWarn(err));\n    }\n  });\n  return {\n    handleChange,\n    onClickRoot\n  };\n};\nexport { useCheckboxEvent };","map":{"version":3,"names":["useCheckboxEvent","props","model","isLimitExceeded","hasOwnLabel","isDisabled","isLabeledByFormItem","checkboxGroup","inject","checkboxGroupContextKey","formItem","useFormItem","emit","getCurrentInstance","getLabeledValue","value","_a","_b","_c","_d","trueValue","trueLabel","includes","falseValue","falseLabel","emitChangeEvent","checked","e","CHANGE_EVENT","handleChange","target","onClickRoot","eventTargets","composedPath","hasLabel","some","item","tagName","nextTick","validateEvent","computed","watch","modelValue","validate","catch","err","debugWarn"],"sources":["../../../../../../../packages/components/checkbox/src/composables/use-checkbox-event.ts"],"sourcesContent":["import { computed, getCurrentInstance, inject, nextTick, watch } from 'vue'\nimport { useFormItem } from '@element-plus/components/form'\nimport { debugWarn } from '@element-plus/utils'\nimport { CHANGE_EVENT } from '@element-plus/constants'\nimport { checkboxGroupContextKey } from '../constants'\n\nimport type { useFormItemInputId } from '@element-plus/components/form'\nimport type { CheckboxProps } from '../checkbox'\nimport type {\n  CheckboxDisabled,\n  CheckboxModel,\n  CheckboxStatus,\n} from '../composables'\n\nexport const useCheckboxEvent = (\n  props: CheckboxProps,\n  {\n    model,\n    isLimitExceeded,\n    hasOwnLabel,\n    isDisabled,\n    isLabeledByFormItem,\n  }: Pick<CheckboxModel, 'model' | 'isLimitExceeded'> &\n    Pick<CheckboxStatus, 'hasOwnLabel'> &\n    Pick<CheckboxDisabled, 'isDisabled'> &\n    Pick<ReturnType<typeof useFormItemInputId>, 'isLabeledByFormItem'>\n) => {\n  const checkboxGroup = inject(checkboxGroupContextKey, undefined)\n  const { formItem } = useFormItem()\n  const { emit } = getCurrentInstance()!\n\n  function getLabeledValue(value: string | number | boolean) {\n    return [true, props.trueValue, props.trueLabel].includes(value)\n      ? (props.trueValue ?? props.trueLabel ?? true)\n      : (props.falseValue ?? props.falseLabel ?? false)\n  }\n\n  function emitChangeEvent(\n    checked: string | number | boolean,\n    e: InputEvent | MouseEvent\n  ) {\n    emit(CHANGE_EVENT, getLabeledValue(checked), e)\n  }\n\n  function handleChange(e: Event) {\n    if (isLimitExceeded.value) return\n\n    const target = e.target as HTMLInputElement\n    emit(CHANGE_EVENT, getLabeledValue(target.checked), e)\n  }\n\n  async function onClickRoot(e: MouseEvent) {\n    if (isLimitExceeded.value) return\n\n    if (!hasOwnLabel.value && !isDisabled.value && isLabeledByFormItem.value) {\n      // fix: https://github.com/element-plus/element-plus/issues/9981\n      const eventTargets: EventTarget[] = e.composedPath()\n      const hasLabel = eventTargets.some(\n        (item) => (item as HTMLElement).tagName === 'LABEL'\n      )\n      if (!hasLabel) {\n        model.value = getLabeledValue(\n          [false, props.falseValue, props.falseLabel].includes(model.value)\n        )\n        await nextTick()\n        emitChangeEvent(model.value, e)\n      }\n    }\n  }\n\n  const validateEvent = computed(\n    () => checkboxGroup?.validateEvent || props.validateEvent\n  )\n\n  watch(\n    () => props.modelValue,\n    () => {\n      if (validateEvent.value) {\n        formItem?.validate('change').catch((err) => debugWarn(err))\n      }\n    }\n  )\n\n  return {\n    handleChange,\n    onClickRoot,\n  }\n}\n"],"mappings":";;;;;;;AAca,MAAAA,gBAAA,GAAmBA,CAC9BC,KACA;EACEC,KAAA;EACAC,eAAA;EACAC,WAAA;EACAC,UAAA;EACAC;AACF,CAIG;EACG,MAAAC,aAAA,GAAgBC,MAAO,CAAAC,uBAAA,EAAyB,KAAS;EACzD;IAAEC;EAAS,IAAIC,WAAY;EAC3B;IAAEC;EAAK,IAAIC,kBAAmB;EAEpC,SAASC,gBAAgBC,KAAkC;IA/B7D,IAAAC,EAAA,EAAAC,EAAA,EAAAC,EAAA,EAAAC,EAAA;IAgCW,QAAC,MAAMlB,KAAM,CAAAmB,SAAA,EAAWnB,KAAA,CAAMoB,SAAS,EAAEC,QAAS,CAAAP,KAAK,CACzD,IAAAE,EAAA,IAAAD,EAAA,GAAAf,KAAA,CAAMmB,SAAA,KAAN,IAAmB,GAAAJ,EAAA,GAAAf,KAAA,CAAMoB,SAAA,KAAzB,IAAsC,GAAAJ,EAAA,WACtCE,EAAA,IAAAD,EAAA,GAAAjB,KAAA,CAAMsB,UAAN,YAAAL,EAAA,GAAoBjB,KAAM,CAAAuB,UAAA,KAA1B,IAAwC,GAAAL,EAAA;EAAA;EAGtC,SAAAM,gBACPC,OAAA,EACAC,CACA;IACAf,IAAA,CAAKgB,YAAc,EAAAd,eAAA,CAAgBY,OAAO,GAAGC,CAAC;EAAA;EAGhD,SAASE,aAAaF,CAAU;IAC9B,IAAIxB,eAAgB,CAAAY,KAAA,EAAO;IAE3B,MAAMe,MAAA,GAASH,CAAE,CAAAG,MAAA;IACjBlB,IAAA,CAAKgB,YAAc,EAAAd,eAAA,CAAgBgB,MAAO,CAAAJ,OAAO,GAAGC,CAAC;EAAA;EAGvD,eAAeI,YAAYJ,CAAe;IACxC,IAAIxB,eAAgB,CAAAY,KAAA,EAAO;IAE3B,IAAI,CAACX,WAAY,CAAAW,KAAA,IAAS,CAACV,UAAW,CAAAU,KAAA,IAAST,mBAAA,CAAoBS,KAAO;MAElE,MAAAiB,YAAA,GAA8BL,CAAA,CAAEM,YAAa;MACnD,MAAMC,QAAA,GAAWF,YAAa,CAAAG,IAAA,CAC3BC,IAAU,IAAAA,IAAA,CAAqBC,OAAY,aAC9C;MACA,IAAI,CAACH,QAAU;QACbhC,KAAA,CAAMa,KAAQ,GAAAD,eAAA,CACZ,CAAC,OAAOb,KAAM,CAAAsB,UAAA,EAAYtB,KAAA,CAAMuB,UAAU,EAAEF,QAAS,CAAApB,KAAA,CAAMa,KAAK,EAClE;QACA,MAAMuB,QAAS;QACCb,eAAA,CAAAvB,KAAA,CAAMa,KAAA,EAAOY,CAAC;MAAA;IAChC;EACF;EAGF,MAAMY,aAAgB,GAAAC,QAAA,CACpB,OAAMjC,aAAe,oBAAAA,aAAA,CAAAgC,aAAA,KAAiBtC,KAAM,CAAAsC,aAAA,CAC9C;EAEAE,KAAA,CACE,MAAMxC,KAAM,CAAAyC,UAAA,EACZ,MAAM;IACJ,IAAIH,aAAA,CAAcxB,KAAO;MACvBL,QAAA,oBAAAA,QAAA,CAAUiC,QAAA,CAAS,QAAU,EAAAC,KAAA,CAAOC,GAAA,IAAQC,SAAA,CAAUD,GAAG;IAAA;EAC3D,CACF,CACF;EAEO;IACLhB,YAAA;IACAE;EAAA,CACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}