{"ast":null,"code":"import { defineComponent, ref, computed, watch, nextTick, provide, openBlock, createBlock, unref, withCtx, withDirectives, mergeProps, withKeys, createElementVNode, normalizeClass, createTextVNode, toDisplayString, createCommentVNode, createVNode, normalizeStyle, vShow } from 'vue';\nimport { pick, debounce } from 'lodash-unified';\nimport { ElIcon } from '../../icon/index.mjs';\nimport { reactiveComputed } from '@vueuse/core';\nimport { ElTooltip } from '../../tooltip/index.mjs';\nimport { ElButton } from '../../button/index.mjs';\nimport { ArrowDown, Close } from '@element-plus/icons-vue';\nimport { colorPickerProps, colorPickerEmits } from './color-picker.mjs';\nimport { ElColorPickerPanel } from '../../color-picker-panel/index.mjs';\nimport Color from '../../color-picker-panel/src/utils/color.mjs';\nimport { useCommonColor } from '../../color-picker-panel/src/composables/use-common-color.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { colorPickerPanelProps, ROOT_COMMON_COLOR_INJECTION_KEY } from '../../color-picker-panel/src/color-picker-panel.mjs';\nimport ClickOutside from '../../../directives/click-outside/index.mjs';\nimport { useLocale } from '../../../hooks/use-locale/index.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useFormItem, useFormItemInputId } from '../../form/src/hooks/use-form-item.mjs';\nimport { useFormSize, useFormDisabled } from '../../form/src/hooks/use-form-common-props.mjs';\nimport { useEmptyValues } from '../../../hooks/use-empty-values/index.mjs';\nimport { useFocusController } from '../../../hooks/use-focus-controller/index.mjs';\nimport { debugWarn } from '../../../utils/error.mjs';\nimport { UPDATE_MODEL_EVENT, CHANGE_EVENT } from '../../../constants/event.mjs';\nimport { getEventCode } from '../../../utils/dom/event.mjs';\nimport { EVENT_CODE } from '../../../constants/aria.mjs';\nconst _hoisted_1 = [\"id\", \"aria-label\", \"aria-labelledby\", \"aria-description\", \"aria-disabled\", \"tabindex\"];\nconst _sfc_main = defineComponent({\n  ...{\n    name: \"ElColorPicker\"\n  },\n  __name: \"color-picker\",\n  props: colorPickerProps,\n  emits: colorPickerEmits,\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    const props = __props;\n    const emit = __emit;\n    const {\n      t\n    } = useLocale();\n    const ns = useNamespace(\"color\");\n    const {\n      formItem\n    } = useFormItem();\n    const colorSize = useFormSize();\n    const colorDisabled = useFormDisabled();\n    const {\n      valueOnClear,\n      isEmptyValue\n    } = useEmptyValues(props, null);\n    const commonColor = useCommonColor(props, emit);\n    const {\n      inputId: buttonId,\n      isLabeledByFormItem\n    } = useFormItemInputId(props, {\n      formItemContext: formItem\n    });\n    const popper = ref();\n    const triggerRef = ref();\n    const pickerPanelRef = ref();\n    const showPicker = ref(false);\n    const showPanelColor = ref(false);\n    let shouldActiveChange = true;\n    const {\n      isFocused,\n      handleFocus,\n      handleBlur\n    } = useFocusController(triggerRef, {\n      disabled: colorDisabled,\n      beforeBlur(event) {\n        var _a;\n        return (_a = popper.value) == null ? void 0 : _a.isFocusInsideContent(event);\n      },\n      afterBlur() {\n        var _a;\n        setShowPicker(false);\n        resetColor();\n        if (props.validateEvent) {\n          (_a = formItem == null ? void 0 : formItem.validate) == null ? void 0 : _a.call(formItem, \"blur\").catch(err => debugWarn(err));\n        }\n      }\n    });\n    const color = reactiveComputed(() => {\n      var _a, _b;\n      return (_b = (_a = pickerPanelRef.value) == null ? void 0 : _a.color) != null ? _b : commonColor.color;\n    });\n    const panelProps = computed(() => pick(props, Object.keys(colorPickerPanelProps)));\n    const displayedColor = computed(() => {\n      if (!props.modelValue && !showPanelColor.value) {\n        return \"transparent\";\n      }\n      return displayedRgb(color, props.showAlpha);\n    });\n    const currentColor = computed(() => {\n      return !props.modelValue && !showPanelColor.value ? \"\" : color.value;\n    });\n    const buttonAriaLabel = computed(() => {\n      return !isLabeledByFormItem.value ? props.ariaLabel || t(\"el.colorpicker.defaultLabel\") : void 0;\n    });\n    const buttonAriaLabelledby = computed(() => {\n      return isLabeledByFormItem.value ? formItem == null ? void 0 : formItem.labelId : void 0;\n    });\n    const btnKls = computed(() => {\n      return [ns.b(\"picker\"), ns.is(\"disabled\", colorDisabled.value), ns.bm(\"picker\", colorSize.value), ns.is(\"focused\", isFocused.value)];\n    });\n    function displayedRgb(color2, showAlpha) {\n      const {\n        r,\n        g,\n        b,\n        a\n      } = color2.toRgb();\n      return showAlpha ? `rgba(${r}, ${g}, ${b}, ${a})` : `rgb(${r}, ${g}, ${b})`;\n    }\n    function setShowPicker(value) {\n      showPicker.value = value;\n    }\n    const debounceSetShowPicker = debounce(setShowPicker, 100, {\n      leading: true\n    });\n    function show() {\n      if (colorDisabled.value) return;\n      setShowPicker(true);\n    }\n    function hide() {\n      debounceSetShowPicker(false);\n      resetColor();\n    }\n    function resetColor() {\n      nextTick(() => {\n        if (props.modelValue) {\n          color.fromString(props.modelValue);\n        } else {\n          color.value = \"\";\n          nextTick(() => {\n            showPanelColor.value = false;\n          });\n        }\n      });\n    }\n    function handleTrigger() {\n      if (colorDisabled.value) return;\n      if (showPicker.value) {\n        resetColor();\n      }\n      debounceSetShowPicker(!showPicker.value);\n    }\n    function confirmValue() {\n      const value = isEmptyValue(color.value) ? valueOnClear.value : color.value;\n      emit(UPDATE_MODEL_EVENT, value);\n      emit(CHANGE_EVENT, value);\n      if (props.validateEvent) {\n        formItem == null ? void 0 : formItem.validate(\"change\").catch(err => debugWarn(err));\n      }\n      debounceSetShowPicker(false);\n      nextTick(() => {\n        const newColor = new Color({\n          enableAlpha: props.showAlpha,\n          format: props.colorFormat || \"\",\n          value: props.modelValue\n        });\n        if (!color.compare(newColor)) {\n          resetColor();\n        }\n      });\n    }\n    function clear() {\n      debounceSetShowPicker(false);\n      emit(UPDATE_MODEL_EVENT, valueOnClear.value);\n      emit(CHANGE_EVENT, valueOnClear.value);\n      if (props.modelValue !== valueOnClear.value && props.validateEvent) {\n        formItem == null ? void 0 : formItem.validate(\"change\").catch(err => debugWarn(err));\n      }\n      resetColor();\n      emit(\"clear\");\n    }\n    function handleShowTooltip() {\n      var _a, _b;\n      (_b = (_a = pickerPanelRef == null ? void 0 : pickerPanelRef.value) == null ? void 0 : _a.inputRef) == null ? void 0 : _b.focus();\n    }\n    function handleClickOutside() {\n      if (!showPicker.value) return;\n      hide();\n      isFocused.value && focus();\n    }\n    function handleEsc(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      setShowPicker(false);\n      resetColor();\n    }\n    function handleKeyDown(event) {\n      const code = getEventCode(event);\n      switch (code) {\n        case EVENT_CODE.enter:\n        case EVENT_CODE.numpadEnter:\n        case EVENT_CODE.space:\n          event.preventDefault();\n          event.stopPropagation();\n          show();\n          break;\n        case EVENT_CODE.esc:\n          handleEsc(event);\n          break;\n      }\n    }\n    function focus() {\n      triggerRef.value.focus();\n    }\n    function blur() {\n      triggerRef.value.blur();\n    }\n    watch(() => currentColor.value, val => {\n      shouldActiveChange && emit(\"activeChange\", val);\n      shouldActiveChange = true;\n    });\n    watch(() => color.value, () => {\n      if (!props.modelValue && !showPanelColor.value) {\n        showPanelColor.value = true;\n      }\n    });\n    watch(() => props.modelValue, newVal => {\n      if (!newVal) {\n        showPanelColor.value = false;\n      } else if (newVal && newVal !== color.value) {\n        shouldActiveChange = false;\n        color.fromString(newVal);\n      }\n    });\n    watch(() => showPicker.value, () => {\n      pickerPanelRef.value && nextTick(pickerPanelRef.value.update);\n    });\n    provide(ROOT_COMMON_COLOR_INJECTION_KEY, commonColor);\n    __expose({\n      color,\n      show,\n      hide,\n      focus,\n      blur\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(unref(ElTooltip), {\n        ref_key: \"popper\",\n        ref: popper,\n        visible: showPicker.value,\n        \"show-arrow\": false,\n        \"fallback-placements\": [\"bottom\", \"top\", \"right\", \"left\"],\n        offset: 0,\n        \"gpu-acceleration\": false,\n        \"popper-class\": [unref(ns).be(\"picker\", \"panel\"), _ctx.popperClass],\n        \"popper-style\": _ctx.popperStyle,\n        \"stop-popper-mouse-event\": false,\n        pure: \"\",\n        loop: \"\",\n        role: \"dialog\",\n        effect: \"light\",\n        trigger: \"click\",\n        teleported: _ctx.teleported,\n        transition: `${unref(ns).namespace.value}-zoom-in-top`,\n        persistent: _ctx.persistent,\n        \"append-to\": _ctx.appendTo,\n        onShow: handleShowTooltip,\n        onHide: _cache[2] || (_cache[2] = $event => setShowPicker(false))\n      }, {\n        content: withCtx(() => [withDirectives((openBlock(), createBlock(unref(ElColorPickerPanel), mergeProps({\n          ref_key: \"pickerPanelRef\",\n          ref: pickerPanelRef\n        }, panelProps.value, {\n          border: false,\n          \"validate-event\": false,\n          onKeydown: withKeys(handleEsc, [\"esc\"])\n        }), {\n          footer: withCtx(() => [createElementVNode(\"div\", null, [_ctx.clearable ? (openBlock(), createBlock(unref(ElButton), {\n            key: 0,\n            class: normalizeClass(unref(ns).be(\"footer\", \"link-btn\")),\n            text: \"\",\n            size: \"small\",\n            onClick: clear\n          }, {\n            default: withCtx(() => [createTextVNode(toDisplayString(unref(t)(\"el.colorpicker.clear\")), 1)]),\n            _: 1\n          }, 8, [\"class\"])) : createCommentVNode(\"v-if\", true), createVNode(unref(ElButton), {\n            plain: \"\",\n            size: \"small\",\n            class: normalizeClass(unref(ns).be(\"footer\", \"btn\")),\n            onClick: confirmValue\n          }, {\n            default: withCtx(() => [createTextVNode(toDisplayString(unref(t)(\"el.colorpicker.confirm\")), 1)]),\n            _: 1\n          }, 8, [\"class\"])])]),\n          _: 1\n        }, 16)), [[unref(ClickOutside), handleClickOutside, triggerRef.value]])]),\n        default: withCtx(() => [createElementVNode(\"div\", mergeProps({\n          id: unref(buttonId),\n          ref_key: \"triggerRef\",\n          ref: triggerRef\n        }, _ctx.$attrs, {\n          class: btnKls.value,\n          role: \"button\",\n          \"aria-label\": buttonAriaLabel.value,\n          \"aria-labelledby\": buttonAriaLabelledby.value,\n          \"aria-description\": unref(t)(\"el.colorpicker.description\", {\n            color: _ctx.modelValue || \"\"\n          }),\n          \"aria-disabled\": unref(colorDisabled),\n          tabindex: unref(colorDisabled) ? void 0 : _ctx.tabindex,\n          onKeydown: handleKeyDown,\n          onFocus: _cache[0] || (_cache[0] = (...args) => unref(handleFocus) && unref(handleFocus)(...args)),\n          onBlur: _cache[1] || (_cache[1] = (...args) => unref(handleBlur) && unref(handleBlur)(...args))\n        }), [createElementVNode(\"div\", {\n          class: normalizeClass(unref(ns).be(\"picker\", \"trigger\")),\n          onClick: handleTrigger\n        }, [createElementVNode(\"span\", {\n          class: normalizeClass([unref(ns).be(\"picker\", \"color\"), unref(ns).is(\"alpha\", _ctx.showAlpha)])\n        }, [createElementVNode(\"span\", {\n          class: normalizeClass(unref(ns).be(\"picker\", \"color-inner\")),\n          style: normalizeStyle({\n            backgroundColor: displayedColor.value\n          })\n        }, [withDirectives(createVNode(unref(ElIcon), {\n          class: normalizeClass([unref(ns).be(\"picker\", \"icon\"), unref(ns).is(\"icon-arrow-down\")])\n        }, {\n          default: withCtx(() => [createVNode(unref(ArrowDown))]),\n          _: 1\n        }, 8, [\"class\"]), [[vShow, _ctx.modelValue || showPanelColor.value]]), withDirectives(createVNode(unref(ElIcon), {\n          class: normalizeClass([unref(ns).be(\"picker\", \"empty\"), unref(ns).is(\"icon-close\")])\n        }, {\n          default: withCtx(() => [createVNode(unref(Close))]),\n          _: 1\n        }, 8, [\"class\"]), [[vShow, !_ctx.modelValue && !showPanelColor.value]])], 6)], 2)], 2)], 16, _hoisted_1)]),\n        _: 1\n      }, 8, [\"visible\", \"popper-class\", \"popper-style\", \"teleported\", \"transition\", \"persistent\", \"append-to\"]);\n    };\n  }\n});\nvar ColorPicker = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/color-picker.vue\"]]);\nexport { ColorPicker as default };","map":{"version":3,"names":["props","__props","emit","__emit","t","useLocale","ns","useNamespace","formItem","useFormItem","colorSize","useFormSize","colorDisabled","useFormDisabled","valueOnClear","isEmptyValue","useEmptyValues","commonColor","useCommonColor","inputId","buttonId","isLabeledByFormItem","useFormItemInputId","formItemContext","popper","ref","triggerRef","pickerPanelRef","showPicker","showPanelColor","shouldActiveChange","isFocused","handleFocus","handleBlur","useFocusController","disabled","beforeBlur","event","_a","value","isFocusInsideContent","afterBlur","setShowPicker","resetColor","validateEvent","validate","call","catch","err","debugWarn","color","reactiveComputed","_b","panelProps","computed","pick","Object","keys","colorPickerPanelProps","displayedColor","modelValue","displayedRgb","showAlpha","currentColor","buttonAriaLabel","ariaLabel","buttonAriaLabelledby","labelId","btnKls","b","is","bm","color2","r","g","a","toRgb","debounceSetShowPicker","debounce","leading","show","hide","nextTick","fromString","handleTrigger","confirmValue","UPDATE_MODEL_EVENT","CHANGE_EVENT","newColor","Color","enableAlpha","format","colorFormat","compare","clear","handleShowTooltip","inputRef","focus","handleClickOutside","handleEsc","preventDefault","stopPropagation","handleKeyDown","code","getEventCode","EVENT_CODE","enter","numpadEnter","space","esc","blur","watch","val","newVal","update","provide","ROOT_COMMON_COLOR_INJECTION_KEY","__expose","createBlock","unref","ElTooltip","ref_key","visible","offset","be","_ctx","popperClass","popperStyle","pure","loop","role","effect","trigger","teleported","transition","namespace","persistent","appendTo","onShow","onHide","_cache","$event","content","withCtx","withDirectives","openBlock","ElColorPickerPanel","mergeProps","border","onKeydown","withKeys","footer","createElementVNode","clearable","ElButton","key","class","normalizeClass","text","size","onClick","default","createTextVNode","toDisplayString","_","createVNode","plain","ClickOutside","id","$attrs","tabindex","onFocus","args","onBlur","style","normalizeStyle","backgroundColor","ElIcon","ArrowDown","vShow","Close"],"sources":["../../../../../../packages/components/color-picker/src/color-picker.vue"],"sourcesContent":["<template>\n  <el-tooltip\n    ref=\"popper\"\n    :visible=\"showPicker\"\n    :show-arrow=\"false\"\n    :fallback-placements=\"['bottom', 'top', 'right', 'left']\"\n    :offset=\"0\"\n    :gpu-acceleration=\"false\"\n    :popper-class=\"[ns.be('picker', 'panel'), popperClass!]\"\n    :popper-style=\"popperStyle\"\n    :stop-popper-mouse-event=\"false\"\n    pure\n    loop\n    role=\"dialog\"\n    effect=\"light\"\n    trigger=\"click\"\n    :teleported=\"teleported\"\n    :transition=\"`${ns.namespace.value}-zoom-in-top`\"\n    :persistent=\"persistent\"\n    :append-to=\"appendTo\"\n    @show=\"handleShowTooltip\"\n    @hide=\"setShowPicker(false)\"\n  >\n    <template #content>\n      <el-color-picker-panel\n        ref=\"pickerPanelRef\"\n        v-bind=\"panelProps\"\n        v-click-outside:[triggerRef]=\"handleClickOutside\"\n        :border=\"false\"\n        :validate-event=\"false\"\n        @keydown.esc=\"handleEsc\"\n      >\n        <template #footer>\n          <div>\n            <el-button\n              v-if=\"clearable\"\n              :class=\"ns.be('footer', 'link-btn')\"\n              text\n              size=\"small\"\n              @click=\"clear\"\n            >\n              {{ t('el.colorpicker.clear') }}\n            </el-button>\n            <el-button\n              plain\n              size=\"small\"\n              :class=\"ns.be('footer', 'btn')\"\n              @click=\"confirmValue\"\n            >\n              {{ t('el.colorpicker.confirm') }}\n            </el-button>\n          </div>\n        </template>\n      </el-color-picker-panel>\n    </template>\n    <template #default>\n      <div\n        :id=\"buttonId\"\n        ref=\"triggerRef\"\n        v-bind=\"$attrs\"\n        :class=\"btnKls\"\n        role=\"button\"\n        :aria-label=\"buttonAriaLabel\"\n        :aria-labelledby=\"buttonAriaLabelledby\"\n        :aria-description=\"\n          t('el.colorpicker.description', { color: modelValue || '' })\n        \"\n        :aria-disabled=\"colorDisabled\"\n        :tabindex=\"colorDisabled ? undefined : tabindex\"\n        @keydown=\"handleKeyDown\"\n        @focus=\"handleFocus\"\n        @blur=\"handleBlur\"\n      >\n        <div :class=\"ns.be('picker', 'trigger')\" @click=\"handleTrigger\">\n          <span :class=\"[ns.be('picker', 'color'), ns.is('alpha', showAlpha)]\">\n            <span\n              :class=\"ns.be('picker', 'color-inner')\"\n              :style=\"{\n                backgroundColor: displayedColor,\n              }\"\n            >\n              <el-icon\n                v-show=\"modelValue || showPanelColor\"\n                :class=\"[ns.be('picker', 'icon'), ns.is('icon-arrow-down')]\"\n              >\n                <arrow-down />\n              </el-icon>\n              <el-icon\n                v-show=\"!modelValue && !showPanelColor\"\n                :class=\"[ns.be('picker', 'empty'), ns.is('icon-close')]\"\n              >\n                <close />\n              </el-icon>\n            </span>\n          </span>\n        </div>\n      </div>\n    </template>\n  </el-tooltip>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, nextTick, provide, ref, watch } from 'vue'\nimport { debounce, pick } from 'lodash-unified'\nimport { ElIcon } from '@element-plus/components/icon'\nimport { reactiveComputed } from '@vueuse/core'\nimport { ClickOutside as vClickOutside } from '@element-plus/directives'\nimport { ElTooltip } from '@element-plus/components/tooltip'\nimport { ElButton } from '@element-plus/components/button'\nimport {\n  useFormDisabled,\n  useFormItem,\n  useFormItemInputId,\n  useFormSize,\n} from '@element-plus/components/form'\nimport {\n  useEmptyValues,\n  useFocusController,\n  useLocale,\n  useNamespace,\n} from '@element-plus/hooks'\nimport {\n  CHANGE_EVENT,\n  EVENT_CODE,\n  UPDATE_MODEL_EVENT,\n} from '@element-plus/constants'\nimport { debugWarn, getEventCode } from '@element-plus/utils'\nimport { ArrowDown, Close } from '@element-plus/icons-vue'\nimport { colorPickerEmits, colorPickerProps } from './color-picker'\nimport {\n  ElColorPickerPanel,\n  ROOT_COMMON_COLOR_INJECTION_KEY,\n  colorPickerPanelProps,\n} from '@element-plus/components/color-picker-panel'\nimport Color from '@element-plus/components/color-picker-panel/src/utils/color'\nimport { useCommonColor } from '@element-plus/components/color-picker-panel/src/composables/use-common-color'\n\nimport type { ColorPickerPanelInstance } from '@element-plus/components/color-picker-panel'\nimport type { TooltipInstance } from '@element-plus/components/tooltip'\n\ndefineOptions({\n  name: 'ElColorPicker',\n})\nconst props = defineProps(colorPickerProps)\n\nconst emit = defineEmits(colorPickerEmits)\n\nconst { t } = useLocale()\nconst ns = useNamespace('color')\nconst { formItem } = useFormItem()\nconst colorSize = useFormSize()\nconst colorDisabled = useFormDisabled()\nconst { valueOnClear, isEmptyValue } = useEmptyValues(props, null)\nconst commonColor = useCommonColor(props, emit)\nconst { inputId: buttonId, isLabeledByFormItem } = useFormItemInputId(props, {\n  formItemContext: formItem,\n})\n\nconst popper = ref<TooltipInstance>()\nconst triggerRef = ref()\nconst pickerPanelRef = ref<ColorPickerPanelInstance>()\nconst showPicker = ref(false)\nconst showPanelColor = ref(false)\n\n// active-change is used to prevent modelValue changes from triggering.\nlet shouldActiveChange = true\n\nconst { isFocused, handleFocus, handleBlur } = useFocusController(triggerRef, {\n  disabled: colorDisabled,\n  beforeBlur(event) {\n    return popper.value?.isFocusInsideContent(event)\n  },\n  afterBlur() {\n    setShowPicker(false)\n    resetColor()\n    if (props.validateEvent) {\n      formItem?.validate?.('blur').catch((err) => debugWarn(err))\n    }\n  },\n})\n\nconst color = reactiveComputed(\n  () => pickerPanelRef.value?.color ?? commonColor.color\n) as Color\n\nconst panelProps = computed(() =>\n  pick(props, Object.keys(colorPickerPanelProps))\n)\n\nconst displayedColor = computed(() => {\n  if (!props.modelValue && !showPanelColor.value) {\n    return 'transparent'\n  }\n  return displayedRgb(color, props.showAlpha)\n})\n\nconst currentColor = computed(() => {\n  return !props.modelValue && !showPanelColor.value ? '' : color.value\n})\n\nconst buttonAriaLabel = computed<string | undefined>(() => {\n  return !isLabeledByFormItem.value\n    ? props.ariaLabel || t('el.colorpicker.defaultLabel')\n    : undefined\n})\n\nconst buttonAriaLabelledby = computed<string | undefined>(() => {\n  return isLabeledByFormItem.value ? formItem?.labelId : undefined\n})\n\nconst btnKls = computed(() => {\n  return [\n    ns.b('picker'),\n    ns.is('disabled', colorDisabled.value),\n    ns.bm('picker', colorSize.value),\n    ns.is('focused', isFocused.value),\n  ]\n})\n\nfunction displayedRgb(color: Color, showAlpha: boolean) {\n  const { r, g, b, a } = color.toRgb()\n  return showAlpha ? `rgba(${r}, ${g}, ${b}, ${a})` : `rgb(${r}, ${g}, ${b})`\n}\n\nfunction setShowPicker(value: boolean) {\n  showPicker.value = value\n}\n\nconst debounceSetShowPicker = debounce(setShowPicker, 100, { leading: true })\nfunction show() {\n  if (colorDisabled.value) return\n  setShowPicker(true)\n}\n\nfunction hide() {\n  debounceSetShowPicker(false)\n  resetColor()\n}\n\nfunction resetColor() {\n  nextTick(() => {\n    if (props.modelValue) {\n      color.fromString(props.modelValue)\n    } else {\n      color.value = ''\n      nextTick(() => {\n        showPanelColor.value = false\n      })\n    }\n  })\n}\n\nfunction handleTrigger() {\n  if (colorDisabled.value) return\n  if (showPicker.value) {\n    resetColor()\n  }\n  debounceSetShowPicker(!showPicker.value)\n}\n\nfunction confirmValue() {\n  const value = isEmptyValue(color.value) ? valueOnClear.value : color.value\n  emit(UPDATE_MODEL_EVENT, value)\n  emit(CHANGE_EVENT, value)\n  if (props.validateEvent) {\n    formItem?.validate('change').catch((err) => debugWarn(err))\n  }\n  debounceSetShowPicker(false)\n  // check if modelValue change, if not change, then reset color.\n  nextTick(() => {\n    const newColor = new Color({\n      enableAlpha: props.showAlpha,\n      format: props.colorFormat || '',\n      value: props.modelValue,\n    })\n    if (!color.compare(newColor)) {\n      resetColor()\n    }\n  })\n}\n\nfunction clear() {\n  debounceSetShowPicker(false)\n  emit(UPDATE_MODEL_EVENT, valueOnClear.value)\n  emit(CHANGE_EVENT, valueOnClear.value)\n  if (props.modelValue !== valueOnClear.value && props.validateEvent) {\n    formItem?.validate('change').catch((err) => debugWarn(err))\n  }\n  resetColor()\n  emit('clear')\n}\n\nfunction handleShowTooltip() {\n  pickerPanelRef?.value?.inputRef?.focus()\n}\n\nfunction handleClickOutside() {\n  if (!showPicker.value) return\n  hide()\n  isFocused.value && focus()\n}\n\nfunction handleEsc(event: KeyboardEvent) {\n  event.preventDefault()\n  event.stopPropagation()\n  setShowPicker(false)\n  resetColor()\n}\n\nfunction handleKeyDown(event: KeyboardEvent) {\n  const code = getEventCode(event)\n\n  switch (code) {\n    case EVENT_CODE.enter:\n    case EVENT_CODE.numpadEnter:\n    case EVENT_CODE.space:\n      event.preventDefault()\n      event.stopPropagation()\n      show()\n      break\n    case EVENT_CODE.esc:\n      handleEsc(event)\n      break\n  }\n}\n\nfunction focus() {\n  triggerRef.value.focus()\n}\n\nfunction blur() {\n  triggerRef.value.blur()\n}\n\nwatch(\n  () => currentColor.value,\n  (val) => {\n    shouldActiveChange && emit('activeChange', val)\n    shouldActiveChange = true\n  }\n)\n\nwatch(\n  () => color.value,\n  () => {\n    if (!props.modelValue && !showPanelColor.value) {\n      showPanelColor.value = true\n    }\n  }\n)\n\nwatch(\n  () => props.modelValue,\n  (newVal) => {\n    if (!newVal) {\n      showPanelColor.value = false\n    } else if (newVal && newVal !== color.value) {\n      shouldActiveChange = false\n      color.fromString(newVal)\n    }\n  }\n)\n\nwatch(\n  () => showPicker.value,\n  () => {\n    pickerPanelRef.value && nextTick(pickerPanelRef.value.update)\n  }\n)\n\nprovide(ROOT_COMMON_COLOR_INJECTION_KEY, commonColor)\n\ndefineExpose({\n  /**\n   * @description current color object\n   */\n  color,\n  /**\n   * @description manually show ColorPicker\n   */\n  show,\n  /**\n   * @description manually hide ColorPicker\n   */\n  hide,\n  /**\n   * @description focus the input element\n   */\n  focus,\n  /**\n   * @description blur the input element\n   */\n  blur,\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}