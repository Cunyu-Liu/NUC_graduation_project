{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { defineComponent, shallowRef, computed, onBeforeUnmount, provide, toRef, openBlock, createElementBlock, createBlock, unref, createSlots, withCtx, createVNode, mergeProps, renderSlot, createCommentVNode } from 'vue';\nimport { uploadContextKey } from './constants.mjs';\nimport UploadList from './upload-list2.mjs';\nimport UploadContent from './upload-content2.mjs';\nimport { useHandlers } from './use-handlers.mjs';\nimport { uploadProps } from './upload.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useFormDisabled } from '../../form/src/hooks/use-form-common-props.mjs';\nconst _sfc_main = defineComponent({\n  ...{\n    name: \"ElUpload\"\n  },\n  __name: \"upload\",\n  props: uploadProps,\n  setup(__props, {\n    expose: __expose\n  }) {\n    const props = __props;\n    const disabled = useFormDisabled();\n    const uploadRef = shallowRef();\n    const {\n      abort,\n      submit,\n      clearFiles,\n      uploadFiles,\n      handleStart,\n      handleError,\n      handleRemove,\n      handleSuccess,\n      handleProgress,\n      revokeFileObjectURL\n    } = useHandlers(props, uploadRef);\n    const isPictureCard = computed(() => props.listType === \"picture-card\");\n    const uploadContentProps = computed(() => ({\n      ...props,\n      fileList: uploadFiles.value,\n      onStart: handleStart,\n      onProgress: handleProgress,\n      onSuccess: handleSuccess,\n      onError: handleError,\n      onRemove: handleRemove\n    }));\n    onBeforeUnmount(() => {\n      uploadFiles.value.forEach(revokeFileObjectURL);\n    });\n    provide(uploadContextKey, {\n      accept: toRef(props, \"accept\")\n    });\n    __expose({\n      abort,\n      submit,\n      clearFiles,\n      handleStart,\n      handleRemove\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", null, [isPictureCard.value && _ctx.showFileList ? (openBlock(), createBlock(UploadList, {\n        key: 0,\n        disabled: unref(disabled),\n        \"list-type\": _ctx.listType,\n        files: unref(uploadFiles),\n        crossorigin: _ctx.crossorigin,\n        \"handle-preview\": _ctx.onPreview,\n        onRemove: unref(handleRemove)\n      }, createSlots({\n        append: withCtx(() => [createVNode(UploadContent, mergeProps({\n          ref_key: \"uploadRef\",\n          ref: uploadRef\n        }, uploadContentProps.value), {\n          default: withCtx(() => [_ctx.$slots.trigger ? renderSlot(_ctx.$slots, \"trigger\", {\n            key: 0\n          }) : createCommentVNode(\"v-if\", true), !_ctx.$slots.trigger && _ctx.$slots.default ? renderSlot(_ctx.$slots, \"default\", {\n            key: 1\n          }) : createCommentVNode(\"v-if\", true)]),\n          _: 3\n        }, 16)]),\n        _: 2\n      }, [_ctx.$slots.file ? {\n        name: \"default\",\n        fn: withCtx(({\n          file,\n          index\n        }) => [renderSlot(_ctx.$slots, \"file\", {\n          file,\n          index\n        })]),\n        key: \"0\"\n      } : void 0]), 1032, [\"disabled\", \"list-type\", \"files\", \"crossorigin\", \"handle-preview\", \"onRemove\"])) : createCommentVNode(\"v-if\", true), !isPictureCard.value || isPictureCard.value && !_ctx.showFileList ? (openBlock(), createBlock(UploadContent, mergeProps({\n        key: 1,\n        ref_key: \"uploadRef\",\n        ref: uploadRef\n      }, uploadContentProps.value), {\n        default: withCtx(() => [_ctx.$slots.trigger ? renderSlot(_ctx.$slots, \"trigger\", {\n          key: 0\n        }) : createCommentVNode(\"v-if\", true), !_ctx.$slots.trigger && _ctx.$slots.default ? renderSlot(_ctx.$slots, \"default\", {\n          key: 1\n        }) : createCommentVNode(\"v-if\", true)]),\n        _: 3\n      }, 16)) : createCommentVNode(\"v-if\", true), _ctx.$slots.trigger ? renderSlot(_ctx.$slots, \"default\", {\n        key: 2\n      }) : createCommentVNode(\"v-if\", true), renderSlot(_ctx.$slots, \"tip\"), !isPictureCard.value && _ctx.showFileList ? (openBlock(), createBlock(UploadList, {\n        key: 3,\n        disabled: unref(disabled),\n        \"list-type\": _ctx.listType,\n        files: unref(uploadFiles),\n        crossorigin: _ctx.crossorigin,\n        \"handle-preview\": _ctx.onPreview,\n        onRemove: unref(handleRemove)\n      }, createSlots({\n        _: 2\n      }, [_ctx.$slots.file ? {\n        name: \"default\",\n        fn: withCtx(({\n          file,\n          index\n        }) => [renderSlot(_ctx.$slots, \"file\", {\n          file,\n          index\n        })]),\n        key: \"0\"\n      } : void 0]), 1032, [\"disabled\", \"list-type\", \"files\", \"crossorigin\", \"handle-preview\", \"onRemove\"])) : createCommentVNode(\"v-if\", true)]);\n    };\n  }\n});\nvar Upload = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue\"]]);\nexport { Upload as default };","map":{"version":3,"names":["props","__props","disabled","useFormDisabled","uploadRef","shallowRef","abort","submit","clearFiles","uploadFiles","handleStart","handleError","handleRemove","handleSuccess","handleProgress","revokeFileObjectURL","useHandlers","isPictureCard","computed","listType","uploadContentProps","fileList","value","onStart","onProgress","onSuccess","onError","onRemove","onBeforeUnmount","forEach","provide","uploadContextKey","accept","toRef","__expose","createElementBlock","_ctx","showFileList","openBlock","createBlock","UploadList","key","unref","files","crossorigin","onPreview","createSlots","append","withCtx","createVNode","UploadContent","mergeProps","ref_key","ref","default","$slots","trigger","renderSlot","createCommentVNode","file","name","fn","index","_"],"sources":["../../../../../../packages/components/upload/src/upload.vue"],"sourcesContent":["<template>\n  <div>\n    <upload-list\n      v-if=\"isPictureCard && showFileList\"\n      :disabled=\"disabled\"\n      :list-type=\"listType\"\n      :files=\"uploadFiles\"\n      :crossorigin=\"crossorigin\"\n      :handle-preview=\"onPreview\"\n      @remove=\"handleRemove\"\n    >\n      <template v-if=\"$slots.file\" #default=\"{ file, index }\">\n        <slot name=\"file\" :file=\"file\" :index=\"index\" />\n      </template>\n      <template #append>\n        <upload-content ref=\"uploadRef\" v-bind=\"uploadContentProps\">\n          <slot v-if=\"$slots.trigger\" name=\"trigger\" />\n          <slot v-if=\"!$slots.trigger && $slots.default\" />\n        </upload-content>\n      </template>\n    </upload-list>\n\n    <upload-content\n      v-if=\"!isPictureCard || (isPictureCard && !showFileList)\"\n      ref=\"uploadRef\"\n      v-bind=\"uploadContentProps\"\n    >\n      <slot v-if=\"$slots.trigger\" name=\"trigger\" />\n      <slot v-if=\"!$slots.trigger && $slots.default\" />\n    </upload-content>\n\n    <slot v-if=\"$slots.trigger\" />\n    <slot name=\"tip\" />\n    <upload-list\n      v-if=\"!isPictureCard && showFileList\"\n      :disabled=\"disabled\"\n      :list-type=\"listType\"\n      :files=\"uploadFiles\"\n      :crossorigin=\"crossorigin\"\n      :handle-preview=\"onPreview\"\n      @remove=\"handleRemove\"\n    >\n      <template v-if=\"$slots.file\" #default=\"{ file, index }\">\n        <slot name=\"file\" :file=\"file\" :index=\"index\" />\n      </template>\n    </upload-list>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, onBeforeUnmount, provide, shallowRef, toRef } from 'vue'\nimport { useFormDisabled } from '@element-plus/components/form'\nimport { uploadContextKey } from './constants'\nimport UploadList from './upload-list.vue'\nimport UploadContent from './upload-content.vue'\nimport { useHandlers } from './use-handlers'\nimport { uploadProps } from './upload'\n\nimport type {\n  UploadContentInstance,\n  UploadContentProps,\n} from './upload-content'\n\ndefineOptions({\n  name: 'ElUpload',\n})\n\nconst props = defineProps(uploadProps)\n\nconst disabled = useFormDisabled()\n\nconst uploadRef = shallowRef<UploadContentInstance>()\nconst {\n  abort,\n  submit,\n  clearFiles,\n  uploadFiles,\n  handleStart,\n  handleError,\n  handleRemove,\n  handleSuccess,\n  handleProgress,\n  revokeFileObjectURL,\n} = useHandlers(props, uploadRef)\n\nconst isPictureCard = computed(() => props.listType === 'picture-card')\n\nconst uploadContentProps = computed<UploadContentProps>(() => ({\n  ...props,\n  fileList: uploadFiles.value,\n  onStart: handleStart,\n  onProgress: handleProgress,\n  onSuccess: handleSuccess,\n  onError: handleError,\n  onRemove: handleRemove,\n}))\n\nonBeforeUnmount(() => {\n  uploadFiles.value.forEach(revokeFileObjectURL)\n})\n\nprovide(uploadContextKey, {\n  accept: toRef(props, 'accept'),\n})\n\ndefineExpose({\n  /** @description cancel upload request */\n  abort,\n  /** @description upload the file list manually */\n  submit,\n  /** @description clear the file list  */\n  clearFiles,\n  /** @description select the file manually */\n  handleStart,\n  /** @description remove the file manually */\n  handleRemove,\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}