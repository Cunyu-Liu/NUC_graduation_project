{"ast":null,"code":"import { isFunction } from '@vue/shared';\nconst REPEAT_INTERVAL = 100;\nconst REPEAT_DELAY = 600;\nconst SCOPE = \"_RepeatClick\";\nconst vRepeatClick = {\n  beforeMount(el, binding) {\n    const value = binding.value;\n    const {\n      interval = REPEAT_INTERVAL,\n      delay = REPEAT_DELAY\n    } = isFunction(value) ? {} : value;\n    let intervalId;\n    let delayId;\n    const handler = () => isFunction(value) ? value() : value.handler();\n    const clear = () => {\n      if (delayId) {\n        clearTimeout(delayId);\n        delayId = void 0;\n      }\n      if (intervalId) {\n        clearInterval(intervalId);\n        intervalId = void 0;\n      }\n    };\n    const start = evt => {\n      if (evt.button !== 0) return;\n      clear();\n      handler();\n      document.addEventListener(\"mouseup\", clear, {\n        once: true\n      });\n      delayId = setTimeout(() => {\n        intervalId = setInterval(() => {\n          handler();\n        }, interval);\n      }, delay);\n    };\n    el[SCOPE] = {\n      start,\n      clear\n    };\n    el.addEventListener(\"mousedown\", start);\n  },\n  unmounted(el) {\n    if (!el[SCOPE]) return;\n    const {\n      start,\n      clear\n    } = el[SCOPE];\n    if (start) {\n      el.removeEventListener(\"mousedown\", start);\n    }\n    if (clear) {\n      clear();\n      document.removeEventListener(\"mouseup\", clear);\n    }\n    el[SCOPE] = null;\n  }\n};\nexport { REPEAT_DELAY, REPEAT_INTERVAL, vRepeatClick };","map":{"version":3,"names":["REPEAT_INTERVAL","REPEAT_DELAY","SCOPE","vRepeatClick","beforeMount","el","binding","value","interval","delay","isFunction","intervalId","delayId","handler","clear","clearTimeout","clearInterval","start","evt","button","document","addEventListener","once","setTimeout","setInterval","unmounted","removeEventListener"],"sources":["../../../../../packages/directives/repeat-click/index.ts"],"sourcesContent":["import { isFunction } from '@element-plus/utils'\n\nimport type { ObjectDirective } from 'vue'\n\nexport const REPEAT_INTERVAL = 100\nexport const REPEAT_DELAY = 600\nconst SCOPE = '_RepeatClick'\n\ninterface RepeatClickEl extends HTMLElement {\n  [SCOPE]: null | {\n    start?: (evt: MouseEvent) => void\n    clear?: () => void\n  }\n}\n\nexport interface RepeatClickOptions {\n  interval?: number\n  delay?: number\n  handler: (...args: unknown[]) => unknown\n}\n\nexport const vRepeatClick: ObjectDirective<\n  RepeatClickEl,\n  RepeatClickOptions | RepeatClickOptions['handler']\n> = {\n  beforeMount(el, binding) {\n    const value = binding.value\n    const { interval = REPEAT_INTERVAL, delay = REPEAT_DELAY } = isFunction(\n      value\n    )\n      ? {}\n      : value\n\n    let intervalId: ReturnType<typeof setInterval> | undefined\n    let delayId: ReturnType<typeof setTimeout> | undefined\n\n    const handler = () => (isFunction(value) ? value() : value.handler())\n\n    const clear = () => {\n      if (delayId) {\n        clearTimeout(delayId)\n        delayId = undefined\n      }\n      if (intervalId) {\n        clearInterval(intervalId)\n        intervalId = undefined\n      }\n    }\n\n    const start = (evt: MouseEvent) => {\n      if (evt.button !== 0) return\n      clear()\n      handler()\n\n      document.addEventListener('mouseup', clear, { once: true })\n\n      delayId = setTimeout(() => {\n        intervalId = setInterval(() => {\n          handler()\n        }, interval)\n      }, delay)\n    }\n\n    el[SCOPE] = { start, clear }\n    el.addEventListener('mousedown', start)\n  },\n  unmounted(el) {\n    if (!el[SCOPE]) return\n    const { start, clear } = el[SCOPE]\n\n    if (start) {\n      el.removeEventListener('mousedown', start)\n    }\n    if (clear) {\n      clear()\n      document.removeEventListener('mouseup', clear)\n    }\n    el[SCOPE] = null\n  },\n}\n"],"mappings":";AAIO,MAAMA,eAAkB;AACxB,MAAMC,YAAe;AAC5B,MAAMC,KAAQ;AAeP,MAAMC,YAGT;EACFC,YAAYC,EAAA,EAAIC,OAAS;IACvB,MAAMC,KAAA,GAAQD,OAAQ,CAAAC,KAAA;IACtB,MAAM;MAAEC,QAAA,GAAWR,eAAiB;MAAAS,KAAA,GAAQR;IAAA,CAAiB,GAAAS,UAAA,CAC3DH,KAAA,CACF,GACI,EACA,GAAAA,KAAA;IAEA,IAAAI,UAAA;IACA,IAAAC,OAAA;IAEE,MAAAC,OAAA,GAAUA,CAAA,KAAOH,UAAW,CAAAH,KAAK,IAAIA,KAAM,KAAIA,KAAA,CAAMM,OAAQ;IAEnE,MAAMC,KAAA,GAAQA,CAAA,KAAM;MAClB,IAAIF,OAAS;QACXG,YAAA,CAAaH,OAAO;QACVA,OAAA;MAAA;MAEZ,IAAID,UAAY;QACdK,aAAA,CAAcL,UAAU;QACXA,UAAA;MAAA;IACf,CACF;IAEM,MAAAM,KAAA,GAASC,GAAoB;MACjC,IAAIA,GAAA,CAAIC,MAAW,QAAG;MAChBL,KAAA;MACED,OAAA;MAERO,QAAA,CAASC,gBAAA,CAAiB,SAAW,EAAAP,KAAA,EAAO;QAAEQ,IAAA,EAAM;MAAA,CAAM;MAE1DV,OAAA,GAAUW,UAAA,CAAW,MAAM;QACzBZ,UAAA,GAAaa,WAAA,CAAY,MAAM;UACrBX,OAAA;QAAA,GACPL,QAAQ;MAAA,GACVC,KAAK;IAAA,CACV;IAEGJ,EAAA,CAAAH,KAAA,IAAS;MAAEe,KAAA;MAAOH;IAAM;IACxBT,EAAA,CAAAgB,gBAAA,CAAiB,aAAaJ,KAAK;EAAA,CACxC;EACAQ,UAAUpB,EAAI;IACZ,IAAI,CAACA,EAAG,CAAAH,KAAA,GAAQ;IAChB,MAAM;MAAEe,KAAA;MAAOH;IAAM,IAAIT,EAAG,CAAAH,KAAA;IAE5B,IAAIe,KAAO;MACNZ,EAAA,CAAAqB,mBAAA,CAAoB,aAAaT,KAAK;IAAA;IAE3C,IAAIH,KAAO;MACHA,KAAA;MACGM,QAAA,CAAAM,mBAAA,CAAoB,WAAWZ,KAAK;IAAA;IAE/CT,EAAA,CAAGH,KAAS;EAAA;AAEhB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}