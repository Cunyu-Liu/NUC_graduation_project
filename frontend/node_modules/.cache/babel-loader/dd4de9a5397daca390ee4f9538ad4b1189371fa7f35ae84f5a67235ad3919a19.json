{"ast":null,"code":"import { ref, onBeforeUnmount } from 'vue';\nconst usePopperContentFocusTrap = (props, emit) => {\n  const trapped = ref(false);\n  const focusStartRef = ref();\n  const onFocusAfterTrapped = () => {\n    emit(\"focus\");\n  };\n  const onFocusAfterReleased = event => {\n    var _a;\n    if (((_a = event.detail) == null ? void 0 : _a.focusReason) !== \"pointer\") {\n      focusStartRef.value = \"first\";\n      emit(\"blur\");\n    }\n  };\n  const onFocusInTrap = event => {\n    if (props.visible && !trapped.value) {\n      if (event.target) {\n        focusStartRef.value = event.target;\n      }\n      trapped.value = true;\n    }\n  };\n  const onFocusoutPrevented = event => {\n    if (!props.trapping) {\n      if (event.detail.focusReason === \"pointer\") {\n        event.preventDefault();\n      }\n      trapped.value = false;\n    }\n  };\n  const onReleaseRequested = () => {\n    trapped.value = false;\n    emit(\"close\");\n  };\n  onBeforeUnmount(() => {\n    focusStartRef.value = void 0;\n  });\n  return {\n    focusStartRef,\n    trapped,\n    onFocusAfterReleased,\n    onFocusAfterTrapped,\n    onFocusInTrap,\n    onFocusoutPrevented,\n    onReleaseRequested\n  };\n};\nexport { usePopperContentFocusTrap };","map":{"version":3,"names":["usePopperContentFocusTrap","props","emit","trapped","ref","focusStartRef","onFocusAfterTrapped","onFocusAfterReleased","event","_a","detail","focusReason","value","onFocusInTrap","visible","target","onFocusoutPrevented","trapping","preventDefault","onReleaseRequested","onBeforeUnmount"],"sources":["../../../../../../../packages/components/popper/src/composables/use-focus-trap.ts"],"sourcesContent":["import { onBeforeUnmount, ref } from 'vue'\n\nimport type { SetupContext } from 'vue'\nimport type { PopperContentEmits, PopperContentProps } from '../content'\n\nexport const usePopperContentFocusTrap = (\n  props: PopperContentProps,\n  emit: SetupContext<PopperContentEmits>['emit']\n) => {\n  const trapped = ref(false)\n  const focusStartRef = ref<'container' | 'first' | HTMLElement>()\n\n  const onFocusAfterTrapped = () => {\n    emit('focus')\n  }\n\n  const onFocusAfterReleased = (event: CustomEvent) => {\n    if (event.detail?.focusReason !== 'pointer') {\n      focusStartRef.value = 'first'\n      emit('blur')\n    }\n  }\n\n  const onFocusInTrap = (event: FocusEvent) => {\n    if (props.visible && !trapped.value) {\n      if (event.target) {\n        focusStartRef.value = event.target as typeof focusStartRef.value\n      }\n      trapped.value = true\n    }\n  }\n\n  const onFocusoutPrevented = (event: CustomEvent) => {\n    if (!props.trapping) {\n      if (event.detail.focusReason === 'pointer') {\n        event.preventDefault()\n      }\n      trapped.value = false\n    }\n  }\n\n  const onReleaseRequested = () => {\n    trapped.value = false\n    emit('close')\n  }\n\n  onBeforeUnmount(() => {\n    focusStartRef.value = undefined\n  })\n\n  return {\n    focusStartRef,\n    trapped,\n\n    onFocusAfterReleased,\n    onFocusAfterTrapped,\n    onFocusInTrap,\n    onFocusoutPrevented,\n    onReleaseRequested,\n  }\n}\n\nexport type UsePopperContentFocusTrapReturn = ReturnType<\n  typeof usePopperContentFocusTrap\n>\n"],"mappings":";AAKa,MAAAA,yBAAA,GAA4BA,CACvCC,KAAA,EACAC,IACG;EACG,MAAAC,OAAA,GAAUC,GAAA,CAAI,KAAK;EACzB,MAAMC,aAAA,GAAgBD,GAAyC;EAE/D,MAAME,mBAAA,GAAsBA,CAAA,KAAM;IAChCJ,IAAA,CAAK,OAAO;EAAA,CACd;EAEM,MAAAK,oBAAA,GAAwBC,KAAuB;IAhBvD,IAAAC,EAAA;IAiBI,MAAIA,EAAM,GAAAD,KAAA,CAAAE,MAAA,KAAN,IAAc,YAAAD,EAAA,CAAAE,WAAA,MAAgB,SAAW;MAC3CN,aAAA,CAAcO,KAAQ;MACtBV,IAAA,CAAK,MAAM;IAAA;EACb,CACF;EAEM,MAAAW,aAAA,GAAiBL,KAAsB;IAC3C,IAAIP,KAAM,CAAAa,OAAA,IAAW,CAACX,OAAA,CAAQS,KAAO;MACnC,IAAIJ,KAAA,CAAMO,MAAQ;QAChBV,aAAA,CAAcO,KAAA,GAAQJ,KAAM,CAAAO,MAAA;MAAA;MAE9BZ,OAAA,CAAQS,KAAQ;IAAA;EAClB,CACF;EAEM,MAAAI,mBAAA,GAAuBR,KAAuB;IAC9C,KAACP,KAAA,CAAMgB,QAAU;MACf,IAAAT,KAAA,CAAME,MAAO,CAAAC,WAAA,KAAgB,SAAW;QAC1CH,KAAA,CAAMU,cAAe;MAAA;MAEvBf,OAAA,CAAQS,KAAQ;IAAA;EAClB,CACF;EAEA,MAAMO,kBAAA,GAAqBA,CAAA,KAAM;IAC/BhB,OAAA,CAAQS,KAAQ;IAChBV,IAAA,CAAK,OAAO;EAAA,CACd;EAEAkB,eAAA,CAAgB,MAAM;IACpBf,aAAA,CAAcO,KAAQ;EAAA,CACvB;EAEM;IACLP,aAAA;IACAF,OAAA;IAEAI,oBAAA;IACAD,mBAAA;IACAO,aAAA;IACAG,mBAAA;IACAG;EAAA,CACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}