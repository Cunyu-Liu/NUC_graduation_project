{"ast":null,"code":"import { isRef, ref } from 'vue';\nimport Loading from './service.mjs';\nimport { isObject, hyphenate, isString } from '@vue/shared';\nconst INSTANCE_KEY = Symbol(\"ElLoading\");\nconst getAttributeName = name => {\n  return `element-loading-${hyphenate(name)}`;\n};\nconst createInstance = (el, binding) => {\n  var _a, _b, _c, _d;\n  const vm = binding.instance;\n  const getBindingProp = key => isObject(binding.value) ? binding.value[key] : void 0;\n  const resolveExpression = key => {\n    const data = isString(key) && (vm == null ? void 0 : vm[key]) || key;\n    return ref(data);\n  };\n  const getProp = name => resolveExpression(getBindingProp(name) || el.getAttribute(getAttributeName(name)));\n  const fullscreen = (_a = getBindingProp(\"fullscreen\")) != null ? _a : binding.modifiers.fullscreen;\n  const options = {\n    text: getProp(\"text\"),\n    svg: getProp(\"svg\"),\n    svgViewBox: getProp(\"svgViewBox\"),\n    spinner: getProp(\"spinner\"),\n    background: getProp(\"background\"),\n    customClass: getProp(\"customClass\"),\n    fullscreen,\n    target: (_b = getBindingProp(\"target\")) != null ? _b : fullscreen ? void 0 : el,\n    body: (_c = getBindingProp(\"body\")) != null ? _c : binding.modifiers.body,\n    lock: (_d = getBindingProp(\"lock\")) != null ? _d : binding.modifiers.lock\n  };\n  const instance = Loading(options);\n  instance._context = vLoading._context;\n  el[INSTANCE_KEY] = {\n    options,\n    instance\n  };\n};\nconst updateOptions = (originalOptions, newOptions) => {\n  for (const key of Object.keys(originalOptions)) {\n    if (isRef(originalOptions[key])) originalOptions[key].value = newOptions[key];\n  }\n};\nconst vLoading = {\n  mounted(el, binding) {\n    if (binding.value) {\n      createInstance(el, binding);\n    }\n  },\n  updated(el, binding) {\n    const instance = el[INSTANCE_KEY];\n    if (!binding.value) {\n      instance == null ? void 0 : instance.instance.close();\n      el[INSTANCE_KEY] = null;\n      return;\n    }\n    if (!instance) createInstance(el, binding);else {\n      updateOptions(instance.options, isObject(binding.value) ? binding.value : {\n        text: el.getAttribute(getAttributeName(\"text\")),\n        svg: el.getAttribute(getAttributeName(\"svg\")),\n        svgViewBox: el.getAttribute(getAttributeName(\"svgViewBox\")),\n        spinner: el.getAttribute(getAttributeName(\"spinner\")),\n        background: el.getAttribute(getAttributeName(\"background\")),\n        customClass: el.getAttribute(getAttributeName(\"customClass\"))\n      });\n    }\n  },\n  unmounted(el) {\n    var _a;\n    (_a = el[INSTANCE_KEY]) == null ? void 0 : _a.instance.close();\n    el[INSTANCE_KEY] = null;\n  }\n};\nvLoading._context = null;\nexport { vLoading as default };","map":{"version":3,"names":["INSTANCE_KEY","Symbol","getAttributeName","name","hyphenate","createInstance","el","binding","_a","_b","_c","_d","vm","instance","getBindingProp","key","isObject","value","resolveExpression","data","isString","ref","getProp","getAttribute","fullscreen","modifiers","options","text","svg","svgViewBox","spinner","background","customClass","target","body","lock","Loading","_context","vLoading","updateOptions","originalOptions","newOptions","Object","keys","isRef","mounted","updated","close","unmounted"],"sources":["../../../../../../packages/components/loading/src/directive.ts"],"sourcesContent":["// @ts-nocheck\nimport { isRef, ref } from 'vue'\nimport { hyphenate, isObject, isString } from '@element-plus/utils'\nimport Loading from './service'\n\nimport type { Directive, DirectiveBinding, UnwrapRef } from 'vue'\nimport type { LoadingOptions } from './types'\nimport type { LoadingInstance } from './loading'\n\nconst INSTANCE_KEY = Symbol('ElLoading')\nconst getAttributeName = (name: string) => {\n  return `element-loading-${hyphenate(name)}`\n}\n\nexport type LoadingBinding = boolean | UnwrapRef<LoadingOptions>\nexport interface ElementLoading extends HTMLElement {\n  [INSTANCE_KEY]?: {\n    instance: LoadingInstance\n    options: LoadingOptions\n  }\n}\n\nconst createInstance = (\n  el: ElementLoading,\n  binding: DirectiveBinding<LoadingBinding>\n) => {\n  const vm = binding.instance\n\n  const getBindingProp = <K extends keyof LoadingOptions>(\n    key: K\n  ): LoadingOptions[K] =>\n    isObject(binding.value) ? binding.value[key] : undefined\n\n  const resolveExpression = (key: any) => {\n    const data = (isString(key) && vm?.[key]) || key\n    return ref(data)\n  }\n\n  const getProp = <K extends keyof LoadingOptions>(name: K) =>\n    resolveExpression(\n      getBindingProp(name) || el.getAttribute(getAttributeName(name))\n    )\n\n  const fullscreen =\n    getBindingProp('fullscreen') ?? binding.modifiers.fullscreen\n\n  const options: LoadingOptions = {\n    text: getProp('text'),\n    svg: getProp('svg'),\n    svgViewBox: getProp('svgViewBox'),\n    spinner: getProp('spinner'),\n    background: getProp('background'),\n    customClass: getProp('customClass'),\n    fullscreen,\n    target: getBindingProp('target') ?? (fullscreen ? undefined : el),\n    body: getBindingProp('body') ?? binding.modifiers.body,\n    lock: getBindingProp('lock') ?? binding.modifiers.lock,\n  }\n  const instance = Loading(options)\n  instance._context = vLoading._context\n  el[INSTANCE_KEY] = {\n    options,\n    instance,\n  }\n}\n\nconst updateOptions = (\n  originalOptions: LoadingOptions,\n  newOptions: UnwrapRef<LoadingOptions>\n) => {\n  for (const key of Object.keys(originalOptions)) {\n    if (isRef(originalOptions[key]))\n      originalOptions[key].value = newOptions[key]\n  }\n}\n\nconst vLoading: Directive<ElementLoading, LoadingBinding> = {\n  mounted(el, binding) {\n    if (binding.value) {\n      createInstance(el, binding)\n    }\n  },\n  updated(el, binding) {\n    const instance = el[INSTANCE_KEY]\n    if (!binding.value) {\n      instance?.instance.close()\n      el[INSTANCE_KEY] = null\n      return\n    }\n\n    if (!instance) createInstance(el, binding)\n    else {\n      updateOptions(\n        instance.options,\n        isObject(binding.value)\n          ? binding.value\n          : {\n              text: el.getAttribute(getAttributeName('text')),\n              svg: el.getAttribute(getAttributeName('svg')),\n              svgViewBox: el.getAttribute(getAttributeName('svgViewBox')),\n              spinner: el.getAttribute(getAttributeName('spinner')),\n              background: el.getAttribute(getAttributeName('background')),\n              customClass: el.getAttribute(getAttributeName('customClass')),\n            }\n      )\n    }\n  },\n  unmounted(el) {\n    el[INSTANCE_KEY]?.instance.close()\n    el[INSTANCE_KEY] = null\n  },\n}\n\nvLoading._context = null\nexport default vLoading\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}