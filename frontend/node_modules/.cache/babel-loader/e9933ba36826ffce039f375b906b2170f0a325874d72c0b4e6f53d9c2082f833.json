{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport { useStore } from 'vuex';\nimport api, { connectSocket } from '@/api';\nimport { ElMessage } from 'element-plus';\nexport default {\n  name: 'Cluster',\n  setup() {\n    const store = useStore();\n    const files = computed(() => store.state.files);\n    const selectedFiles = ref([]);\n    const options = ref({\n      nClusters: 5,\n      method: 'kmeans',\n      language: 'chinese'\n    });\n    const clustering = ref(false);\n    const result = ref(null);\n    const activeClusters = ref(['0', '1', '2']);\n    const formatSize = (row, column, size) => {\n      return (size / 1024 / 1024).toFixed(2) + ' MB';\n    };\n    const handleSelectionChange = selection => {\n      selectedFiles.value = selection;\n    };\n\n    // 当前聚类结果ID\n    const currentResultId = ref(null);\n    const startCluster = async () => {\n      if (selectedFiles.value.length < 2) {\n        ElMessage.warning('请至少选择2篇论文');\n        return;\n      }\n\n      // 验证聚类数量\n      const maxClusters = Math.min(20, selectedFiles.value.length);\n      if (options.value.method !== 'dbscan' && (options.value.nClusters < 2 || options.value.nClusters > maxClusters)) {\n        ElMessage.warning(`聚类数量必须在 2 到 ${maxClusters} 之间`);\n        return;\n      }\n\n      // 连接WebSocket\n      connectSocket();\n      store.commit('SHOW_PROGRESS_DIALOG', true);\n      store.commit('SET_PROGRESS', {\n        progress: 0,\n        message: '开始聚类分析...',\n        step: ''\n      });\n      clustering.value = true;\n      try {\n        // 使用论文ID而不是文件路径\n        const paperIds = selectedFiles.value.map(f => f.id);\n        console.log('[DEBUG] 开始聚类, paper_ids:', paperIds);\n        console.log('[DEBUG] 聚类选项:', options.value);\n        const response = await api.clusterPapers(paperIds, options.value.nClusters, options.value.method, options.value.language);\n        console.log('[DEBUG] 聚类响应:', response);\n        if (response.success) {\n          // 格式化结果\n          result.value = {\n            clusterCount: response.data.n_clusters,\n            clusterAnalysis: response.data.cluster_analysis,\n            papers: response.data.papers || [],\n            method: options.value.method,\n            createdAt: new Date().toISOString()\n          };\n\n          // 生成结果ID并保存\n          currentResultId.value = Date.now().toString();\n          await saveClusterResult(currentResultId.value, result.value);\n          store.commit('SET_PROGRESS', {\n            progress: 100,\n            message: '聚类完成!'\n          });\n          ElMessage.success(`聚类分析完成! 共发现 ${response.data.n_clusters} 个主题类别`);\n\n          // 自动展开前3个聚类\n          const clusterIds = Object.keys(response.data.cluster_analysis);\n          activeClusters.value = clusterIds.slice(0, 3);\n        } else {\n          ElMessage.error({\n            message: response.error || '聚类失败',\n            duration: 5000,\n            showClose: true\n          });\n        }\n      } catch (error) {\n        console.error('[ERROR] 聚类错误:', error);\n\n        // 提供更详细的错误提示\n        let errorMsg = '聚类失败';\n        const errorDetail = error.response?.data?.error || error.message;\n        if (errorDetail) {\n          if (errorDetail.includes('论文') || errorDetail.includes('PDF')) {\n            errorMsg = '论文加载或解析失败，请检查文件是否完整';\n          } else if (errorDetail.includes('聚类') || errorDetail.includes('算法')) {\n            errorMsg = '聚类算法执行失败，请尝试调整参数';\n          } else if (errorDetail.includes('数量') || errorDetail.includes('不足')) {\n            errorMsg = '可用论文数量不足，无法进行聚类';\n          } else if (errorDetail.includes('timeout') || errorDetail.includes('超时')) {\n            errorMsg = '聚类超时，请减少论文数量或降低聚类数量';\n          } else {\n            errorMsg = `聚类失败: ${errorDetail}`;\n          }\n        } else if (error.message) {\n          errorMsg = `聚类失败: ${error.message}`;\n        }\n        ElMessage.error({\n          message: errorMsg,\n          duration: 5000,\n          showClose: true\n        });\n      } finally {\n        clustering.value = false;\n        store.commit('SHOW_PROGRESS_DIALOG', false);\n      }\n    };\n    const saveClusterResult = async (resultId, data) => {\n      try {\n        await api.saveClusterResult(resultId, data);\n        console.log('[DEBUG] 聚类结果已保存:', resultId);\n      } catch (error) {\n        console.error('[ERROR] 保存聚类结果失败:', error);\n      }\n    };\n    const downloadVisualization = () => {\n      // 生成并下载聚类可视化图（使用Canvas绘制）\n      generateClusterVisualization();\n    };\n    const downloadReport = async () => {\n      if (!result.value) {\n        ElMessage.warning('没有可导出的聚类结果');\n        return;\n      }\n      try {\n        await api.exportClusterReport(result.value);\n        ElMessage.success('报告导出成功');\n      } catch (error) {\n        console.error('[ERROR] 导出报告失败:', error);\n        ElMessage.error('导出报告失败');\n      }\n    };\n    const generateClusterVisualization = () => {\n      // 创建一个简单的可视化图表\n      const canvas = document.createElement('canvas');\n      canvas.width = 1200;\n      canvas.height = 800;\n      const ctx = canvas.getContext('2d');\n\n      // 背景\n      ctx.fillStyle = '#f8f9fa';\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n      // 标题\n      ctx.fillStyle = '#333';\n      ctx.font = 'bold 24px Arial';\n      ctx.textAlign = 'center';\n      ctx.fillText('论文主题聚类可视化', canvas.width / 2, 40);\n      if (!result.value || !result.value.clusterAnalysis) {\n        ElMessage.warning('没有可下载的可视化图');\n        return;\n      }\n\n      // 绘制聚类信息\n      const clusters = Object.entries(result.value.clusterAnalysis);\n      const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8', '#F7DC6F', '#BB8FCE', '#85C1E2'];\n      let y = 80;\n      clusters.forEach(([clusterId, info], index) => {\n        const color = colors[index % colors.length];\n\n        // 聚类标题\n        ctx.fillStyle = color;\n        ctx.font = 'bold 18px Arial';\n        ctx.textAlign = 'left';\n        ctx.fillText(`聚类 ${clusterId} (${info.paper_count} 篇论文)`, 50, y);\n        y += 30;\n\n        // 关键词\n        ctx.fillStyle = '#666';\n        ctx.font = '14px Arial';\n        ctx.fillText(`关键词: ${info.top_keywords?.slice(0, 8).join(', ') || '无'}`, 70, y);\n        y += 25;\n\n        // 论文列表\n        ctx.fillStyle = '#888';\n        ctx.font = '12px Arial';\n        const papers = info.papers?.slice(0, 5) || [];\n        papers.forEach((paper, i) => {\n          const shortName = paper.length > 60 ? paper.substring(0, 60) + '...' : paper;\n          ctx.fillText(`• ${shortName}`, 90, y + i * 18);\n        });\n        y += papers.length * 18 + 30;\n\n        // 分隔线\n        if (index < clusters.length - 1) {\n          ctx.strokeStyle = '#ddd';\n          ctx.lineWidth = 1;\n          ctx.beginPath();\n          ctx.moveTo(50, y - 10);\n          ctx.lineTo(canvas.width - 50, y - 10);\n          ctx.stroke();\n          y += 20;\n        }\n      });\n\n      // 下载图片\n      canvas.toBlob(blob => {\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `cluster_visualization_${Date.now()}.png`;\n        a.click();\n        URL.revokeObjectURL(url);\n        ElMessage.success('可视化图下载成功');\n      });\n    };\n    onMounted(() => {\n      store.dispatch('fetchFiles');\n    });\n    return {\n      files,\n      selectedFiles,\n      options,\n      clustering,\n      result,\n      activeClusters,\n      currentResultId,\n      formatSize,\n      handleSelectionChange,\n      startCluster,\n      downloadVisualization,\n      downloadReport,\n      saveClusterResult\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","useStore","api","connectSocket","ElMessage","name","setup","store","files","state","selectedFiles","options","nClusters","method","language","clustering","result","activeClusters","formatSize","row","column","size","toFixed","handleSelectionChange","selection","value","currentResultId","startCluster","length","warning","maxClusters","Math","min","commit","progress","message","step","paperIds","map","f","id","console","log","response","clusterPapers","success","clusterCount","data","n_clusters","clusterAnalysis","cluster_analysis","papers","createdAt","Date","toISOString","now","toString","saveClusterResult","clusterIds","Object","keys","slice","error","duration","showClose","errorMsg","errorDetail","includes","resultId","downloadVisualization","generateClusterVisualization","downloadReport","exportClusterReport","canvas","document","createElement","width","height","ctx","getContext","fillStyle","fillRect","font","textAlign","fillText","clusters","entries","colors","y","forEach","clusterId","info","index","color","paper_count","top_keywords","join","paper","i","shortName","substring","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","toBlob","blob","url","URL","createObjectURL","a","href","download","click","revokeObjectURL","dispatch"],"sources":["/Users/liucunyu/Documents/all_code/NUC_graduation_project/frontend/src/views/Cluster.vue"],"sourcesContent":["<template>\n  <div class=\"cluster\">\n    <h2>多篇论文主题聚类分析</h2>\n\n    <el-card class=\"select-card\">\n      <h3>选择要分析的论文（至少2篇）</h3>\n      <el-table\n        :data=\"files\"\n        style=\"width: 100%; margin-top: 20px\"\n        @selection-change=\"handleSelectionChange\"\n      >\n        <el-table-column type=\"selection\" width=\"55\" />\n        <el-table-column prop=\"filename\" label=\"文件名\" />\n        <el-table-column prop=\"size\" label=\"大小\" :formatter=\"formatSize\" />\n      </el-table>\n    </el-card>\n\n    <el-card class=\"options-card\">\n      <h3>聚类选项</h3>\n      <el-form :model=\"options\" label-width=\"120px\">\n        <el-form-item label=\"聚类数量\">\n          <el-input-number v-model=\"options.nClusters\" :min=\"2\" :max=\"10\" />\n        </el-form-item>\n        <el-form-item label=\"聚类方法\">\n          <el-select v-model=\"options.method\">\n            <el-option label=\"K-Means\" value=\"kmeans\" />\n            <el-option label=\"DBSCAN\" value=\"dbscan\" />\n            <el-option label=\"层次聚类\" value=\"hierarchical\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"论文语言\">\n          <el-select v-model=\"options.language\">\n            <el-option label=\"中文\" value=\"chinese\" />\n            <el-option label=\"英文\" value=\"english\" />\n          </el-select>\n        </el-form-item>\n      </el-form>\n\n      <el-button\n        type=\"primary\"\n        size=\"large\"\n        @click=\"startCluster\"\n        :disabled=\"selectedFiles.length < 2\"\n        :loading=\"clustering\"\n      >\n        <i class=\"el-icon-data-analysis\"></i> 开始聚类分析\n      </el-button>\n    </el-card>\n\n    <el-card class=\"result-card\" v-if=\"result\">\n      <h3>聚类结果</h3>\n\n      <el-alert\n        :title=\"`共发现 ${result.clusterCount} 个主题类别`\"\n        type=\"success\"\n        :closable=\"false\"\n        style=\"margin-bottom: 20px\"\n      />\n\n      <el-collapse v-model=\"activeClusters\">\n        <el-collapse-item\n          v-for=\"(cluster, index) in Object.entries(result.clusterAnalysis)\"\n          :key=\"cluster[0]\"\n          :name=\"cluster[0]\"\n        >\n          <template #title>\n            <strong>聚类 {{ cluster[0] }}</strong>\n            <el-tag style=\"margin-left: 10px\">\n              {{ cluster[1]?.paper_count || 0 }} 篇论文\n            </el-tag>\n          </template>\n\n          <div class=\"cluster-content\">\n            <h4>核心关键词</h4>\n            <el-space wrap v-if=\"cluster[1].top_keywords && cluster[1].top_keywords.length > 0\">\n              <el-tag\n                v-for=\"(keyword, kIndex) in cluster[1].top_keywords.slice(0, 10)\"\n                :key=\"kIndex\"\n                type=\"success\"\n              >\n                {{ keyword }}\n              </el-tag>\n            </el-space>\n            <el-empty v-else description=\"暂无关键词\" :image-size=\"60\" />\n\n            <h4 style=\"margin-top: 20px\">包含论文</h4>\n            <ul v-if=\"cluster[1].papers && cluster[1].papers.length > 0\">\n              <li v-for=\"(paper, pIndex) in cluster[1].papers\" :key=\"pIndex\">\n                {{ paper }}\n              </li>\n            </ul>\n            <el-empty v-else description=\"暂无论文\" :image-size=\"60\" />\n\n            <h4 style=\"margin-top: 20px\">代表性论文</h4>\n            <div\n              v-if=\"cluster[1].representative_papers && cluster[1].representative_papers.length > 0\"\n            >\n              <div\n                v-for=\"(rep, rIndex) in cluster[1].representative_papers\"\n                :key=\"rIndex\"\n                class=\"rep-paper\"\n              >\n                <p><strong>{{ rep.title || '无标题' }}</strong></p>\n                <p class=\"rep-abstract\">{{ rep.abstract || '无摘要' }}</p>\n              </div>\n            </div>\n            <el-empty v-else description=\"暂无代表性论文\" :image-size=\"60\" />\n          </div>\n        </el-collapse-item>\n      </el-collapse>\n\n      <div class=\"result-actions\">\n        <el-button @click=\"downloadVisualization\">\n          <i class=\"el-icon-picture\"></i> 下载可视化图\n        </el-button>\n        <el-button @click=\"downloadReport\">\n          <i class=\"el-icon-document\"></i> 下载聚类报告\n        </el-button>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted } from 'vue'\nimport { useStore } from 'vuex'\nimport api, { connectSocket } from '@/api'\nimport { ElMessage } from 'element-plus'\n\nexport default {\n  name: 'Cluster',\n  setup() {\n    const store = useStore()\n\n    const files = computed(() => store.state.files)\n    const selectedFiles = ref([])\n    const options = ref({\n      nClusters: 5,\n      method: 'kmeans',\n      language: 'chinese'\n    })\n    const clustering = ref(false)\n    const result = ref(null)\n    const activeClusters = ref(['0', '1', '2'])\n\n    const formatSize = (row, column, size) => {\n      return (size / 1024 / 1024).toFixed(2) + ' MB'\n    }\n\n    const handleSelectionChange = (selection) => {\n      selectedFiles.value = selection\n    }\n\n    // 当前聚类结果ID\n    const currentResultId = ref(null)\n\n    const startCluster = async () => {\n      if (selectedFiles.value.length < 2) {\n        ElMessage.warning('请至少选择2篇论文')\n        return\n      }\n\n      // 验证聚类数量\n      const maxClusters = Math.min(20, selectedFiles.value.length)\n      if (options.value.method !== 'dbscan' && (options.value.nClusters < 2 || options.value.nClusters > maxClusters)) {\n        ElMessage.warning(`聚类数量必须在 2 到 ${maxClusters} 之间`)\n        return\n      }\n\n      // 连接WebSocket\n      connectSocket()\n      store.commit('SHOW_PROGRESS_DIALOG', true)\n      store.commit('SET_PROGRESS', { progress: 0, message: '开始聚类分析...', step: '' })\n\n      clustering.value = true\n\n      try {\n        // 使用论文ID而不是文件路径\n        const paperIds = selectedFiles.value.map(f => f.id)\n\n        console.log('[DEBUG] 开始聚类, paper_ids:', paperIds)\n        console.log('[DEBUG] 聚类选项:', options.value)\n\n        const response = await api.clusterPapers(\n          paperIds,\n          options.value.nClusters,\n          options.value.method,\n          options.value.language\n        )\n\n        console.log('[DEBUG] 聚类响应:', response)\n\n        if (response.success) {\n          // 格式化结果\n          result.value = {\n            clusterCount: response.data.n_clusters,\n            clusterAnalysis: response.data.cluster_analysis,\n            papers: response.data.papers || [],\n            method: options.value.method,\n            createdAt: new Date().toISOString()\n          }\n\n          // 生成结果ID并保存\n          currentResultId.value = Date.now().toString()\n          await saveClusterResult(currentResultId.value, result.value)\n\n          store.commit('SET_PROGRESS', { progress: 100, message: '聚类完成!' })\n          ElMessage.success(`聚类分析完成! 共发现 ${response.data.n_clusters} 个主题类别`)\n\n          // 自动展开前3个聚类\n          const clusterIds = Object.keys(response.data.cluster_analysis)\n          activeClusters.value = clusterIds.slice(0, 3)\n        } else {\n          ElMessage.error({\n            message: response.error || '聚类失败',\n            duration: 5000,\n            showClose: true\n          })\n        }\n      } catch (error) {\n        console.error('[ERROR] 聚类错误:', error)\n\n        // 提供更详细的错误提示\n        let errorMsg = '聚类失败'\n        const errorDetail = error.response?.data?.error || error.message\n\n        if (errorDetail) {\n          if (errorDetail.includes('论文') || errorDetail.includes('PDF')) {\n            errorMsg = '论文加载或解析失败，请检查文件是否完整'\n          } else if (errorDetail.includes('聚类') || errorDetail.includes('算法')) {\n            errorMsg = '聚类算法执行失败，请尝试调整参数'\n          } else if (errorDetail.includes('数量') || errorDetail.includes('不足')) {\n            errorMsg = '可用论文数量不足，无法进行聚类'\n          } else if (errorDetail.includes('timeout') || errorDetail.includes('超时')) {\n            errorMsg = '聚类超时，请减少论文数量或降低聚类数量'\n          } else {\n            errorMsg = `聚类失败: ${errorDetail}`\n          }\n        } else if (error.message) {\n          errorMsg = `聚类失败: ${error.message}`\n        }\n\n        ElMessage.error({\n          message: errorMsg,\n          duration: 5000,\n          showClose: true\n        })\n      } finally {\n        clustering.value = false\n        store.commit('SHOW_PROGRESS_DIALOG', false)\n      }\n    }\n\n    const saveClusterResult = async (resultId, data) => {\n      try {\n        await api.saveClusterResult(resultId, data)\n        console.log('[DEBUG] 聚类结果已保存:', resultId)\n      } catch (error) {\n        console.error('[ERROR] 保存聚类结果失败:', error)\n      }\n    }\n\n    const downloadVisualization = () => {\n      // 生成并下载聚类可视化图（使用Canvas绘制）\n      generateClusterVisualization()\n    }\n\n    const downloadReport = async () => {\n      if (!result.value) {\n        ElMessage.warning('没有可导出的聚类结果')\n        return\n      }\n\n      try {\n        await api.exportClusterReport(result.value)\n        ElMessage.success('报告导出成功')\n      } catch (error) {\n        console.error('[ERROR] 导出报告失败:', error)\n        ElMessage.error('导出报告失败')\n      }\n    }\n\n    const generateClusterVisualization = () => {\n      // 创建一个简单的可视化图表\n      const canvas = document.createElement('canvas')\n      canvas.width = 1200\n      canvas.height = 800\n      const ctx = canvas.getContext('2d')\n\n      // 背景\n      ctx.fillStyle = '#f8f9fa'\n      ctx.fillRect(0, 0, canvas.width, canvas.height)\n\n      // 标题\n      ctx.fillStyle = '#333'\n      ctx.font = 'bold 24px Arial'\n      ctx.textAlign = 'center'\n      ctx.fillText('论文主题聚类可视化', canvas.width / 2, 40)\n\n      if (!result.value || !result.value.clusterAnalysis) {\n        ElMessage.warning('没有可下载的可视化图')\n        return\n      }\n\n      // 绘制聚类信息\n      const clusters = Object.entries(result.value.clusterAnalysis)\n      const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8', '#F7DC6F', '#BB8FCE', '#85C1E2']\n\n      let y = 80\n      clusters.forEach(([clusterId, info], index) => {\n        const color = colors[index % colors.length]\n\n        // 聚类标题\n        ctx.fillStyle = color\n        ctx.font = 'bold 18px Arial'\n        ctx.textAlign = 'left'\n        ctx.fillText(`聚类 ${clusterId} (${info.paper_count} 篇论文)`, 50, y)\n\n        y += 30\n\n        // 关键词\n        ctx.fillStyle = '#666'\n        ctx.font = '14px Arial'\n        ctx.fillText(`关键词: ${info.top_keywords?.slice(0, 8).join(', ') || '无'}`, 70, y)\n\n        y += 25\n\n        // 论文列表\n        ctx.fillStyle = '#888'\n        ctx.font = '12px Arial'\n        const papers = info.papers?.slice(0, 5) || []\n        papers.forEach((paper, i) => {\n          const shortName = paper.length > 60 ? paper.substring(0, 60) + '...' : paper\n          ctx.fillText(`• ${shortName}`, 90, y + i * 18)\n        })\n\n        y += papers.length * 18 + 30\n\n        // 分隔线\n        if (index < clusters.length - 1) {\n          ctx.strokeStyle = '#ddd'\n          ctx.lineWidth = 1\n          ctx.beginPath()\n          ctx.moveTo(50, y - 10)\n          ctx.lineTo(canvas.width - 50, y - 10)\n          ctx.stroke()\n          y += 20\n        }\n      })\n\n      // 下载图片\n      canvas.toBlob((blob) => {\n        const url = URL.createObjectURL(blob)\n        const a = document.createElement('a')\n        a.href = url\n        a.download = `cluster_visualization_${Date.now()}.png`\n        a.click()\n        URL.revokeObjectURL(url)\n        ElMessage.success('可视化图下载成功')\n      })\n    }\n\n    onMounted(() => {\n      store.dispatch('fetchFiles')\n    })\n\n    return {\n      files,\n      selectedFiles,\n      options,\n      clustering,\n      result,\n      activeClusters,\n      currentResultId,\n      formatSize,\n      handleSelectionChange,\n      startCluster,\n      downloadVisualization,\n      downloadReport,\n      saveClusterResult\n    }\n  }\n}\n</script>\n\n<style scoped>\n.cluster {\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\nh2 {\n  margin-bottom: 20px;\n  color: #303133;\n}\n\n.select-card,\n.options-card,\n.result-card {\n  margin-bottom: 20px;\n}\n\n.cluster-content h4 {\n  color: #409eff;\n  margin: 20px 0 10px 0;\n}\n\n.cluster-content ul {\n  list-style: none;\n  padding: 0;\n}\n\n.cluster-content ul li {\n  padding: 8px 0;\n  padding-left: 20px;\n  position: relative;\n}\n\n.cluster-content ul li:before {\n  content: '•';\n  position: absolute;\n  left: 0;\n  color: #409eff;\n  font-weight: bold;\n}\n\n.rep-paper {\n  padding: 15px;\n  background: #f5f7fa;\n  border-radius: 4px;\n  margin-bottom: 10px;\n}\n\n.rep-paper p {\n  margin: 5px 0;\n}\n\n.rep-abstract {\n  color: #606266;\n  font-size: 14px;\n  line-height: 1.6;\n}\n\n.result-actions {\n  margin-top: 20px;\n  text-align: right;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}