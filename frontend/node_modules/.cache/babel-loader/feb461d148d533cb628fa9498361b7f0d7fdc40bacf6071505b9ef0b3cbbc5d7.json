{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { computed, onMounted } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nexport default {\n  name: 'Files',\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n    const files = computed(() => store.state.files);\n    const formatTime = (row, column, time) => {\n      if (!time) return '-';\n      return new Date(time).toLocaleString('zh-CN');\n    };\n    const analyzeFile = paper => {\n      router.push({\n        path: '/analyze',\n        query: {\n          paperId: paper.id\n        }\n      });\n    };\n    const deleteFile = async paper => {\n      try {\n        await ElMessageBox.confirm(`确定要删除论文 \"${paper.title || '未命名'}\" 吗？`, '确认删除', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        });\n        const success = await store.dispatch('deleteFile', paper.id);\n        if (success) {\n          ElMessage.success('删除成功');\n        } else {\n          ElMessage.error('删除失败');\n        }\n      } catch {\n        // 用户取消\n      }\n    };\n    onMounted(() => {\n      store.dispatch('fetchFiles');\n    });\n    return {\n      files,\n      formatTime,\n      analyzeFile,\n      deleteFile\n    };\n  }\n};","map":{"version":3,"names":["computed","onMounted","useStore","useRouter","ElMessage","ElMessageBox","name","setup","store","router","files","state","formatTime","row","column","time","Date","toLocaleString","analyzeFile","paper","push","path","query","paperId","id","deleteFile","confirm","title","confirmButtonText","cancelButtonText","type","success","dispatch","error"],"sources":["/Users/liucunyu/Documents/all_code/NUC_graduation_project/frontend/src/views/Files.vue"],"sourcesContent":["<template>\n  <div class=\"files\">\n    <h2>论文管理</h2>\n\n    <el-card>\n      <el-table :data=\"files\" style=\"width: 100%\" :row-style=\"{ height: '60px' }\">\n        <el-table-column prop=\"title\" label=\"论文标题\" min-width=\"300\" show-overflow-tooltip>\n          <template #default=\"{ row }\">\n            <el-tooltip :content=\"row.title || '无标题'\" placement=\"top\" effect=\"dark\">\n              <div class=\"table-cell-text\">{{ row.title || '无标题' }}</div>\n            </el-tooltip>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"year\" label=\"年份\" width=\"100\" />\n        <el-table-column prop=\"venue\" label=\"发表期刊/会议\" min-width=\"250\" show-overflow-tooltip>\n          <template #default=\"{ row }\">\n            <el-tooltip :content=\"row.venue || '未知'\" placement=\"top\" effect=\"dark\">\n              <div class=\"table-cell-text\">{{ row.venue || '未知' }}</div>\n            </el-tooltip>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"created_at\" label=\"上传时间\" :formatter=\"formatTime\" width=\"180\" />\n        <el-table-column label=\"操作\" width=\"200\" fixed=\"right\">\n          <template #default=\"scope\">\n            <el-button size=\"small\" @click=\"analyzeFile(scope.row)\">\n              <i class=\"el-icon-video-play\"></i> 分析\n            </el-button>\n            <el-button size=\"small\" type=\"danger\" @click=\"deleteFile(scope.row)\">\n              <i class=\"el-icon-delete\"></i> 删除\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <el-empty v-if=\"files.length === 0\" description=\"暂无论文，请先上传PDF文件\" />\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport { ElMessage, ElMessageBox } from 'element-plus'\n\nexport default {\n  name: 'Files',\n  setup() {\n    const store = useStore()\n    const router = useRouter()\n\n    const files = computed(() => store.state.files)\n\n    const formatTime = (row, column, time) => {\n      if (!time) return '-'\n      return new Date(time).toLocaleString('zh-CN')\n    }\n\n    const analyzeFile = (paper) => {\n      router.push({ path: '/analyze', query: { paperId: paper.id } })\n    }\n\n    const deleteFile = async (paper) => {\n      try {\n        await ElMessageBox.confirm(\n          `确定要删除论文 \"${paper.title || '未命名'}\" 吗？`,\n          '确认删除',\n          {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }\n        )\n\n        const success = await store.dispatch('deleteFile', paper.id)\n        if (success) {\n          ElMessage.success('删除成功')\n        } else {\n          ElMessage.error('删除失败')\n        }\n      } catch {\n        // 用户取消\n      }\n    }\n\n    onMounted(() => {\n      store.dispatch('fetchFiles')\n    })\n\n    return {\n      files,\n      formatTime,\n      analyzeFile,\n      deleteFile\n    }\n  }\n}\n</script>\n\n<style scoped>\n.files {\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\nh2 {\n  margin-bottom: 20px;\n  color: #303133;\n}\n</style>\n"],"mappings":";AAwCA,SAASA,QAAQ,EAAEC,SAAQ,QAAS,KAAI;AACxC,SAASC,QAAO,QAAS,MAAK;AAC9B,SAASC,SAAQ,QAAS,YAAW;AACrC,SAASC,SAAS,EAAEC,YAAW,QAAS,cAAa;AAErD,eAAe;EACbC,IAAI,EAAE,OAAO;EACbC,KAAKA,CAAA,EAAG;IACN,MAAMC,KAAI,GAAIN,QAAQ,CAAC;IACvB,MAAMO,MAAK,GAAIN,SAAS,CAAC;IAEzB,MAAMO,KAAI,GAAIV,QAAQ,CAAC,MAAMQ,KAAK,CAACG,KAAK,CAACD,KAAK;IAE9C,MAAME,UAAS,GAAIA,CAACC,GAAG,EAAEC,MAAM,EAAEC,IAAI,KAAK;MACxC,IAAI,CAACA,IAAI,EAAE,OAAO,GAAE;MACpB,OAAO,IAAIC,IAAI,CAACD,IAAI,CAAC,CAACE,cAAc,CAAC,OAAO;IAC9C;IAEA,MAAMC,WAAU,GAAKC,KAAK,IAAK;MAC7BV,MAAM,CAACW,IAAI,CAAC;QAAEC,IAAI,EAAE,UAAU;QAAEC,KAAK,EAAE;UAAEC,OAAO,EAAEJ,KAAK,CAACK;QAAG;MAAE,CAAC;IAChE;IAEA,MAAMC,UAAS,GAAI,MAAON,KAAK,IAAK;MAClC,IAAI;QACF,MAAMd,YAAY,CAACqB,OAAO,CACxB,YAAYP,KAAK,CAACQ,KAAI,IAAK,KAAK,MAAM,EACtC,MAAM,EACN;UACEC,iBAAiB,EAAE,IAAI;UACvBC,gBAAgB,EAAE,IAAI;UACtBC,IAAI,EAAE;QACR,CACF;QAEA,MAAMC,OAAM,GAAI,MAAMvB,KAAK,CAACwB,QAAQ,CAAC,YAAY,EAAEb,KAAK,CAACK,EAAE;QAC3D,IAAIO,OAAO,EAAE;UACX3B,SAAS,CAAC2B,OAAO,CAAC,MAAM;QAC1B,OAAO;UACL3B,SAAS,CAAC6B,KAAK,CAAC,MAAM;QACxB;MACF,EAAE,MAAM;QACN;MAAA;IAEJ;IAEAhC,SAAS,CAAC,MAAM;MACdO,KAAK,CAACwB,QAAQ,CAAC,YAAY;IAC7B,CAAC;IAED,OAAO;MACLtB,KAAK;MACLE,UAAU;MACVM,WAAW;MACXO;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}