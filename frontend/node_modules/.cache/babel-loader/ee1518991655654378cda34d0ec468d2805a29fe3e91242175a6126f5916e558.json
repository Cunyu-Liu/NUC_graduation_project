{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createVNode as _createVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createElementVNode as _createElementVNode, openBlock as _openBlock, createBlock as _createBlock, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withModifiers as _withModifiers, normalizeClass as _normalizeClass, resolveDynamicComponent as _resolveDynamicComponent, withKeys as _withKeys } from \"vue\";\nconst _hoisted_1 = {\n  class: \"kimi-chat-container\"\n};\nconst _hoisted_2 = {\n  class: \"sidebar-header\"\n};\nconst _hoisted_3 = {\n  class: \"chat-history\"\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = {\n  class: \"chat-title\"\n};\nconst _hoisted_6 = {\n  class: \"sidebar-footer\"\n};\nconst _hoisted_7 = {\n  class: \"chat-main\"\n};\nconst _hoisted_8 = {\n  class: \"chat-header\"\n};\nconst _hoisted_9 = {\n  class: \"header-left\"\n};\nconst _hoisted_10 = {\n  class: \"chat-title\"\n};\nconst _hoisted_11 = {\n  class: \"header-right\"\n};\nconst _hoisted_12 = {\n  ref: \"messagesContainer\",\n  class: \"messages-area\"\n};\nconst _hoisted_13 = {\n  key: 0,\n  class: \"welcome-section\"\n};\nconst _hoisted_14 = {\n  class: \"welcome-logo\"\n};\nconst _hoisted_15 = {\n  class: \"quick-cards\"\n};\nconst _hoisted_16 = [\"onClick\"];\nconst _hoisted_17 = {\n  class: \"example-questions\"\n};\nconst _hoisted_18 = {\n  class: \"question-tags\"\n};\nconst _hoisted_19 = {\n  class: \"message-avatar\"\n};\nconst _hoisted_20 = {\n  key: 1,\n  class: \"ai-avatar\"\n};\nconst _hoisted_21 = {\n  class: \"message-content\"\n};\nconst _hoisted_22 = {\n  class: \"message-header\"\n};\nconst _hoisted_23 = {\n  class: \"message-role\"\n};\nconst _hoisted_24 = {\n  class: \"message-time\"\n};\nconst _hoisted_25 = [\"innerHTML\"];\nconst _hoisted_26 = {\n  key: 0,\n  class: \"message-references\"\n};\nconst _hoisted_27 = {\n  class: \"ref-list\"\n};\nconst _hoisted_28 = {\n  key: 0,\n  class: \"message-wrapper ai-message typing\"\n};\nconst _hoisted_29 = {\n  class: \"message-avatar\"\n};\nconst _hoisted_30 = {\n  class: \"ai-avatar\"\n};\nconst _hoisted_31 = {\n  class: \"input-area\"\n};\nconst _hoisted_32 = {\n  class: \"input-toolbar\"\n};\nconst _hoisted_33 = {\n  key: 0,\n  class: \"badge\"\n};\nconst _hoisted_34 = {\n  class: \"input-box\"\n};\nconst _hoisted_35 = [\"disabled\"];\nconst _hoisted_36 = {\n  class: \"input-hint\"\n};\nconst _hoisted_37 = {\n  key: 0\n};\nconst _hoisted_38 = {\n  class: \"paper-selector\"\n};\nconst _hoisted_39 = {\n  class: \"dialog-footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_el_dropdown_item = _resolveComponent(\"el-dropdown-item\");\n  const _component_el_dropdown_menu = _resolveComponent(\"el-dropdown-menu\");\n  const _component_el_dropdown = _resolveComponent(\"el-dropdown\");\n  const _component_el_tag = _resolveComponent(\"el-tag\");\n  const _component_el_option = _resolveComponent(\"el-option\");\n  const _component_el_select = _resolveComponent(\"el-select\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_tooltip = _resolveComponent(\"el-tooltip\");\n  const _component_el_avatar = _resolveComponent(\"el-avatar\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_table_column = _resolveComponent(\"el-table-column\");\n  const _component_el_table = _resolveComponent(\"el-table\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_slider = _resolveComponent(\"el-slider\");\n  const _component_el_input_number = _resolveComponent(\"el-input-number\");\n  const _component_el_switch = _resolveComponent(\"el-switch\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 左侧边栏 \"), _createElementVNode(\"aside\", {\n    class: _normalizeClass([\"sidebar\", {\n      'collapsed': $setup.sidebarCollapsed\n    }])\n  }, [_createCommentVNode(\" 新建对话按钮 \"), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"button\", {\n    class: \"new-chat-btn\",\n    onClick: $setup.createNewChat\n  }, [_createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [_createVNode($setup[\"Plus\"])]),\n    _: 1 /* STABLE */\n  }), _cache[23] || (_cache[23] = _createElementVNode(\"span\", null, \"新建对话\", -1 /* CACHED */))]), _createElementVNode(\"button\", {\n    class: \"collapse-btn\",\n    onClick: _cache[0] || (_cache[0] = $event => $setup.sidebarCollapsed = !$setup.sidebarCollapsed)\n  }, [_createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [!$setup.sidebarCollapsed ? (_openBlock(), _createBlock($setup[\"Fold\"], {\n      key: 0\n    })) : (_openBlock(), _createBlock($setup[\"Expand\"], {\n      key: 1\n    }))]),\n    _: 1 /* STABLE */\n  })])]), _createCommentVNode(\" 对话历史列表 \"), _createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.chatHistory, chat => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: chat.chat_id,\n      class: _normalizeClass([\"chat-item\", {\n        active: $setup.currentChatId === chat.chat_id\n      }]),\n      onClick: $event => $setup.switchChat(chat.chat_id)\n    }, [_createVNode(_component_el_icon, {\n      class: \"chat-icon\"\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"ChatLineRound\"])]),\n      _: 1 /* STABLE */\n    }), _createElementVNode(\"span\", _hoisted_5, _toDisplayString(chat.preview || '新对话'), 1 /* TEXT */), _createElementVNode(\"div\", {\n      class: \"chat-actions\",\n      onClick: _cache[1] || (_cache[1] = _withModifiers(() => {}, [\"stop\"]))\n    }, [_createVNode(_component_el_dropdown, {\n      trigger: \"click\",\n      teleported: false\n    }, {\n      dropdown: _withCtx(() => [_createVNode(_component_el_dropdown_menu, null, {\n        default: _withCtx(() => [_createVNode(_component_el_dropdown_item, {\n          onClick: $event => $setup.renameChat(chat.chat_id)\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n            default: _withCtx(() => [_createVNode($setup[\"Edit\"])]),\n            _: 1 /* STABLE */\n          }), _cache[24] || (_cache[24] = _createTextVNode(\" 重命名 \", -1 /* CACHED */))]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_dropdown_item, {\n          divided: \"\",\n          onClick: $event => $setup.deleteChat(chat.chat_id),\n          class: \"danger\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n            default: _withCtx(() => [_createVNode($setup[\"Delete\"])]),\n            _: 1 /* STABLE */\n          }), _cache[25] || (_cache[25] = _createTextVNode(\" 删除 \", -1 /* CACHED */))]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"])]),\n        _: 2 /* DYNAMIC */\n      }, 1024 /* DYNAMIC_SLOTS */)]),\n      default: _withCtx(() => [_createVNode(_component_el_icon, {\n        class: \"more-icon\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"MoreFilled\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 2 /* DYNAMIC */\n    }, 1024 /* DYNAMIC_SLOTS */)])], 10 /* CLASS, PROPS */, _hoisted_4);\n  }), 128 /* KEYED_FRAGMENT */))]), _createCommentVNode(\" 底部设置 \"), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"button\", {\n    class: \"footer-btn\",\n    onClick: _cache[2] || (_cache[2] = $event => $setup.showSettings = true)\n  }, [_createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [_createVNode($setup[\"Setting\"])]),\n    _: 1 /* STABLE */\n  }), _cache[26] || (_cache[26] = _createElementVNode(\"span\", null, \"设置\", -1 /* CACHED */))])])], 2 /* CLASS */), _createCommentVNode(\" 主聊天区域 \"), _createElementVNode(\"main\", _hoisted_7, [_createCommentVNode(\" 顶部导航 \"), _createElementVNode(\"header\", _hoisted_8, [_createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"h2\", _hoisted_10, _toDisplayString($setup.currentChatTitle), 1 /* TEXT */), $setup.selectedPapers.length > 0 ? (_openBlock(), _createBlock(_component_el_tag, {\n    key: 0,\n    type: \"success\",\n    size: \"small\"\n  }, {\n    default: _withCtx(() => [_createTextVNode(\" 已关联 \" + _toDisplayString($setup.selectedPapers.length) + \" 篇论文 \", 1 /* TEXT */)]),\n    _: 1 /* STABLE */\n  })) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_11, [_createVNode(_component_el_select, {\n    modelValue: $setup.currentModel,\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.currentModel = $event),\n    size: \"small\",\n    class: \"model-select\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_option, {\n      label: \"GLM-4-Plus\",\n      value: \"glm-4-plus\"\n    }), _createVNode(_component_el_option, {\n      label: \"GLM-4-Flash\",\n      value: \"glm-4-flash\"\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]), _createVNode(_component_el_tooltip, {\n    content: \"关联论文\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_button, {\n      circle: \"\",\n      size: \"small\",\n      onClick: _cache[4] || (_cache[4] = $event => $setup.showPaperSelector = true)\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n        default: _withCtx(() => [_createVNode($setup[\"Document\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_tooltip, {\n    content: \"清空对话\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_button, {\n      circle: \"\",\n      size: \"small\",\n      onClick: $setup.clearCurrentChat\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n        default: _withCtx(() => [_createVNode($setup[\"Delete\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  })])]), _createCommentVNode(\" 消息列表区域 \"), _createElementVNode(\"div\", _hoisted_12, [_createCommentVNode(\" 欢迎页面 \"), $setup.messages.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [_createElementVNode(\"div\", _hoisted_14, [_createVNode(_component_el_icon, {\n    size: 80,\n    color: \"#10b981\"\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"ChatDotRound\"])]),\n    _: 1 /* STABLE */\n  })]), _cache[28] || (_cache[28] = _createElementVNode(\"h1\", {\n    class: \"welcome-title\"\n  }, \"AI 科研助手\", -1 /* CACHED */)), _cache[29] || (_cache[29] = _createElementVNode(\"p\", {\n    class: \"welcome-subtitle\"\n  }, \" 基于您的论文库，提供深度文献分析、研究建议、代码生成等服务 \", -1 /* CACHED */)), _createCommentVNode(\" 快捷功能卡片 \"), _createElementVNode(\"div\", _hoisted_15, [(_openBlock(), _createElementBlock(_Fragment, null, _renderList($setup.quickCards, card => {\n    return _createElementVNode(\"div\", {\n      key: card.key,\n      class: \"quick-card\",\n      onClick: $event => $setup.sendQuickMessage(card.prompt)\n    }, [_createVNode(_component_el_icon, {\n      size: 24\n    }, {\n      default: _withCtx(() => [(_openBlock(), _createBlock(_resolveDynamicComponent(card.icon)))]),\n      _: 2 /* DYNAMIC */\n    }, 1024 /* DYNAMIC_SLOTS */), _createElementVNode(\"span\", null, _toDisplayString(card.label), 1 /* TEXT */)], 8 /* PROPS */, _hoisted_16);\n  }), 64 /* STABLE_FRAGMENT */))]), _createCommentVNode(\" 示例问题 \"), _createElementVNode(\"div\", _hoisted_17, [_cache[27] || (_cache[27] = _createElementVNode(\"div\", {\n    class: \"section-title\"\n  }, \"你可以这样问我：\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_18, [(_openBlock(), _createElementBlock(_Fragment, null, _renderList($setup.exampleQuestions, q => {\n    return _createVNode(_component_el_tag, {\n      key: q,\n      class: \"question-tag\",\n      effect: \"plain\",\n      onClick: $event => $setup.sendMessage(q)\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(q), 1 /* TEXT */)]),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]);\n  }), 64 /* STABLE_FRAGMENT */))])])])) : (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_createCommentVNode(\" 消息列表 \"), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.messages, (message, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      class: _normalizeClass([\"message-wrapper\", {\n        'user-message': message.role === 'user',\n        'ai-message': message.role === 'assistant'\n      }])\n    }, [_createElementVNode(\"div\", _hoisted_19, [message.role === 'user' ? (_openBlock(), _createBlock(_component_el_avatar, {\n      key: 0,\n      size: 36,\n      src: $setup.userAvatar\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.userInitial), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"src\"])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_20, [_createVNode(_component_el_icon, {\n      size: 20\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"Cpu\"])]),\n      _: 1 /* STABLE */\n    })]))]), _createElementVNode(\"div\", _hoisted_21, [_createCommentVNode(\" 消息头部 \"), _createElementVNode(\"div\", _hoisted_22, [_createElementVNode(\"span\", _hoisted_23, _toDisplayString(message.role === 'user' ? '我' : 'AI 助手'), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_24, _toDisplayString($setup.formatTime(message.timestamp)), 1 /* TEXT */)]), _createCommentVNode(\" 消息体 \"), _createElementVNode(\"div\", {\n      class: \"message-body\",\n      innerHTML: $setup.renderMessage(message.content)\n    }, null, 8 /* PROPS */, _hoisted_25), _createCommentVNode(\" 引用论文 \"), message.references && message.references.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_26, [_cache[30] || (_cache[30] = _createElementVNode(\"div\", {\n      class: \"ref-title\"\n    }, \"引用文献：\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_27, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(message.references, ref => {\n      return _openBlock(), _createBlock(_component_el_tag, {\n        key: ref.paper_id,\n        size: \"small\",\n        type: \"info\",\n        class: \"ref-tag\",\n        onClick: $event => $setup.viewPaper(ref.paper_id)\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString(ref.title), 1 /* TEXT */)]),\n        _: 2 /* DYNAMIC */\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]);\n    }), 128 /* KEYED_FRAGMENT */))])])) : _createCommentVNode(\"v-if\", true)])], 2 /* CLASS */);\n  }), 128 /* KEYED_FRAGMENT */)), _createCommentVNode(\" AI 正在输入 \"), $setup.isTyping ? (_openBlock(), _createElementBlock(\"div\", _hoisted_28, [_createElementVNode(\"div\", _hoisted_29, [_createElementVNode(\"div\", _hoisted_30, [_createVNode(_component_el_icon, {\n    size: 20\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"Cpu\"])]),\n    _: 1 /* STABLE */\n  })])]), _cache[31] || (_cache[31] = _createElementVNode(\"div\", {\n    class: \"message-content\"\n  }, [_createElementVNode(\"div\", {\n    class: \"typing-indicator\"\n  }, [_createElementVNode(\"span\"), _createElementVNode(\"span\"), _createElementVNode(\"span\")])], -1 /* CACHED */))])) : _createCommentVNode(\"v-if\", true)], 64 /* STABLE_FRAGMENT */))], 512 /* NEED_PATCH */), _createCommentVNode(\" 输入区域 \"), _createElementVNode(\"footer\", _hoisted_31, [_createElementVNode(\"div\", _hoisted_32, [_createVNode(_component_el_tooltip, {\n    content: \"上传文件\"\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"button\", {\n      class: \"tool-btn\",\n      onClick: $setup.handleUpload\n    }, [_createVNode(_component_el_icon, null, {\n      default: _withCtx(() => [_createVNode($setup[\"Paperclip\"])]),\n      _: 1 /* STABLE */\n    })])]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_tooltip, {\n    content: \"关联论文\"\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"button\", {\n      class: \"tool-btn\",\n      onClick: _cache[5] || (_cache[5] = $event => $setup.showPaperSelector = true)\n    }, [_createVNode(_component_el_icon, null, {\n      default: _withCtx(() => [_createVNode($setup[\"Document\"])]),\n      _: 1 /* STABLE */\n    }), $setup.selectedPapers.length > 0 ? (_openBlock(), _createElementBlock(\"span\", _hoisted_33, _toDisplayString($setup.selectedPapers.length), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_tooltip, {\n    content: \"使用 RAG\"\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"button\", {\n      class: _normalizeClass([\"tool-btn\", {\n        active: $setup.useRag\n      }]),\n      onClick: _cache[6] || (_cache[6] = $event => $setup.useRag = !$setup.useRag)\n    }, [_createVNode(_component_el_icon, null, {\n      default: _withCtx(() => [_createVNode($setup[\"Search\"])]),\n      _: 1 /* STABLE */\n    }), _cache[32] || (_cache[32] = _createElementVNode(\"span\", null, \"RAG\", -1 /* CACHED */))], 2 /* CLASS */)]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_tooltip, {\n    content: \"网络搜索\"\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"button\", {\n      class: _normalizeClass([\"tool-btn\", {\n        active: $setup.useWebSearch\n      }]),\n      onClick: _cache[7] || (_cache[7] = $event => $setup.useWebSearch = !$setup.useWebSearch)\n    }, [_createVNode(_component_el_icon, null, {\n      default: _withCtx(() => [_createVNode($setup[\"Globe\"])]),\n      _: 1 /* STABLE */\n    }), _cache[33] || (_cache[33] = _createElementVNode(\"span\", null, \"联网\", -1 /* CACHED */))], 2 /* CLASS */)]),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_34, [_createVNode(_component_el_input, {\n    modelValue: $setup.inputMessage,\n    \"onUpdate:modelValue\": _cache[8] || (_cache[8] = $event => $setup.inputMessage = $event),\n    type: \"textarea\",\n    rows: $setup.inputRows,\n    placeholder: \"输入您的问题，AI 将基于您的论文库进行回答...\",\n    resize: \"none\",\n    onKeydown: _withKeys(_withModifiers($setup.handleEnter, [\"prevent\"]), [\"enter\"]),\n    onInput: $setup.handleInput\n  }, null, 8 /* PROPS */, [\"modelValue\", \"rows\", \"onKeydown\"]), _createElementVNode(\"button\", {\n    class: \"send-btn\",\n    disabled: !$setup.canSend,\n    onClick: _cache[9] || (_cache[9] = $event => $setup.sendMessage())\n  }, [!$setup.isTyping ? (_openBlock(), _createBlock(_component_el_icon, {\n    key: 0\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"Promotion\"])]),\n    _: 1 /* STABLE */\n  })) : (_openBlock(), _createBlock(_component_el_icon, {\n    key: 1,\n    class: \"loading\"\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"Loading\"])]),\n    _: 1 /* STABLE */\n  }))], 8 /* PROPS */, _hoisted_35)]), _createElementVNode(\"div\", _hoisted_36, [_cache[34] || (_cache[34] = _createElementVNode(\"span\", null, \"Enter 发送，Shift + Enter 换行\", -1 /* CACHED */)), $setup.inputMessage.length > 0 ? (_openBlock(), _createElementBlock(\"span\", _hoisted_37, _toDisplayString($setup.inputMessage.length) + \" 字符\", 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])])]), _createCommentVNode(\" 论文选择对话框 \"), _createVNode(_component_el_dialog, {\n    modelValue: $setup.showPaperSelector,\n    \"onUpdate:modelValue\": _cache[12] || (_cache[12] = $event => $setup.showPaperSelector = $event),\n    title: \"选择关联论文\",\n    width: \"700px\"\n  }, {\n    footer: _withCtx(() => [_createElementVNode(\"div\", _hoisted_39, [_createElementVNode(\"span\", null, \"已选择 \" + _toDisplayString($setup.tempSelectedPapers.length) + \" 篇论文\", 1 /* TEXT */), _createElementVNode(\"div\", null, [_createVNode(_component_el_button, {\n      onClick: _cache[11] || (_cache[11] = $event => $setup.showPaperSelector = false)\n    }, {\n      default: _withCtx(() => [...(_cache[35] || (_cache[35] = [_createTextVNode(\"取消\", -1 /* CACHED */)]))]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: $setup.confirmPaperSelection\n    }, {\n      default: _withCtx(() => [...(_cache[36] || (_cache[36] = [_createTextVNode(\"确定\", -1 /* CACHED */)]))]),\n      _: 1 /* STABLE */\n    })])])]),\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_38, [_createVNode(_component_el_input, {\n      modelValue: $setup.paperSearch,\n      \"onUpdate:modelValue\": _cache[10] || (_cache[10] = $event => $setup.paperSearch = $event),\n      placeholder: \"搜索论文...\",\n      clearable: \"\",\n      class: \"paper-search\"\n    }, {\n      prefix: _withCtx(() => [_createVNode(_component_el_icon, null, {\n        default: _withCtx(() => [_createVNode($setup[\"Search\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"modelValue\"]), _createVNode(_component_el_table, {\n      data: $setup.filteredPapers,\n      style: {\n        \"width\": \"100%\"\n      },\n      \"max-height\": \"400\",\n      onSelectionChange: $setup.handlePaperSelectionChange,\n      ref: \"paperTable\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_table_column, {\n        type: \"selection\",\n        width: \"55\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"title\",\n        label: \"论文标题\",\n        \"show-overflow-tooltip\": \"\",\n        \"min-width\": \"250\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"year\",\n        label: \"年份\",\n        width: \"80\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"venue\",\n        label: \"期刊/会议\",\n        \"show-overflow-tooltip\": \"\"\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"data\"])])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]), _createCommentVNode(\" 设置对话框 \"), _createVNode(_component_el_dialog, {\n    modelValue: $setup.showSettings,\n    \"onUpdate:modelValue\": _cache[19] || (_cache[19] = $event => $setup.showSettings = $event),\n    title: \"聊天设置\",\n    width: \"500px\"\n  }, {\n    footer: _withCtx(() => [_createVNode(_component_el_button, {\n      onClick: _cache[18] || (_cache[18] = $event => $setup.showSettings = false)\n    }, {\n      default: _withCtx(() => [...(_cache[38] || (_cache[38] = [_createTextVNode(\"关闭\", -1 /* CACHED */)]))]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: $setup.saveSettings\n    }, {\n      default: _withCtx(() => [...(_cache[39] || (_cache[39] = [_createTextVNode(\"保存设置\", -1 /* CACHED */)]))]),\n      _: 1 /* STABLE */\n    })]),\n    default: _withCtx(() => [_createVNode(_component_el_form, {\n      \"label-width\": \"100px\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"默认模型\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_select, {\n          modelValue: $setup.settings.model,\n          \"onUpdate:modelValue\": _cache[13] || (_cache[13] = $event => $setup.settings.model = $event),\n          style: {\n            \"width\": \"100%\"\n          }\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_option, {\n            label: \"GLM-4-Plus\",\n            value: \"glm-4-plus\"\n          }), _createVNode(_component_el_option, {\n            label: \"GLM-4-Flash\",\n            value: \"glm-4-flash\"\n          })]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"温度\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_slider, {\n          modelValue: $setup.settings.temperature,\n          \"onUpdate:modelValue\": _cache[14] || (_cache[14] = $event => $setup.settings.temperature = $event),\n          min: 0,\n          max: 1,\n          step: 0.1,\n          \"show-stops\": \"\"\n        }, null, 8 /* PROPS */, [\"modelValue\"]), _cache[37] || (_cache[37] = _createElementVNode(\"div\", {\n          class: \"slider-hint\"\n        }, \"较低的值使输出更确定，较高的值使输出更随机\", -1 /* CACHED */))]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"最大长度\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input_number, {\n          modelValue: $setup.settings.maxTokens,\n          \"onUpdate:modelValue\": _cache[15] || (_cache[15] = $event => $setup.settings.maxTokens = $event),\n          min: 1000,\n          max: 8000,\n          step: 1000,\n          style: {\n            \"width\": \"100%\"\n          }\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"启用 RAG\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_switch, {\n          modelValue: $setup.settings.useRag,\n          \"onUpdate:modelValue\": _cache[16] || (_cache[16] = $event => $setup.settings.useRag = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"自动引用\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_switch, {\n          modelValue: $setup.settings.autoReference,\n          \"onUpdate:modelValue\": _cache[17] || (_cache[17] = $event => $setup.settings.autoReference = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]), _createCommentVNode(\" 重命名对话框 \"), _createVNode(_component_el_dialog, {\n    modelValue: $setup.showRenameDialog,\n    \"onUpdate:modelValue\": _cache[22] || (_cache[22] = $event => $setup.showRenameDialog = $event),\n    title: \"重命名对话\",\n    width: \"400px\"\n  }, {\n    footer: _withCtx(() => [_createVNode(_component_el_button, {\n      onClick: _cache[21] || (_cache[21] = $event => $setup.showRenameDialog = false)\n    }, {\n      default: _withCtx(() => [...(_cache[40] || (_cache[40] = [_createTextVNode(\"取消\", -1 /* CACHED */)]))]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: $setup.confirmRename\n    }, {\n      default: _withCtx(() => [...(_cache[41] || (_cache[41] = [_createTextVNode(\"确定\", -1 /* CACHED */)]))]),\n      _: 1 /* STABLE */\n    })]),\n    default: _withCtx(() => [_createVNode(_component_el_input, {\n      modelValue: $setup.renameValue,\n      \"onUpdate:modelValue\": _cache[20] || (_cache[20] = $event => $setup.renameValue = $event),\n      placeholder: \"输入新名称\"\n    }, null, 8 /* PROPS */, [\"modelValue\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])]);\n}","map":{"version":3,"names":["class","ref","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","_normalizeClass","$setup","sidebarCollapsed","_hoisted_2","onClick","createNewChat","_createVNode","_component_el_icon","_cache","$event","_createBlock","key","_hoisted_3","_Fragment","_renderList","chatHistory","chat","chat_id","active","currentChatId","switchChat","_hoisted_5","_toDisplayString","preview","_withModifiers","_component_el_dropdown","trigger","teleported","dropdown","_withCtx","_component_el_dropdown_menu","_component_el_dropdown_item","renameChat","divided","deleteChat","_hoisted_6","showSettings","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","currentChatTitle","selectedPapers","length","_component_el_tag","type","size","_hoisted_11","_component_el_select","currentModel","_component_el_option","label","value","_component_el_tooltip","content","_component_el_button","circle","showPaperSelector","clearCurrentChat","_hoisted_12","messages","_hoisted_13","_hoisted_14","color","_hoisted_15","quickCards","card","sendQuickMessage","prompt","_resolveDynamicComponent","icon","_hoisted_17","_hoisted_18","exampleQuestions","q","effect","sendMessage","message","index","role","_hoisted_19","_component_el_avatar","src","userAvatar","userInitial","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","formatTime","timestamp","innerHTML","renderMessage","references","_hoisted_26","_hoisted_27","paper_id","viewPaper","title","isTyping","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","handleUpload","_hoisted_33","useRag","useWebSearch","_hoisted_34","_component_el_input","inputMessage","rows","inputRows","placeholder","resize","onKeydown","_withKeys","handleEnter","onInput","handleInput","disabled","canSend","_hoisted_36","_hoisted_37","_component_el_dialog","width","footer","_hoisted_39","tempSelectedPapers","confirmPaperSelection","_hoisted_38","paperSearch","clearable","prefix","_component_el_table","data","filteredPapers","style","onSelectionChange","handlePaperSelectionChange","_component_el_table_column","prop","saveSettings","_component_el_form","_component_el_form_item","settings","model","_component_el_slider","temperature","min","max","step","_component_el_input_number","maxTokens","_component_el_switch","autoReference","showRenameDialog","confirmRename","renameValue"],"sources":["/Users/liucunyu/Documents/all_code/NUC_graduation_project/frontend/src/views/KimiChat.vue"],"sourcesContent":["<template>\n  <div class=\"kimi-chat-container\">\n    <!-- 左侧边栏 -->\n    <aside class=\"sidebar\" :class=\"{ 'collapsed': sidebarCollapsed }\">\n      <!-- 新建对话按钮 -->\n      <div class=\"sidebar-header\">\n        <button class=\"new-chat-btn\" @click=\"createNewChat\">\n          <el-icon><Plus /></el-icon>\n          <span>新建对话</span>\n        </button>\n        <button class=\"collapse-btn\" @click=\"sidebarCollapsed = !sidebarCollapsed\">\n          <el-icon><Fold v-if=\"!sidebarCollapsed\" /><Expand v-else /></el-icon>\n        </button>\n      </div>\n\n      <!-- 对话历史列表 -->\n      <div class=\"chat-history\">\n        <div\n          v-for=\"chat in chatHistory\"\n          :key=\"chat.chat_id\"\n          class=\"chat-item\"\n          :class=\"{ active: currentChatId === chat.chat_id }\"\n          @click=\"switchChat(chat.chat_id)\"\n        >\n          <el-icon class=\"chat-icon\"><ChatLineRound /></el-icon>\n          <span class=\"chat-title\">{{ chat.preview || '新对话' }}</span>\n          <div class=\"chat-actions\" @click.stop>\n            <el-dropdown trigger=\"click\" :teleported=\"false\">\n              <el-icon class=\"more-icon\"><MoreFilled /></el-icon>\n              <template #dropdown>\n                <el-dropdown-menu>\n                  <el-dropdown-item @click=\"renameChat(chat.chat_id)\">\n                    <el-icon><Edit /></el-icon> 重命名\n                  </el-dropdown-item>\n                  <el-dropdown-item divided @click=\"deleteChat(chat.chat_id)\" class=\"danger\">\n                    <el-icon><Delete /></el-icon> 删除\n                  </el-dropdown-item>\n                </el-dropdown-menu>\n              </template>\n            </el-dropdown>\n          </div>\n        </div>\n      </div>\n\n      <!-- 底部设置 -->\n      <div class=\"sidebar-footer\">\n        <button class=\"footer-btn\" @click=\"showSettings = true\">\n          <el-icon><Setting /></el-icon>\n          <span>设置</span>\n        </button>\n      </div>\n    </aside>\n\n    <!-- 主聊天区域 -->\n    <main class=\"chat-main\">\n      <!-- 顶部导航 -->\n      <header class=\"chat-header\">\n        <div class=\"header-left\">\n          <h2 class=\"chat-title\">{{ currentChatTitle }}</h2>\n          <el-tag v-if=\"selectedPapers.length > 0\" type=\"success\" size=\"small\">\n            已关联 {{ selectedPapers.length }} 篇论文\n          </el-tag>\n        </div>\n        <div class=\"header-right\">\n          <el-select v-model=\"currentModel\" size=\"small\" class=\"model-select\">\n            <el-option label=\"GLM-4-Plus\" value=\"glm-4-plus\" />\n            <el-option label=\"GLM-4-Flash\" value=\"glm-4-flash\" />\n          </el-select>\n          <el-tooltip content=\"关联论文\">\n            <el-button circle size=\"small\" @click=\"showPaperSelector = true\">\n              <el-icon><Document /></el-icon>\n            </el-button>\n          </el-tooltip>\n          <el-tooltip content=\"清空对话\">\n            <el-button circle size=\"small\" @click=\"clearCurrentChat\">\n              <el-icon><Delete /></el-icon>\n            </el-button>\n          </el-tooltip>\n        </div>\n      </header>\n\n      <!-- 消息列表区域 -->\n      <div ref=\"messagesContainer\" class=\"messages-area\">\n        <!-- 欢迎页面 -->\n        <div v-if=\"messages.length === 0\" class=\"welcome-section\">\n          <div class=\"welcome-logo\">\n            <el-icon :size=\"80\" color=\"#10b981\"><ChatDotRound /></el-icon>\n          </div>\n          <h1 class=\"welcome-title\">AI 科研助手</h1>\n          <p class=\"welcome-subtitle\">\n            基于您的论文库，提供深度文献分析、研究建议、代码生成等服务\n          </p>\n\n          <!-- 快捷功能卡片 -->\n          <div class=\"quick-cards\">\n            <div\n              v-for=\"card in quickCards\"\n              :key=\"card.key\"\n              class=\"quick-card\"\n              @click=\"sendQuickMessage(card.prompt)\"\n            >\n              <el-icon :size=\"24\"><component :is=\"card.icon\" /></el-icon>\n              <span>{{ card.label }}</span>\n            </div>\n          </div>\n\n          <!-- 示例问题 -->\n          <div class=\"example-questions\">\n            <div class=\"section-title\">你可以这样问我：</div>\n            <div class=\"question-tags\">\n              <el-tag\n                v-for=\"q in exampleQuestions\"\n                :key=\"q\"\n                class=\"question-tag\"\n                effect=\"plain\"\n                @click=\"sendMessage(q)\"\n              >\n                {{ q }}\n              </el-tag>\n            </div>\n          </div>\n        </div>\n\n        <!-- 消息列表 -->\n        <template v-else>\n          <div\n            v-for=\"(message, index) in messages\"\n            :key=\"index\"\n            class=\"message-wrapper\"\n            :class=\"{ 'user-message': message.role === 'user', 'ai-message': message.role === 'assistant' }\"\n          >\n            <div class=\"message-avatar\">\n              <el-avatar\n                v-if=\"message.role === 'user'\"\n                :size=\"36\"\n                :src=\"userAvatar\"\n              >\n                {{ userInitial }}\n              </el-avatar>\n              <div v-else class=\"ai-avatar\">\n                <el-icon :size=\"20\"><Cpu /></el-icon>\n              </div>\n            </div>\n\n            <div class=\"message-content\">\n              <!-- 消息头部 -->\n              <div class=\"message-header\">\n                <span class=\"message-role\">{{ message.role === 'user' ? '我' : 'AI 助手' }}</span>\n                <span class=\"message-time\">{{ formatTime(message.timestamp) }}</span>\n              </div>\n\n              <!-- 消息体 -->\n              <div class=\"message-body\" v-html=\"renderMessage(message.content)\"></div>\n\n              <!-- 引用论文 -->\n              <div v-if=\"message.references && message.references.length > 0\" class=\"message-references\">\n                <div class=\"ref-title\">引用文献：</div>\n                <div class=\"ref-list\">\n                  <el-tag\n                    v-for=\"ref in message.references\"\n                    :key=\"ref.paper_id\"\n                    size=\"small\"\n                    type=\"info\"\n                    class=\"ref-tag\"\n                    @click=\"viewPaper(ref.paper_id)\"\n                  >\n                    {{ ref.title }}\n                  </el-tag>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <!-- AI 正在输入 -->\n          <div v-if=\"isTyping\" class=\"message-wrapper ai-message typing\">\n            <div class=\"message-avatar\">\n              <div class=\"ai-avatar\">\n                <el-icon :size=\"20\"><Cpu /></el-icon>\n              </div>\n            </div>\n            <div class=\"message-content\">\n              <div class=\"typing-indicator\">\n                <span></span>\n                <span></span>\n                <span></span>\n              </div>\n            </div>\n          </div>\n        </template>\n      </div>\n\n      <!-- 输入区域 -->\n      <footer class=\"input-area\">\n        <div class=\"input-toolbar\">\n          <el-tooltip content=\"上传文件\">\n            <button class=\"tool-btn\" @click=\"handleUpload\">\n              <el-icon><Paperclip /></el-icon>\n            </button>\n          </el-tooltip>\n          <el-tooltip content=\"关联论文\">\n            <button class=\"tool-btn\" @click=\"showPaperSelector = true\">\n              <el-icon><Document /></el-icon>\n              <span v-if=\"selectedPapers.length > 0\" class=\"badge\">{{ selectedPapers.length }}</span>\n            </button>\n          </el-tooltip>\n          <el-tooltip content=\"使用 RAG\">\n            <button\n              class=\"tool-btn\"\n              :class=\"{ active: useRag }\"\n              @click=\"useRag = !useRag\"\n            >\n              <el-icon><Search /></el-icon>\n              <span>RAG</span>\n            </button>\n          </el-tooltip>\n          <el-tooltip content=\"网络搜索\">\n            <button\n              class=\"tool-btn\"\n              :class=\"{ active: useWebSearch }\"\n              @click=\"useWebSearch = !useWebSearch\"\n            >\n              <el-icon><Globe /></el-icon>\n              <span>联网</span>\n            </button>\n          </el-tooltip>\n        </div>\n\n        <div class=\"input-box\">\n          <el-input\n            v-model=\"inputMessage\"\n            type=\"textarea\"\n            :rows=\"inputRows\"\n            placeholder=\"输入您的问题，AI 将基于您的论文库进行回答...\"\n            resize=\"none\"\n            @keydown.enter.prevent=\"handleEnter\"\n            @input=\"handleInput\"\n          />\n          <button\n            class=\"send-btn\"\n            :disabled=\"!canSend\"\n            @click=\"sendMessage()\"\n          >\n            <el-icon v-if=\"!isTyping\"><Promotion /></el-icon>\n            <el-icon v-else class=\"loading\"><Loading /></el-icon>\n          </button>\n        </div>\n\n        <div class=\"input-hint\">\n          <span>Enter 发送，Shift + Enter 换行</span>\n          <span v-if=\"inputMessage.length > 0\">{{ inputMessage.length }} 字符</span>\n        </div>\n      </footer>\n    </main>\n\n    <!-- 论文选择对话框 -->\n    <el-dialog v-model=\"showPaperSelector\" title=\"选择关联论文\" width=\"700px\">\n      <div class=\"paper-selector\">\n        <el-input\n          v-model=\"paperSearch\"\n          placeholder=\"搜索论文...\"\n          clearable\n          class=\"paper-search\"\n        >\n          <template #prefix>\n            <el-icon><Search /></el-icon>\n          </template>\n        </el-input>\n\n        <el-table\n          :data=\"filteredPapers\"\n          style=\"width: 100%\"\n          max-height=\"400\"\n          @selection-change=\"handlePaperSelectionChange\"\n          ref=\"paperTable\"\n        >\n          <el-table-column type=\"selection\" width=\"55\" />\n          <el-table-column prop=\"title\" label=\"论文标题\" show-overflow-tooltip min-width=\"250\" />\n          <el-table-column prop=\"year\" label=\"年份\" width=\"80\" />\n          <el-table-column prop=\"venue\" label=\"期刊/会议\" show-overflow-tooltip />\n        </el-table>\n      </div>\n\n      <template #footer>\n        <div class=\"dialog-footer\">\n          <span>已选择 {{ tempSelectedPapers.length }} 篇论文</span>\n          <div>\n            <el-button @click=\"showPaperSelector = false\">取消</el-button>\n            <el-button type=\"primary\" @click=\"confirmPaperSelection\">确定</el-button>\n          </div>\n        </div>\n      </template>\n    </el-dialog>\n\n    <!-- 设置对话框 -->\n    <el-dialog v-model=\"showSettings\" title=\"聊天设置\" width=\"500px\">\n      <el-form label-width=\"100px\">\n        <el-form-item label=\"默认模型\">\n          <el-select v-model=\"settings.model\" style=\"width: 100%\">\n            <el-option label=\"GLM-4-Plus\" value=\"glm-4-plus\" />\n            <el-option label=\"GLM-4-Flash\" value=\"glm-4-flash\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"温度\">\n          <el-slider v-model=\"settings.temperature\" :min=\"0\" :max=\"1\" :step=\"0.1\" show-stops />\n          <div class=\"slider-hint\">较低的值使输出更确定，较高的值使输出更随机</div>\n        </el-form-item>\n        <el-form-item label=\"最大长度\">\n          <el-input-number v-model=\"settings.maxTokens\" :min=\"1000\" :max=\"8000\" :step=\"1000\" style=\"width: 100%\" />\n        </el-form-item>\n        <el-form-item label=\"启用 RAG\">\n          <el-switch v-model=\"settings.useRag\" />\n        </el-form-item>\n        <el-form-item label=\"自动引用\">\n          <el-switch v-model=\"settings.autoReference\" />\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <el-button @click=\"showSettings = false\">关闭</el-button>\n        <el-button type=\"primary\" @click=\"saveSettings\">保存设置</el-button>\n      </template>\n    </el-dialog>\n\n    <!-- 重命名对话框 -->\n    <el-dialog v-model=\"showRenameDialog\" title=\"重命名对话\" width=\"400px\">\n      <el-input v-model=\"renameValue\" placeholder=\"输入新名称\" />\n      <template #footer>\n        <el-button @click=\"showRenameDialog = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmRename\">确定</el-button>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted, nextTick, watch } from 'vue'\nimport { useStore } from 'vuex'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport {\n  Plus, Fold, Expand, ChatLineRound, MoreFilled, Setting,\n  Document, Delete, ChatDotRound, Cpu, Paperclip, Search,\n  Globe, Promotion, Loading, Edit\n} from '@element-plus/icons-vue'\nimport api from '@/api'\nimport { marked } from 'marked'\nimport DOMPurify from 'dompurify'\nimport hljs from 'highlight.js'\n\n// 配置 marked\nmarked.setOptions({\n  highlight: function(code, lang) {\n    if (lang && hljs.getLanguage(lang)) {\n      return hljs.highlight(code, { language: lang }).value\n    }\n    return hljs.highlightAuto(code).value\n  },\n  breaks: true,\n  gfm: true\n})\n\nconst store = useStore()\n\n// ==================== 状态 ====================\nconst sidebarCollapsed = ref(false)\nconst currentChatId = ref(null)\nconst chatHistory = ref([])\nconst messages = ref([])\nconst inputMessage = ref('')\nconst isTyping = ref(false)\nconst currentModel = ref('glm-4-plus')\nconst messagesContainer = ref(null)\nconst useRag = ref(true)\nconst useWebSearch = ref(false)\nconst selectedPapers = ref([])\nconst uploadedFiles = ref([])  // 已上传文件列表\nconst isUploading = ref(false)  // 上传中状态\n\n// 论文选择\nconst showPaperSelector = ref(false)\nconst paperSearch = ref('')\nconst papers = ref([])\nconst tempSelectedPapers = ref([])\nconst paperTable = ref(null)\n\n// 设置\nconst showSettings = ref(false)\nconst settings = ref({\n  model: 'glm-4-plus',\n  temperature: 0.7,\n  maxTokens: 4000,\n  useRag: true,\n  autoReference: true\n})\n\n// 重命名\nconst showRenameDialog = ref(false)\nconst renameValue = ref('')\nconst renameChatId = ref(null)\n\n// ==================== 计算属性 ====================\nconst userAvatar = computed(() => store.getters.currentUser?.avatar || '')\nconst userInitial = computed(() => {\n  const name = store.getters.currentUser?.full_name || store.getters.currentUser?.username || 'U'\n  return name.charAt(0).toUpperCase()\n})\n\nconst currentChatTitle = computed(() => {\n  const chat = chatHistory.value.find(c => c.chat_id === currentChatId.value)\n  return chat?.preview || '新对话'\n})\n\nconst canSend = computed(() => {\n  return inputMessage.value.trim().length > 0 && !isTyping.value\n})\n\nconst inputRows = computed(() => {\n  const lines = inputMessage.value.split('\\n').length\n  return Math.min(Math.max(lines, 1), 5)\n})\n\nconst filteredPapers = computed(() => {\n  if (!paperSearch.value) return papers.value\n  const query = paperSearch.value.toLowerCase()\n  return papers.value.filter(p =>\n    (p.title || '').toLowerCase().includes(query) ||\n    (p.abstract || '').toLowerCase().includes(query)\n  )\n})\n\n// ==================== 快捷功能卡片 ====================\nconst quickCards = [\n  { key: 'summary', label: '文献综述', icon: 'Document', prompt: '请基于我的论文库生成一份文献综述' },\n  { key: 'gaps', label: '研究空白', icon: 'Search', prompt: '请分析当前研究领域的主要空白' },\n  { key: 'code', label: '代码生成', icon: 'Cpu', prompt: '请帮我生成实现XX算法的代码' },\n  { key: 'trends', label: '趋势分析', icon: 'TrendCharts', prompt: '请分析该领域的研究趋势' },\n]\n\nconst exampleQuestions = [\n  '帮我总结这几篇论文的核心贡献',\n  '这些论文中使用了哪些主要方法？',\n  '这个领域的研究现状如何？',\n  '有哪些潜在的研究方向值得探索？',\n  '帮我比较论文A和论文B的方法差异',\n  '请解释论文中的XX算法原理'\n]\n\n// ==================== 方法 ====================\nconst formatTime = (timestamp) => {\n  if (!timestamp) return ''\n  const date = new Date(timestamp)\n  return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\n}\n\nconst renderMessage = (content) => {\n  if (!content) return ''\n  const html = marked(content)\n  return DOMPurify.sanitize(html)\n}\n\nconst scrollToBottom = () => {\n  nextTick(() => {\n    if (messagesContainer.value) {\n      messagesContainer.value.scrollTop = messagesContainer.value.scrollHeight\n    }\n  })\n}\n\n// ==================== 聊天操作 ====================\nconst loadChatHistory = async () => {\n  try {\n    // 这里可以调用后端 API 获取会话列表\n    // 目前使用本地存储\n    const saved = localStorage.getItem('kimi_chat_history')\n    if (saved) {\n      chatHistory.value = JSON.parse(saved)\n    }\n  } catch (e) {\n    console.error('加载聊天历史失败:', e)\n  }\n}\n\nconst saveChatHistory = () => {\n  try {\n    localStorage.setItem('kimi_chat_history', JSON.stringify(chatHistory.value))\n  } catch (e) {\n    console.error('保存聊天历史失败:', e)\n  }\n}\n\nconst createNewChat = () => {\n  const newChatId = `chat_${Date.now()}`\n  currentChatId.value = newChatId\n  messages.value = []\n  selectedPapers.value = []\n\n  // 添加到历史\n  chatHistory.value.unshift({\n    chat_id: newChatId,\n    preview: '新对话',\n    created_at: new Date().toISOString(),\n    message_count: 0\n  })\n\n  saveChatHistory()\n}\n\nconst switchChat = async (chatId) => {\n  if (currentChatId.value === chatId) return\n\n  currentChatId.value = chatId\n\n  // 加载该会话的消息历史\n  try {\n    const response = await api.getChatHistory(chatId)\n    if (response.success) {\n      messages.value = response.data || []\n    }\n  } catch (e) {\n    console.error('加载消息历史失败:', e)\n    messages.value = []\n  }\n\n  scrollToBottom()\n}\n\nconst renameChat = (chatId) => {\n  renameChatId.value = chatId\n  renameValue.value = ''\n  showRenameDialog.value = true\n}\n\nconst confirmRename = () => {\n  if (!renameValue.value.trim()) {\n    ElMessage.warning('请输入新名称')\n    return\n  }\n\n  const chat = chatHistory.value.find(c => c.chat_id === renameChatId.value)\n  if (chat) {\n    chat.preview = renameValue.value\n    saveChatHistory()\n    ElMessage.success('重命名成功')\n  }\n\n  showRenameDialog.value = false\n}\n\nconst deleteChat = async (chatId) => {\n  try {\n    await ElMessageBox.confirm('确定要删除这个对话吗？', '提示', {\n      confirmButtonText: '确定',\n      cancelButtonText: '取消',\n      type: 'warning'\n    })\n\n    // 调用后端 API 删除\n    await api.deleteChat({ chatId })\n\n    // 从列表中移除\n    chatHistory.value = chatHistory.value.filter(c => c.chat_id !== chatId)\n\n    // 如果删除的是当前会话，切换到第一个或新建\n    if (currentChatId.value === chatId) {\n      if (chatHistory.value.length > 0) {\n        switchChat(chatHistory.value[0].chat_id)\n      } else {\n        createNewChat()\n      }\n    }\n\n    saveChatHistory()\n    ElMessage.success('删除成功')\n  } catch (e) {\n    if (e !== 'cancel') {\n      console.error('删除失败:', e)\n    }\n  }\n}\n\nconst clearCurrentChat = async () => {\n  if (messages.value.length === 0) return\n\n  try {\n    await ElMessageBox.confirm('确定要清空当前对话吗？', '提示', {\n      confirmButtonText: '确定',\n      cancelButtonText: '取消',\n      type: 'warning'\n    })\n\n    await api.clearChat({ chatId: currentChatId.value })\n    messages.value = []\n\n    // 更新预览\n    const chat = chatHistory.value.find(c => c.chat_id === currentChatId.value)\n    if (chat) {\n      chat.preview = '新对话'\n      chat.message_count = 0\n      saveChatHistory()\n    }\n\n    ElMessage.success('已清空')\n  } catch (e) {\n    if (e !== 'cancel') {\n      console.error('清空失败:', e)\n    }\n  }\n}\n\n// ==================== 消息发送 ====================\nconst handleEnter = (e) => {\n  if (e.shiftKey) {\n    // Shift+Enter 换行\n    return\n  }\n  e.preventDefault()\n  sendMessage()\n}\n\nconst handleInput = () => {\n  // 可以在这里实现输入提示等功能\n}\n\nconst sendQuickMessage = (prompt) => {\n  inputMessage.value = prompt\n  sendMessage()\n}\n\nconst sendMessage = async (content = null) => {\n  const message = content || inputMessage.value.trim()\n  if (!message || isTyping.value) return\n\n  // 清空输入框\n  if (!content) {\n    inputMessage.value = ''\n  }\n\n  // 添加用户消息\n  messages.value.push({\n    role: 'user',\n    content: message,\n    timestamp: new Date().toISOString(),\n    references: []\n  })\n\n  scrollToBottom()\n  isTyping.value = true\n\n  try {\n    // 准备上传的文件内容\n    const filesData = uploadedFiles.value.map(file => ({\n      filename: file.name,\n      content: file.content,\n      content_type: file.content_type,\n      size: file.size\n    }))\n\n    // 调用流式 API\n    const response = await fetch('/api/chat/stream', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\n      },\n      body: JSON.stringify({\n        message,\n        chatId: currentChatId.value,\n        papers: selectedPapers.value.map(p => p.id),\n        model: currentModel.value,\n        temperature: settings.value.temperature,\n        useRag: useRag.value,\n        useWebSearch: useWebSearch.value,\n        files: filesData.length > 0 ? filesData : undefined\n      })\n    })\n\n    const reader = response.body.getReader()\n    const decoder = new TextDecoder()\n    let fullContent = ''\n\n    // 添加 AI 消息占位\n    messages.value.push({\n      role: 'assistant',\n      content: '',\n      timestamp: new Date().toISOString(),\n      references: []\n    })\n\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      const { done, value } = await reader.read()\n      if (done) break\n\n      const chunk = decoder.decode(value)\n      const lines = chunk.split('\\n\\n')\n\n      for (const line of lines) {\n        if (line.startsWith('data: ')) {\n          try {\n            const data = JSON.parse(line.slice(6))\n\n            if (data.done) {\n              isTyping.value = false\n            } else if (data.content) {\n              fullContent += data.content\n              messages.value[messages.value.length - 1].content = fullContent\n              scrollToBottom()\n            }\n          } catch (e) {\n            console.error('解析 SSE 数据失败:', e)\n          }\n        }\n      }\n    }\n\n    // 更新会话预览\n    const chat = chatHistory.value.find(c => c.chat_id === currentChatId.value)\n    if (chat) {\n      chat.preview = message.slice(0, 30) + (message.length > 30 ? '...' : '')\n      chat.message_count = messages.value.length\n      saveChatHistory()\n    }\n\n  } catch (error) {\n    console.error('发送消息失败:', error)\n    ElMessage.error('发送失败，请重试')\n    isTyping.value = false\n  }\n}\n\n// ==================== 论文选择 ====================\nconst loadPapers = async () => {\n  try {\n    const response = await api.getPapersList({ limit: 1000 })\n    if (response.success) {\n      papers.value = response.data.items || []\n      console.log(`[DEBUG] 加载了 ${papers.value.length} 篇论文`)\n    } else {\n      console.error('[ERROR] 加载论文失败:', response.error)\n      papers.value = []\n    }\n  } catch (error) {\n    console.error('[ERROR] 加载论文失败:', error)\n    papers.value = []\n  }\n}\n\nconst handlePaperSelectionChange = (selection) => {\n  tempSelectedPapers.value = selection\n}\n\nconst confirmPaperSelection = () => {\n  selectedPapers.value = [...tempSelectedPapers.value]\n  showPaperSelector.value = false\n  \n  // 将关联论文保存到当前会话上下文\n  const chat = chatHistory.value.find(c => c.chat_id === currentChatId.value)\n  if (chat) {\n    chat.connected_papers = selectedPapers.value.map(p => p.id)\n    saveChatHistory()\n  }\n  \n  ElMessage.success(`已关联 ${selectedPapers.value.length} 篇论文，RAG将优先检索这些论文`)\n}\n\nconst viewPaper = (paperId) => {\n  window.open(`#/papers/${paperId}`, '_blank')\n}\n\n// ==================== 设置 ====================\nconst saveSettings = () => {\n  localStorage.setItem('kimi_chat_settings', JSON.stringify(settings.value))\n  showSettings.value = false\n  ElMessage.success('设置已保存')\n}\n\nconst loadSettings = () => {\n  try {\n    const saved = localStorage.getItem('kimi_chat_settings')\n    if (saved) {\n      settings.value = { ...settings.value, ...JSON.parse(saved) }\n    }\n  } catch (e) {\n    console.error('加载设置失败:', e)\n  }\n}\n\n// ==================== 文件上传 ====================\nconst handleUpload = () => {\n  // 创建隐藏的文件输入\n  const input = document.createElement('input')\n  input.type = 'file'\n  input.accept = '.txt,.pdf,.doc,.docx,.md,.py,.js,.json,.java,.c,.cpp,.html,.css'\n  input.multiple = true\n  input.style.display = 'none'\n  input.onchange = (e) => {\n    handleFileSelect(e)\n    // 清理创建的input元素\n    document.body.removeChild(input)\n  }\n  document.body.appendChild(input)\n  input.click()\n}\n\nconst handleFileSelect = async (event) => {\n  const files = event.target.files\n  if (!files || files.length === 0) return\n  \n  isUploading.value = true\n  \n  for (const file of files) {\n    // 检查文件大小 (10MB)\n    if (file.size > 10 * 1024 * 1024) {\n      ElMessage.warning(`${file.name} 超过 10MB，已跳过`)\n      continue\n    }\n    \n    try {\n      const formData = new FormData()\n      formData.append('file', file)\n      \n      ElMessage.info(`正在上传 ${file.name}...`)\n      \n      const response = await fetch('/api/chat/upload', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: formData\n      })\n      \n      const result = await response.json()\n      \n      if (result.success) {\n        uploadedFiles.value.push({\n          name: result.data.filename,\n          hash: result.data.file_hash,\n          content: result.data.content,\n          content_type: result.data.content_type,\n          size: result.data.size\n        })\n        ElMessage.success(`${file.name} 上传成功`)\n      } else {\n        ElMessage.error(`${file.name} 上传失败: ${result.error || '未知错误'}`)\n      }\n    } catch (error) {\n      console.error('上传错误:', error)\n      ElMessage.error(`${file.name} 上传失败: ${error.message || '网络错误'}`)\n    }\n  }\n  \n  isUploading.value = false\n}\n\nconst removeFile = (index) => {\n  uploadedFiles.value.splice(index, 1)\n}\n\n// 监听论文选择对话框打开\nwatch(showPaperSelector, async (newVal) => {\n  if (newVal) {\n    // 对话框打开时加载论文列表\n    await loadPapers()\n    \n    // 初始化已选择的论文\n    await nextTick()\n    if (paperTable.value && selectedPapers.value.length > 0) {\n      // 清空当前选择\n      paperTable.value.clearSelection()\n      \n      // 重新选中已关联的论文\n      selectedPapers.value.forEach(paper => {\n        const row = papers.value.find(p => p.id === paper.id)\n        if (row) {\n          paperTable.value.toggleRowSelection(row, true)\n        }\n      })\n    }\n    \n    // 同步tempSelectedPapers\n    tempSelectedPapers.value = [...selectedPapers.value]\n  }\n})\n\n// ==================== 生命周期 ====================\nonMounted(() => {\n  loadChatHistory()\n  loadPapers()\n  loadSettings()\n\n  // 如果没有会话，创建一个新的\n  if (chatHistory.value.length === 0) {\n    createNewChat()\n  } else {\n    // 切换到第一个会话\n    switchChat(chatHistory.value[0].chat_id)\n  }\n  \n  // 检查上传按钮可用性\n  console.log('[DEBUG] KimiChat 已挂载，上传功能已就绪')\n})\n</script>\n\n<style scoped>\n.kimi-chat-container {\n  display: flex;\n  height: calc(100vh - 64px);\n  background: #f9fafb;\n}\n\n/* ==================== 侧边栏 ==================== */\n.sidebar {\n  width: 260px;\n  background: #ffffff;\n  border-right: 1px solid #e5e7eb;\n  display: flex;\n  flex-direction: column;\n  transition: width 0.3s ease;\n}\n\n.sidebar.collapsed {\n  width: 60px;\n}\n\n.sidebar-header {\n  padding: 16px;\n  display: flex;\n  gap: 8px;\n  border-bottom: 1px solid #e5e7eb;\n}\n\n.new-chat-btn {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  padding: 10px 16px;\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  color: white;\n  border: none;\n  border-radius: 10px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.new-chat-btn:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);\n}\n\n.collapse-btn {\n  width: 36px;\n  height: 36px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: #f3f4f6;\n  border: none;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.collapse-btn:hover {\n  background: #e5e7eb;\n}\n\n.sidebar.collapsed .new-chat-btn span {\n  display: none;\n}\n\n/* 对话历史 */\n.chat-history {\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n}\n\n.chat-item {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 10px 12px;\n  border-radius: 8px;\n  cursor: pointer;\n  margin-bottom: 4px;\n  transition: all 0.2s;\n  position: relative;\n}\n\n.chat-item:hover {\n  background: #f3f4f6;\n}\n\n.chat-item.active {\n  background: #d1fae5;\n}\n\n.chat-item.active .chat-title {\n  color: #059669;\n  font-weight: 500;\n}\n\n.chat-icon {\n  font-size: 16px;\n  color: #6b7280;\n  flex-shrink: 0;\n}\n\n.chat-item.active .chat-icon {\n  color: #059669;\n}\n\n.chat-title {\n  flex: 1;\n  font-size: 14px;\n  color: #374151;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.chat-actions {\n  opacity: 0;\n  transition: opacity 0.2s;\n}\n\n.chat-item:hover .chat-actions {\n  opacity: 1;\n}\n\n.more-icon {\n  padding: 4px;\n  border-radius: 4px;\n  color: #6b7280;\n  cursor: pointer;\n}\n\n.more-icon:hover {\n  background: #e5e7eb;\n  color: #374151;\n}\n\n.sidebar.collapsed .chat-title,\n.sidebar.collapsed .chat-actions {\n  display: none;\n}\n\n/* 侧边栏底部 */\n.sidebar-footer {\n  padding: 12px 16px;\n  border-top: 1px solid #e5e7eb;\n}\n\n.footer-btn {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 10px 12px;\n  background: transparent;\n  border: none;\n  border-radius: 8px;\n  color: #6b7280;\n  font-size: 14px;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.footer-btn:hover {\n  background: #f3f4f6;\n  color: #374151;\n}\n\n.sidebar.collapsed .footer-btn span {\n  display: none;\n}\n\n/* ==================== 主聊天区域 ==================== */\n.chat-main {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n\n/* 顶部导航 */\n.chat-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 24px;\n  background: #ffffff;\n  border-bottom: 1px solid #e5e7eb;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.chat-title {\n  font-size: 16px;\n  font-weight: 600;\n  color: #111827;\n  margin: 0;\n}\n\n.header-right {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.model-select {\n  width: 140px;\n}\n\n/* 消息区域 */\n.messages-area {\n  flex: 1;\n  overflow-y: auto;\n  padding: 24px;\n}\n\n/* 欢迎页面 */\n.welcome-section {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: 100%;\n  text-align: center;\n  padding: 40px 20px;\n}\n\n.welcome-logo {\n  margin-bottom: 24px;\n  animation: float 3s ease-in-out infinite;\n}\n\n@keyframes float {\n  0%, 100% { transform: translateY(0); }\n  50% { transform: translateY(-10px); }\n}\n\n.welcome-title {\n  font-size: 32px;\n  font-weight: 700;\n  color: #111827;\n  margin-bottom: 12px;\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n}\n\n.welcome-subtitle {\n  font-size: 16px;\n  color: #6b7280;\n  max-width: 500px;\n  margin-bottom: 40px;\n}\n\n/* 快捷卡片 */\n.quick-cards {\n  display: grid;\n  grid-template-columns: repeat(4, 1fr);\n  gap: 16px;\n  max-width: 600px;\n  margin-bottom: 48px;\n}\n\n.quick-card {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 10px;\n  padding: 20px 16px;\n  background: #ffffff;\n  border: 1px solid #e5e7eb;\n  border-radius: 12px;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.quick-card:hover {\n  border-color: #10b981;\n  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);\n  transform: translateY(-2px);\n}\n\n.quick-card span {\n  font-size: 14px;\n  color: #374151;\n  font-weight: 500;\n}\n\n.quick-card:hover span {\n  color: #059669;\n}\n\n/* 示例问题 */\n.example-questions {\n  max-width: 600px;\n}\n\n.section-title {\n  font-size: 14px;\n  color: #9ca3af;\n  margin-bottom: 16px;\n}\n\n.question-tags {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 10px;\n  justify-content: center;\n}\n\n.question-tag {\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.question-tag:hover {\n  background: #d1fae5;\n  border-color: #10b981;\n  color: #059669;\n}\n\n/* 消息样式 */\n.message-wrapper {\n  display: flex;\n  gap: 12px;\n  margin-bottom: 24px;\n  max-width: 90%;\n}\n\n.message-wrapper.user-message {\n  margin-left: auto;\n  flex-direction: row-reverse;\n}\n\n.message-wrapper.ai-message {\n  margin-right: auto;\n}\n\n.message-avatar {\n  flex-shrink: 0;\n}\n\n.ai-avatar {\n  width: 36px;\n  height: 36px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  border-radius: 50%;\n  color: white;\n}\n\n.message-content {\n  flex: 1;\n  min-width: 0;\n}\n\n.message-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 6px;\n}\n\n.user-message .message-header {\n  justify-content: flex-end;\n}\n\n.message-role {\n  font-size: 13px;\n  font-weight: 600;\n  color: #374151;\n}\n\n.message-time {\n  font-size: 12px;\n  color: #9ca3af;\n}\n\n.message-body {\n  padding: 14px 18px;\n  border-radius: 12px;\n  font-size: 15px;\n  line-height: 1.7;\n  color: #374151;\n}\n\n.user-message .message-body {\n  background: #10b981;\n  color: white;\n  border-bottom-right-radius: 4px;\n}\n\n.ai-message .message-body {\n  background: #ffffff;\n  border: 1px solid #e5e7eb;\n  border-bottom-left-radius: 4px;\n}\n\n.ai-message .message-body :deep(p) {\n  margin: 0 0 12px 0;\n}\n\n.ai-message .message-body :deep(p:last-child) {\n  margin-bottom: 0;\n}\n\n.ai-message .message-body :deep(pre) {\n  background: #1f2937;\n  border-radius: 8px;\n  padding: 16px;\n  overflow-x: auto;\n  margin: 12px 0;\n}\n\n.ai-message .message-body :deep(code) {\n  font-family: 'Menlo', 'Monaco', 'Courier New', monospace;\n  font-size: 13px;\n}\n\n.ai-message .message-body :deep(:not(pre) > code) {\n  background: #f3f4f6;\n  padding: 2px 6px;\n  border-radius: 4px;\n  color: #ec4899;\n}\n\n.ai-message .message-body :deep(ul), .ai-message .message-body :deep(ol) {\n  padding-left: 20px;\n  margin: 12px 0;\n}\n\n.ai-message .message-body :deep(li) {\n  margin: 6px 0;\n}\n\n.ai-message .message-body :deep(h1), .ai-message .message-body :deep(h2), .ai-message .message-body :deep(h3) {\n  margin: 20px 0 12px 0;\n  color: #111827;\n}\n\n.ai-message .message-body :deep(blockquote) {\n  border-left: 4px solid #10b981;\n  margin: 12px 0;\n  padding: 8px 16px;\n  background: #f0fdf4;\n  border-radius: 0 8px 8px 0;\n}\n\n/* 引用文献 */\n.message-references {\n  margin-top: 12px;\n  padding-top: 12px;\n  border-top: 1px dashed #e5e7eb;\n}\n\n.ref-title {\n  font-size: 12px;\n  color: #9ca3af;\n  margin-bottom: 8px;\n}\n\n.ref-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n\n.ref-tag {\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.ref-tag:hover {\n  background: #d1fae5;\n  border-color: #10b981;\n  color: #059669;\n}\n\n/* 正在输入动画 */\n.typing-indicator {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 16px 18px;\n  background: #ffffff;\n  border: 1px solid #e5e7eb;\n  border-radius: 12px;\n  border-bottom-left-radius: 4px;\n}\n\n.typing-indicator span {\n  width: 8px;\n  height: 8px;\n  background: #10b981;\n  border-radius: 50%;\n  animation: typing 1.4s infinite ease-in-out both;\n}\n\n.typing-indicator span:nth-child(1) {\n  animation-delay: -0.32s;\n}\n\n.typing-indicator span:nth-child(2) {\n  animation-delay: -0.16s;\n}\n\n@keyframes typing {\n  0%, 80%, 100% {\n    transform: scale(0);\n    opacity: 0.5;\n  }\n  40% {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n\n/* ==================== 输入区域 ==================== */\n.input-area {\n  background: #ffffff;\n  border-top: 1px solid #e5e7eb;\n  padding: 16px 24px;\n}\n\n.input-toolbar {\n  display: flex;\n  gap: 8px;\n  margin-bottom: 10px;\n}\n\n.tool-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 8px 12px;\n  background: #f9fafb;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  color: #6b7280;\n  font-size: 13px;\n  cursor: pointer;\n  transition: all 0.2s;\n  position: relative;\n}\n\n.tool-btn:hover {\n  background: #f3f4f6;\n  color: #374151;\n}\n\n.tool-btn.active {\n  background: #d1fae5;\n  border-color: #10b981;\n  color: #059669;\n}\n\n.tool-btn .badge {\n  position: absolute;\n  top: -6px;\n  right: -6px;\n  width: 18px;\n  height: 18px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: #ef4444;\n  color: white;\n  font-size: 11px;\n  border-radius: 50%;\n}\n\n.input-box {\n  display: flex;\n  gap: 12px;\n  align-items: flex-end;\n  background: #f9fafb;\n  border: 1px solid #e5e7eb;\n  border-radius: 12px;\n  padding: 12px 16px;\n  transition: all 0.2s;\n}\n\n.input-box:focus-within {\n  background: #ffffff;\n  border-color: #10b981;\n  box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);\n}\n\n.input-box :deep(.el-textarea__inner) {\n  background: transparent;\n  border: none;\n  padding: 0;\n  font-size: 15px;\n  resize: none;\n  box-shadow: none;\n}\n\n.input-box :deep(.el-textarea__inner:focus) {\n  box-shadow: none;\n}\n\n.send-btn {\n  width: 36px;\n  height: 36px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  border: none;\n  border-radius: 10px;\n  color: white;\n  cursor: pointer;\n  transition: all 0.2s;\n  flex-shrink: 0;\n}\n\n.send-btn:hover:not(:disabled) {\n  transform: scale(1.05);\n  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);\n}\n\n.send-btn:disabled {\n  background: #d1d5db;\n  cursor: not-allowed;\n}\n\n.send-btn .loading {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n.input-hint {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 8px;\n  font-size: 12px;\n  color: #9ca3af;\n}\n\n/* ==================== 对话框样式 ==================== */\n.dialog-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.paper-selector {\n  max-height: 500px;\n}\n\n.paper-search {\n  margin-bottom: 16px;\n}\n\n.slider-hint {\n  font-size: 12px;\n  color: #9ca3af;\n  margin-top: 4px;\n}\n\n/* 下拉菜单危险项 */\n:deep(.el-dropdown-menu__item.danger) {\n  color: #ef4444;\n}\n\n:deep(.el-dropdown-menu__item.danger:hover) {\n  background: #fef2f2;\n  color: #dc2626;\n}\n\n/* 响应式 */\n@media (max-width: 768px) {\n  .sidebar {\n    position: absolute;\n    z-index: 100;\n    height: 100%;\n  }\n\n  .sidebar.collapsed {\n    transform: translateX(-100%);\n  }\n\n  .quick-cards {\n    grid-template-columns: repeat(2, 1fr);\n  }\n\n  .message-wrapper {\n    max-width: 100%;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}