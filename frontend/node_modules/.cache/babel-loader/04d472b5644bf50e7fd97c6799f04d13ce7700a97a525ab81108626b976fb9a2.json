{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { onMounted, onBeforeUnmount } from 'vue';\nimport { isClient } from '@vueuse/core';\nimport { getEventCode } from '../../utils/dom/event.mjs';\nimport { EVENT_CODE } from '../../constants/aria.mjs';\nlet registeredEscapeHandlers = [];\nconst cachedHandler = event => {\n  const code = getEventCode(event);\n  if (code === EVENT_CODE.esc) {\n    registeredEscapeHandlers.forEach(registeredHandler => registeredHandler(event));\n  }\n};\nconst useEscapeKeydown = handler => {\n  onMounted(() => {\n    if (registeredEscapeHandlers.length === 0) {\n      document.addEventListener(\"keydown\", cachedHandler);\n    }\n    if (isClient) registeredEscapeHandlers.push(handler);\n  });\n  onBeforeUnmount(() => {\n    registeredEscapeHandlers = registeredEscapeHandlers.filter(registeredHandler => registeredHandler !== handler);\n    if (registeredEscapeHandlers.length === 0) {\n      if (isClient) document.removeEventListener(\"keydown\", cachedHandler);\n    }\n  });\n};\nexport { useEscapeKeydown };","map":{"version":3,"names":["registeredEscapeHandlers","cachedHandler","event","code","getEventCode","EVENT_CODE","esc","forEach","registeredHandler","useEscapeKeydown","handler","onMounted","length","document","addEventListener","isClient","push","onBeforeUnmount","filter","removeEventListener"],"sources":["../../../../../packages/hooks/use-escape-keydown/index.ts"],"sourcesContent":["import { onBeforeUnmount, onMounted } from 'vue'\nimport { getEventCode, isClient } from '@element-plus/utils'\nimport { EVENT_CODE } from '@element-plus/constants'\n\nlet registeredEscapeHandlers: ((e: KeyboardEvent) => void)[] = []\n\nconst cachedHandler = (event: KeyboardEvent) => {\n  const code = getEventCode(event)\n  if (code === EVENT_CODE.esc) {\n    registeredEscapeHandlers.forEach((registeredHandler) =>\n      registeredHandler(event)\n    )\n  }\n}\n\nexport const useEscapeKeydown = (handler: (e: KeyboardEvent) => void) => {\n  onMounted(() => {\n    if (registeredEscapeHandlers.length === 0) {\n      document.addEventListener('keydown', cachedHandler)\n    }\n    if (isClient) registeredEscapeHandlers.push(handler)\n  })\n\n  onBeforeUnmount(() => {\n    registeredEscapeHandlers = registeredEscapeHandlers.filter(\n      (registeredHandler) => registeredHandler !== handler\n    )\n    if (registeredEscapeHandlers.length === 0) {\n      if (isClient) document.removeEventListener('keydown', cachedHandler)\n    }\n  })\n}\n"],"mappings":";;;;;;;;AAIA,IAAIA,wBAAA,GAA2D,EAAC;AAEhE,MAAMC,aAAA,GAAiBC,KAAyB;EACxC,MAAAC,IAAA,GAAOC,YAAA,CAAaF,KAAK;EAC3B,IAAAC,IAAA,KAASE,UAAA,CAAWC,GAAK;IACFN,wBAAA,CAAAO,OAAA,CAASC,iBAChC,IAAAA,iBAAA,CAAkBN,KAAK,EACzB;EAAA;AAEJ;AAEa,MAAAO,gBAAA,GAAoBC,OAAwC;EACvEC,SAAA,CAAU,MAAM;IACV,IAAAX,wBAAA,CAAyBY,MAAA,KAAW,CAAG;MAChCC,QAAA,CAAAC,gBAAA,CAAiB,WAAWb,aAAa;IAAA;IAEhD,IAAAc,QAAA,EAAUf,wBAAA,CAAyBgB,IAAA,CAAKN,OAAO;EAAA,CACpD;EAEDO,eAAA,CAAgB,MAAM;IACpBjB,wBAAA,GAA2BA,wBAAyB,CAAAkB,MAAA,CACjDV,iBAAA,IAAsBA,iBAAsB,KAAAE,OAAA,CAC/C;IACI,IAAAV,wBAAA,CAAyBY,MAAA,KAAW,CAAG;MACrC,IAAAG,QAAA,EAAmBF,QAAA,CAAAM,mBAAA,CAAoB,WAAWlB,aAAa;IAAA;EACrE,CACD;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}