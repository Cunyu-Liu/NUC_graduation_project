{"ast":null,"code":"import { ref, onMounted, watchEffect, onBeforeUnmount } from 'vue';\nimport { addUnit } from '../../utils/dom/style.mjs';\nconst useDraggable = (targetRef, dragRef, draggable, overflow) => {\n  const transform = {\n    offsetX: 0,\n    offsetY: 0\n  };\n  const isDragging = ref(false);\n  const adjustPosition = (moveX, moveY) => {\n    if (targetRef.value) {\n      const {\n        offsetX,\n        offsetY\n      } = transform;\n      const targetRect = targetRef.value.getBoundingClientRect();\n      const targetLeft = targetRect.left;\n      const targetTop = targetRect.top;\n      const targetWidth = targetRect.width;\n      const targetHeight = targetRect.height;\n      const clientWidth = document.documentElement.clientWidth;\n      const clientHeight = document.documentElement.clientHeight;\n      const minLeft = -targetLeft + offsetX;\n      const minTop = -targetTop + offsetY;\n      const maxLeft = clientWidth - targetLeft - targetWidth + offsetX;\n      const maxTop = clientHeight - targetTop - (targetHeight < clientHeight ? targetHeight : 0) + offsetY;\n      if (!(overflow == null ? void 0 : overflow.value)) {\n        moveX = Math.min(Math.max(moveX, minLeft), maxLeft);\n        moveY = Math.min(Math.max(moveY, minTop), maxTop);\n      }\n      transform.offsetX = moveX;\n      transform.offsetY = moveY;\n      targetRef.value.style.transform = `translate(${addUnit(moveX)}, ${addUnit(moveY)})`;\n    }\n  };\n  const onMousedown = e => {\n    const downX = e.clientX;\n    const downY = e.clientY;\n    const {\n      offsetX,\n      offsetY\n    } = transform;\n    const onMousemove = e2 => {\n      if (!isDragging.value) {\n        isDragging.value = true;\n      }\n      const moveX = offsetX + e2.clientX - downX;\n      const moveY = offsetY + e2.clientY - downY;\n      adjustPosition(moveX, moveY);\n    };\n    const onMouseup = () => {\n      isDragging.value = false;\n      document.removeEventListener(\"mousemove\", onMousemove);\n      document.removeEventListener(\"mouseup\", onMouseup);\n    };\n    document.addEventListener(\"mousemove\", onMousemove);\n    document.addEventListener(\"mouseup\", onMouseup);\n  };\n  const onDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.addEventListener(\"mousedown\", onMousedown);\n      window.addEventListener(\"resize\", updatePosition);\n    }\n  };\n  const offDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.removeEventListener(\"mousedown\", onMousedown);\n      window.removeEventListener(\"resize\", updatePosition);\n    }\n  };\n  const resetPosition = () => {\n    transform.offsetX = 0;\n    transform.offsetY = 0;\n    if (targetRef.value) {\n      targetRef.value.style.transform = \"\";\n    }\n  };\n  const updatePosition = () => {\n    const {\n      offsetX,\n      offsetY\n    } = transform;\n    adjustPosition(offsetX, offsetY);\n  };\n  onMounted(() => {\n    watchEffect(() => {\n      if (draggable.value) {\n        onDraggable();\n      } else {\n        offDraggable();\n      }\n    });\n  });\n  onBeforeUnmount(() => {\n    offDraggable();\n  });\n  return {\n    isDragging,\n    resetPosition,\n    updatePosition\n  };\n};\nexport { useDraggable };","map":{"version":3,"names":["useDraggable","targetRef","dragRef","draggable","overflow","transform","offsetX","offsetY","isDragging","ref","adjustPosition","moveX","moveY","value","targetRect","getBoundingClientRect","targetLeft","left","targetTop","top","targetWidth","width","targetHeight","height","clientWidth","document","documentElement","clientHeight","minLeft","minTop","maxLeft","maxTop","Math","min","max","style","addUnit","onMousedown","e","downX","clientX","downY","clientY","onMousemove","e2","onMouseup","removeEventListener","addEventListener","onDraggable","window","updatePosition","offDraggable","resetPosition","onMounted","watchEffect","onBeforeUnmount"],"sources":["../../../../../packages/hooks/use-draggable/index.ts"],"sourcesContent":["import { onBeforeUnmount, onMounted, ref, watchEffect } from 'vue'\nimport { addUnit } from '@element-plus/utils'\n\nimport type { ComputedRef, Ref } from 'vue'\n\nexport const useDraggable = (\n  targetRef: Ref<HTMLElement | undefined>,\n  dragRef: Ref<HTMLElement | undefined>,\n  draggable: ComputedRef<boolean>,\n  overflow?: ComputedRef<boolean>\n) => {\n  const transform = {\n    offsetX: 0,\n    offsetY: 0,\n  }\n\n  const isDragging = ref(false)\n\n  const adjustPosition = (moveX: number, moveY: number) => {\n    if (targetRef.value) {\n      const { offsetX, offsetY } = transform\n      const targetRect = targetRef.value.getBoundingClientRect()\n      const targetLeft = targetRect.left\n      const targetTop = targetRect.top\n      const targetWidth = targetRect.width\n      const targetHeight = targetRect.height\n\n      const clientWidth = document.documentElement.clientWidth\n      const clientHeight = document.documentElement.clientHeight\n\n      const minLeft = -targetLeft + offsetX\n      const minTop = -targetTop + offsetY\n      const maxLeft = clientWidth - targetLeft - targetWidth + offsetX\n      const maxTop =\n        clientHeight -\n        targetTop -\n        (targetHeight < clientHeight ? targetHeight : 0) +\n        offsetY\n\n      if (!overflow?.value) {\n        moveX = Math.min(Math.max(moveX, minLeft), maxLeft)\n        moveY = Math.min(Math.max(moveY, minTop), maxTop)\n      }\n\n      transform.offsetX = moveX\n      transform.offsetY = moveY\n\n      targetRef.value.style.transform = `translate(${addUnit(moveX)}, ${addUnit(\n        moveY\n      )})`\n    }\n  }\n\n  const onMousedown = (e: MouseEvent) => {\n    const downX = e.clientX\n    const downY = e.clientY\n    const { offsetX, offsetY } = transform\n\n    const onMousemove = (e: MouseEvent) => {\n      if (!isDragging.value) {\n        isDragging.value = true\n      }\n      const moveX = offsetX + e.clientX - downX\n      const moveY = offsetY + e.clientY - downY\n\n      adjustPosition(moveX, moveY)\n    }\n\n    const onMouseup = () => {\n      isDragging.value = false\n      document.removeEventListener('mousemove', onMousemove)\n      document.removeEventListener('mouseup', onMouseup)\n    }\n\n    document.addEventListener('mousemove', onMousemove)\n    document.addEventListener('mouseup', onMouseup)\n  }\n\n  const onDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.addEventListener('mousedown', onMousedown)\n      window.addEventListener('resize', updatePosition)\n    }\n  }\n\n  const offDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.removeEventListener('mousedown', onMousedown)\n      window.removeEventListener('resize', updatePosition)\n    }\n  }\n\n  const resetPosition = () => {\n    transform.offsetX = 0\n    transform.offsetY = 0\n\n    if (targetRef.value) {\n      targetRef.value.style.transform = ''\n    }\n  }\n\n  const updatePosition = () => {\n    const { offsetX, offsetY } = transform\n\n    adjustPosition(offsetX, offsetY)\n  }\n\n  onMounted(() => {\n    watchEffect(() => {\n      if (draggable.value) {\n        onDraggable()\n      } else {\n        offDraggable()\n      }\n    })\n  })\n\n  onBeforeUnmount(() => {\n    offDraggable()\n  })\n\n  return {\n    isDragging,\n    resetPosition,\n    updatePosition,\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}