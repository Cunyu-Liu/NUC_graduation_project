{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { computed, ref, watch, onBeforeUnmount } from 'vue';\nimport { useWindowSize, clamp, useEventListener } from '@vueuse/core';\nimport { addUnit } from '../../../../utils/dom/style.mjs';\nfunction useResizable(props, target, emit) {\n  const {\n    width,\n    height\n  } = useWindowSize();\n  const isHorizontal = computed(() => [\"ltr\", \"rtl\"].includes(props.direction));\n  const sign = computed(() => [\"ltr\", \"ttb\"].includes(props.direction) ? 1 : -1);\n  const windowSize = computed(() => isHorizontal.value ? width.value : height.value);\n  const getSize = computed(() => {\n    return clamp(startSize.value + sign.value * offset.value, 4, windowSize.value);\n  });\n  const startSize = ref(0);\n  const offset = ref(0);\n  const isResizing = ref(false);\n  const hasStartedDragging = ref(false);\n  let startPos = [];\n  let cleanups = [];\n  const getActualSize = () => {\n    var _a;\n    const drawerEl = (_a = target.value) == null ? void 0 : _a.closest('[aria-modal=\"true\"]');\n    if (drawerEl) {\n      return isHorizontal.value ? drawerEl.offsetWidth : drawerEl.offsetHeight;\n    }\n    return 100;\n  };\n  watch(() => [props.size, props.resizable], () => {\n    hasStartedDragging.value = false;\n    startSize.value = 0;\n    offset.value = 0;\n    onMouseUp();\n  });\n  const onMousedown = e => {\n    if (!props.resizable) return;\n    if (!hasStartedDragging.value) {\n      startSize.value = getActualSize();\n      hasStartedDragging.value = true;\n    }\n    startPos = [e.pageX, e.pageY];\n    isResizing.value = true;\n    emit(\"resize-start\", e, startSize.value);\n    cleanups.push(useEventListener(window, \"mouseup\", onMouseUp), useEventListener(window, \"mousemove\", onMouseMove));\n  };\n  const onMouseMove = e => {\n    const {\n      pageX,\n      pageY\n    } = e;\n    const offsetX = pageX - startPos[0];\n    const offsetY = pageY - startPos[1];\n    offset.value = isHorizontal.value ? offsetX : offsetY;\n    emit(\"resize\", e, getSize.value);\n  };\n  const onMouseUp = e => {\n    if (!isResizing.value) return;\n    startPos = [];\n    startSize.value = getSize.value;\n    offset.value = 0;\n    isResizing.value = false;\n    cleanups.forEach(cleanup2 => cleanup2 == null ? void 0 : cleanup2());\n    cleanups = [];\n    if (e) {\n      emit(\"resize-end\", e, startSize.value);\n    }\n  };\n  const cleanup = useEventListener(target, \"mousedown\", onMousedown);\n  onBeforeUnmount(() => {\n    cleanup();\n    onMouseUp();\n  });\n  return {\n    size: computed(() => {\n      return hasStartedDragging.value ? `${getSize.value}px` : addUnit(props.size);\n    }),\n    isResizing,\n    isHorizontal\n  };\n}\nexport { useResizable };","map":{"version":3,"names":["useResizable","props","target","emit","width","height","useWindowSize","isHorizontal","computed","includes","direction","sign","windowSize","value","getSize","clamp","startSize","offset","ref","isResizing","hasStartedDragging","startPos","cleanups","getActualSize","_a","drawerEl","closest","offsetWidth","offsetHeight","watch","size","resizable","onMouseUp","onMousedown","e","pageX","pageY","push","useEventListener","window","onMouseMove","offsetX","offsetY","forEach","cleanup2","cleanup","onBeforeUnmount","addUnit"],"sources":["../../../../../../../packages/components/drawer/src/composables/useResizable.ts"],"sourcesContent":["import { computed, onBeforeUnmount, ref, watch } from 'vue'\nimport { addUnit } from '@element-plus/utils'\nimport { clamp, useEventListener, useWindowSize } from '@vueuse/core'\n\nimport type { Ref, SetupContext } from 'vue'\nimport type { DrawerEmits, DrawerProps } from '../drawer'\n\nexport function useResizable(\n  props: DrawerProps,\n  target: Ref<HTMLElement | undefined>,\n  emit: SetupContext<DrawerEmits>['emit']\n) {\n  const { width, height } = useWindowSize()\n\n  const isHorizontal = computed(() => ['ltr', 'rtl'].includes(props.direction))\n  const sign = computed(() =>\n    ['ltr', 'ttb'].includes(props.direction) ? 1 : -1\n  )\n  const windowSize = computed(() =>\n    isHorizontal.value ? width.value : height.value\n  )\n  const getSize = computed(() => {\n    return clamp(\n      startSize.value + sign.value * offset.value,\n      4,\n      windowSize.value\n    )\n  })\n\n  const startSize = ref(0)\n  const offset = ref(0)\n  const isResizing = ref(false)\n  const hasStartedDragging = ref(false)\n  let startPos: number[] = []\n  let cleanups: (() => void)[] = []\n\n  const getActualSize = () => {\n    const drawerEl = target.value?.closest('[aria-modal=\"true\"]') as HTMLElement\n    if (drawerEl) {\n      return isHorizontal.value ? drawerEl.offsetWidth : drawerEl.offsetHeight\n    }\n    return 100\n  }\n\n  watch(\n    () => [props.size, props.resizable] as const,\n    () => {\n      hasStartedDragging.value = false\n      startSize.value = 0\n      offset.value = 0\n      onMouseUp()\n    }\n  )\n\n  const onMousedown = (e: MouseEvent) => {\n    if (!props.resizable) return\n\n    if (!hasStartedDragging.value) {\n      startSize.value = getActualSize()\n      hasStartedDragging.value = true\n    }\n\n    startPos = [e.pageX, e.pageY]\n    isResizing.value = true\n    emit('resize-start', e, startSize.value)\n    cleanups.push(\n      useEventListener(window, 'mouseup', onMouseUp),\n      useEventListener(window, 'mousemove', onMouseMove)\n    )\n  }\n\n  const onMouseMove = (e: MouseEvent) => {\n    const { pageX, pageY } = e\n    const offsetX = pageX - startPos[0]\n    const offsetY = pageY - startPos[1]\n    offset.value = isHorizontal.value ? offsetX : offsetY\n    emit('resize', e, getSize.value)\n  }\n\n  const onMouseUp = (e?: MouseEvent) => {\n    // premature interruption\n    // avoid triggering meaningless execution due to watch size/resizable constraints.\n    if (!isResizing.value) return\n\n    startPos = []\n    startSize.value = getSize.value\n    offset.value = 0\n    isResizing.value = false\n    cleanups.forEach((cleanup) => cleanup?.())\n    cleanups = []\n    if (e) {\n      emit('resize-end', e, startSize.value)\n    }\n  }\n\n  const cleanup = useEventListener(target, 'mousedown', onMousedown)\n\n  onBeforeUnmount(() => {\n    cleanup()\n    onMouseUp()\n  })\n\n  return {\n    size: computed(() => {\n      return hasStartedDragging.value\n        ? `${getSize.value}px`\n        : addUnit(props.size)\n    }),\n    isResizing,\n    isHorizontal,\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}