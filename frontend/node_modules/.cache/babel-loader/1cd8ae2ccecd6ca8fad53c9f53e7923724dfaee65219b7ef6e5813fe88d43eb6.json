{"ast":null,"code":"import { ref, watch, unref } from 'vue';\nconst useScrollbar = (props, {\n  mainTableRef,\n  leftTableRef,\n  rightTableRef,\n  onMaybeEndReached\n}) => {\n  const scrollPos = ref({\n    scrollLeft: 0,\n    scrollTop: 0\n  });\n  function doScroll(params) {\n    var _a, _b, _c;\n    const {\n      scrollTop\n    } = params;\n    (_a = mainTableRef.value) == null ? void 0 : _a.scrollTo(params);\n    (_b = leftTableRef.value) == null ? void 0 : _b.scrollToTop(scrollTop);\n    (_c = rightTableRef.value) == null ? void 0 : _c.scrollToTop(scrollTop);\n  }\n  function scrollTo(params) {\n    scrollPos.value = params;\n    doScroll(params);\n  }\n  function scrollToTop(scrollTop) {\n    scrollPos.value.scrollTop = scrollTop;\n    doScroll(unref(scrollPos));\n  }\n  function scrollToLeft(scrollLeft) {\n    var _a, _b;\n    scrollPos.value.scrollLeft = scrollLeft;\n    (_b = (_a = mainTableRef.value) == null ? void 0 : _a.scrollTo) == null ? void 0 : _b.call(_a, unref(scrollPos));\n  }\n  function onScroll(params) {\n    var _a;\n    scrollTo(params);\n    (_a = props.onScroll) == null ? void 0 : _a.call(props, params);\n  }\n  function onVerticalScroll({\n    scrollTop\n  }) {\n    const {\n      scrollTop: currentScrollTop\n    } = unref(scrollPos);\n    if (scrollTop !== currentScrollTop) scrollToTop(scrollTop);\n  }\n  function scrollToRow(row, strategy = \"auto\") {\n    var _a;\n    (_a = mainTableRef.value) == null ? void 0 : _a.scrollToRow(row, strategy);\n  }\n  watch(() => unref(scrollPos).scrollTop, (cur, prev) => {\n    if (cur > prev) onMaybeEndReached();\n  });\n  return {\n    scrollPos,\n    scrollTo,\n    scrollToLeft,\n    scrollToTop,\n    scrollToRow,\n    onScroll,\n    onVerticalScroll\n  };\n};\nexport { useScrollbar };","map":{"version":3,"names":["useScrollbar","props","mainTableRef","leftTableRef","rightTableRef","onMaybeEndReached","scrollPos","ref","scrollLeft","scrollTop","doScroll","params","_a","_b","_c","value","scrollTo","scrollToTop","unref","scrollToLeft","call","onScroll","onVerticalScroll","currentScrollTop","scrollToRow","row","strategy","watch","cur","prev"],"sources":["../../../../../../../packages/components/table-v2/src/composables/use-scrollbar.ts"],"sourcesContent":["import { ref, unref, watch } from 'vue'\n\nimport type { Ref } from 'vue'\nimport type { Alignment as ScrollStrategy } from '@element-plus/components/virtual-list'\nimport type { TableV2Props } from '../table'\nimport type { TableGridInstance } from '../table-grid'\n\nexport type ScrollPos = { scrollLeft: number; scrollTop: number }\ntype GridInstanceRef = Ref<TableGridInstance | undefined>\n\ntype UseScrollBarProps = {\n  mainTableRef: GridInstanceRef\n  leftTableRef: GridInstanceRef\n  rightTableRef: GridInstanceRef\n\n  onMaybeEndReached: () => void\n}\n\nexport type { ScrollStrategy }\n\nexport const useScrollbar = (\n  props: TableV2Props,\n  {\n    mainTableRef,\n    leftTableRef,\n    rightTableRef,\n    onMaybeEndReached,\n  }: UseScrollBarProps\n) => {\n  const scrollPos = ref<ScrollPos>({ scrollLeft: 0, scrollTop: 0 })\n\n  function doScroll(params: ScrollPos) {\n    const { scrollTop } = params\n\n    mainTableRef.value?.scrollTo(params)\n    leftTableRef.value?.scrollToTop(scrollTop)\n    rightTableRef.value?.scrollToTop(scrollTop)\n  }\n\n  // methods\n  function scrollTo(params: ScrollPos) {\n    scrollPos.value = params\n\n    doScroll(params)\n  }\n\n  function scrollToTop(scrollTop: number) {\n    scrollPos.value.scrollTop = scrollTop\n\n    doScroll(unref(scrollPos))\n  }\n\n  function scrollToLeft(scrollLeft: number) {\n    scrollPos.value.scrollLeft = scrollLeft\n\n    mainTableRef.value?.scrollTo?.(unref(scrollPos))\n  }\n\n  function onScroll(params: ScrollPos) {\n    scrollTo(params)\n    props.onScroll?.(params)\n  }\n\n  function onVerticalScroll({ scrollTop }: ScrollPos) {\n    const { scrollTop: currentScrollTop } = unref(scrollPos)\n    if (scrollTop !== currentScrollTop) scrollToTop(scrollTop)\n  }\n\n  function scrollToRow(row: number, strategy: ScrollStrategy = 'auto') {\n    mainTableRef.value?.scrollToRow(row, strategy)\n  }\n\n  // When scrollTop changes, maybe reaching the bottom\n  watch(\n    () => unref(scrollPos).scrollTop,\n    (cur, prev) => {\n      if (cur > prev) onMaybeEndReached()\n    }\n  )\n\n  return {\n    scrollPos,\n\n    scrollTo,\n    scrollToLeft,\n    scrollToTop,\n    scrollToRow,\n    onScroll,\n    onVerticalScroll,\n  }\n}\n"],"mappings":";AAoBa,MAAAA,YAAA,GAAeA,CAC1BC,KACA;EACEC,YAAA;EACAC,YAAA;EACAC,aAAA;EACAC;AACF,CACG;EACH,MAAMC,SAAA,GAAYC,GAAe;IAAEC,UAAA,EAAY,CAAG;IAAAC,SAAA,EAAW;EAAA,CAAG;EAEhE,SAASC,SAASC,MAAmB;IA/BvC,IAAAC,EAAA,EAAAC,EAAA,EAAAC,EAAA;IAgCU;MAAEL;IAAA,CAAc,GAAAE,MAAA;IAET,CAAAC,EAAA,GAAAV,YAAA,CAAAa,KAAA,KAAb,gBAAAH,EAAA,CAAoBI,QAAS,CAAAL,MAAA;IAChB,CAAAE,EAAA,GAAAV,YAAA,CAAAY,KAAA,KAAb,gBAAAF,EAAA,CAAoBI,WAAY,CAAAR,SAAA;IAClB,CAAAK,EAAA,GAAAV,aAAA,CAAAW,KAAA,KAAd,gBAAAD,EAAA,CAAqBG,WAAY,CAAAR,SAAA;EAAA;EAInC,SAASO,SAASL,MAAmB;IACnCL,SAAA,CAAUS,KAAQ,GAAAJ,MAAA;IAElBD,QAAA,CAASC,MAAM;EAAA;EAGjB,SAASM,YAAYR,SAAmB;IACtCH,SAAA,CAAUS,KAAA,CAAMN,SAAY,GAAAA,SAAA;IAEnBC,QAAA,CAAAQ,KAAA,CAAMZ,SAAS,CAAC;EAAA;EAG3B,SAASa,aAAaX,UAAoB;IApD5C,IAAAI,EAAA,EAAAC,EAAA;IAqDIP,SAAA,CAAUS,KAAA,CAAMP,UAAa,GAAAA,UAAA;IAE7B,CAAAK,EAAA,IAAAD,EAAA,GAAAV,YAAA,CAAaa,KAAb,qBAAAH,EAAA,CAAoBI,QAApB,qBAAAH,EAAA,CAAAO,IAAA,CAAAR,EAAA,EAA+BM,KAAA,CAAMZ,SAAS;EAAA;EAGhD,SAASe,SAASV,MAAmB;IA1DvC,IAAAC,EAAA;IA2DII,QAAA,CAASL,MAAM;IACf,CAAAC,EAAA,GAAAX,KAAA,CAAMoB,QAAA,KAAN,IAAiB,YAAAT,EAAA,CAAAQ,IAAA,CAAAnB,KAAA,EAAAU,MAAA;EAAA;EAGV,SAAAW,iBAAiB;IAAEb;EAAA,CAAwB;IAClD,MAAM;MAAEA,SAAA,EAAWc;IAAiB,IAAIL,KAAA,CAAMZ,SAAS;IACvD,IAAIG,SAAc,KAAAc,gBAAA,EAAkBN,WAAA,CAAYR,SAAS;EAAA;EAGlD,SAAAe,YAAYC,GAAa,EAAAC,QAAA,GAA2B,MAAQ;IApEvE,IAAAd,EAAA;IAqEiB,CAAAA,EAAA,GAAAV,YAAA,CAAAa,KAAA,KAAb,IAAoB,YAAAH,EAAA,CAAAY,WAAA,CAAYC,GAAK,EAAAC,QAAA;EAAA;EAIvCC,KAAA,CACE,MAAMT,KAAM,CAAAZ,SAAS,CAAE,CAAAG,SAAA,EACvB,CAACmB,GAAA,EAAKC,IAAS;IACb,IAAID,GAAM,GAAAC,IAAA,EAAwBxB,iBAAA;EAAA,CACpC,CACF;EAEO;IACLC,SAAA;IAEAU,QAAA;IACAG,YAAA;IACAF,WAAA;IACAO,WAAA;IACAH,QAAA;IACAC;EAAA,CACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}