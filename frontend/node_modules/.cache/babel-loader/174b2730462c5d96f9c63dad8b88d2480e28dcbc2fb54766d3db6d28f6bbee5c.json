{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/esnext.json.parse.js\";\nimport { createStore } from 'vuex';\nimport api from '@/api';\nexport default createStore({\n  state: {\n    files: [],\n    currentFile: null,\n    showUploadDialog: false,\n    showProgressDialog: false,\n    progress: 0,\n    progressMessage: '',\n    progressStep: '',\n    // 认证相关状态\n    token: localStorage.getItem('token') || null,\n    user: JSON.parse(localStorage.getItem('user') || 'null'),\n    isAuthenticated: !!localStorage.getItem('token')\n  },\n  mutations: {\n    SET_FILES(state, files) {\n      state.files = files;\n    },\n    ADD_FILE(state, file) {\n      state.files.unshift(file);\n    },\n    REMOVE_FILE(state, paperId) {\n      state.files = state.files.filter(f => f.id !== paperId);\n    },\n    UPDATE_FILE_STATUS(state, {\n      paperId,\n      analyzed\n    }) {\n      const file = state.files.find(f => f.id === paperId);\n      if (file) {\n        file.analyzed = analyzed;\n      }\n    },\n    SET_CURRENT_FILE(state, file) {\n      state.currentFile = file;\n    },\n    SHOW_UPLOAD_DIALOG(state, show) {\n      state.showUploadDialog = show;\n    },\n    SHOW_PROGRESS_DIALOG(state, show) {\n      state.showProgressDialog = show;\n    },\n    SET_PROGRESS(state, {\n      progress,\n      message,\n      step\n    }) {\n      if (progress !== undefined) state.progress = progress;\n      if (message !== undefined) state.progressMessage = message;\n      if (step !== undefined) state.progressStep = step;\n    },\n    // 认证相关mutations\n    SET_TOKEN(state, token) {\n      state.token = token;\n      state.isAuthenticated = !!token;\n      if (token) {\n        localStorage.setItem('token', token);\n      } else {\n        localStorage.removeItem('token');\n      }\n    },\n    SET_USER(state, user) {\n      state.user = user;\n      if (user) {\n        localStorage.setItem('user', JSON.stringify(user));\n      } else {\n        localStorage.removeItem('user');\n      }\n    },\n    CLEAR_AUTH(state) {\n      state.token = null;\n      state.user = null;\n      state.isAuthenticated = false;\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n    }\n  },\n  actions: {\n    async fetchFiles({\n      commit\n    }) {\n      try {\n        const response = await api.getPapersList();\n        if (response.success) {\n          commit('SET_FILES', response.data);\n        }\n      } catch (error) {\n        console.error('获取论文列表失败:', error);\n      }\n    },\n    async deleteFile({\n      commit,\n      dispatch\n    }, paperId) {\n      try {\n        const response = await api.deletePaper(paperId);\n        if (response.success) {\n          commit('REMOVE_FILE', paperId);\n          return true;\n        }\n      } catch (error) {\n        console.error('删除论文失败:', error);\n        return false;\n      }\n    },\n    // 认证相关actions\n    async login({\n      commit\n    }, credentials) {\n      try {\n        const response = await api.login(credentials);\n        if (response.success) {\n          commit('SET_TOKEN', response.data.token);\n          commit('SET_USER', response.data.user);\n          return response;\n        }\n        return response;\n      } catch (error) {\n        console.error('登录失败:', error);\n        return {\n          success: false,\n          error: error.message || '登录失败'\n        };\n      }\n    },\n    async register({\n      commit\n    }, userData) {\n      try {\n        const response = await api.register(userData);\n        if (response.success) {\n          commit('SET_TOKEN', response.data.token);\n          commit('SET_USER', response.data.user);\n          return response;\n        }\n        return response;\n      } catch (error) {\n        console.error('注册失败:', error);\n        return {\n          success: false,\n          error: error.message || '注册失败'\n        };\n      }\n    },\n    async logout({\n      commit\n    }) {\n      commit('CLEAR_AUTH');\n    },\n    async fetchCurrentUser({\n      commit,\n      state\n    }) {\n      if (!state.token) {\n        return {\n          success: false,\n          error: '未登录'\n        };\n      }\n      try {\n        const response = await api.getCurrentUser();\n        if (response.success) {\n          commit('SET_USER', response.data);\n          return response;\n        }\n        return response;\n      } catch (error) {\n        console.error('获取用户信息失败:', error);\n        // 如果token无效，清除认证状态\n        if (error.response && error.response.status === 401) {\n          commit('CLEAR_AUTH');\n        }\n        return {\n          success: false,\n          error: error.message || '获取用户信息失败'\n        };\n      }\n    },\n    async updateUser({\n      commit\n    }, userData) {\n      try {\n        const response = await api.updateUser(userData);\n        if (response.success) {\n          commit('SET_USER', response.data);\n          return response;\n        }\n        return response;\n      } catch (error) {\n        console.error('更新用户信息失败:', error);\n        return {\n          success: false,\n          error: error.message || '更新失败'\n        };\n      }\n    }\n  },\n  getters: {\n    uploadedCount: state => state.files.length,\n    // 认证相关getters\n    isAuthenticated: state => state.isAuthenticated,\n    currentUser: state => state.user,\n    token: state => state.token\n  }\n});","map":{"version":3,"names":["createStore","api","state","files","currentFile","showUploadDialog","showProgressDialog","progress","progressMessage","progressStep","token","localStorage","getItem","user","JSON","parse","isAuthenticated","mutations","SET_FILES","ADD_FILE","file","unshift","REMOVE_FILE","paperId","filter","f","id","UPDATE_FILE_STATUS","analyzed","find","SET_CURRENT_FILE","SHOW_UPLOAD_DIALOG","show","SHOW_PROGRESS_DIALOG","SET_PROGRESS","message","step","undefined","SET_TOKEN","setItem","removeItem","SET_USER","stringify","CLEAR_AUTH","actions","fetchFiles","commit","response","getPapersList","success","data","error","console","deleteFile","dispatch","deletePaper","login","credentials","register","userData","logout","fetchCurrentUser","getCurrentUser","status","updateUser","getters","uploadedCount","length","currentUser"],"sources":["/Users/liucunyu/Documents/all_code/NUC_graduation_project/frontend/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\nimport api from '@/api'\n\nexport default createStore({\n  state: {\n    files: [],\n    currentFile: null,\n    showUploadDialog: false,\n    showProgressDialog: false,\n    progress: 0,\n    progressMessage: '',\n    progressStep: '',\n\n    // 认证相关状态\n    token: localStorage.getItem('token') || null,\n    user: JSON.parse(localStorage.getItem('user') || 'null'),\n    isAuthenticated: !!localStorage.getItem('token')\n  },\n\n  mutations: {\n    SET_FILES(state, files) {\n      state.files = files\n    },\n\n    ADD_FILE(state, file) {\n      state.files.unshift(file)\n    },\n\n    REMOVE_FILE(state, paperId) {\n      state.files = state.files.filter(f => f.id !== paperId)\n    },\n\n    UPDATE_FILE_STATUS(state, { paperId, analyzed }) {\n      const file = state.files.find(f => f.id === paperId)\n      if (file) {\n        file.analyzed = analyzed\n      }\n    },\n\n    SET_CURRENT_FILE(state, file) {\n      state.currentFile = file\n    },\n\n    SHOW_UPLOAD_DIALOG(state, show) {\n      state.showUploadDialog = show\n    },\n\n    SHOW_PROGRESS_DIALOG(state, show) {\n      state.showProgressDialog = show\n    },\n\n    SET_PROGRESS(state, { progress, message, step }) {\n      if (progress !== undefined) state.progress = progress\n      if (message !== undefined) state.progressMessage = message\n      if (step !== undefined) state.progressStep = step\n    },\n\n    // 认证相关mutations\n    SET_TOKEN(state, token) {\n      state.token = token\n      state.isAuthenticated = !!token\n      if (token) {\n        localStorage.setItem('token', token)\n      } else {\n        localStorage.removeItem('token')\n      }\n    },\n\n    SET_USER(state, user) {\n      state.user = user\n      if (user) {\n        localStorage.setItem('user', JSON.stringify(user))\n      } else {\n        localStorage.removeItem('user')\n      }\n    },\n\n    CLEAR_AUTH(state) {\n      state.token = null\n      state.user = null\n      state.isAuthenticated = false\n      localStorage.removeItem('token')\n      localStorage.removeItem('user')\n    }\n  },\n\n  actions: {\n    async fetchFiles({ commit }) {\n      try {\n        const response = await api.getPapersList()\n        if (response.success) {\n          commit('SET_FILES', response.data)\n        }\n      } catch (error) {\n        console.error('获取论文列表失败:', error)\n      }\n    },\n\n    async deleteFile({ commit, dispatch }, paperId) {\n      try {\n        const response = await api.deletePaper(paperId)\n        if (response.success) {\n          commit('REMOVE_FILE', paperId)\n          return true\n        }\n      } catch (error) {\n        console.error('删除论文失败:', error)\n        return false\n      }\n    },\n\n    // 认证相关actions\n    async login({ commit }, credentials) {\n      try {\n        const response = await api.login(credentials)\n\n        if (response.success) {\n          commit('SET_TOKEN', response.data.token)\n          commit('SET_USER', response.data.user)\n          return response\n        }\n        return response\n      } catch (error) {\n        console.error('登录失败:', error)\n        return { success: false, error: error.message || '登录失败' }\n      }\n    },\n\n    async register({ commit }, userData) {\n      try {\n        const response = await api.register(userData)\n\n        if (response.success) {\n          commit('SET_TOKEN', response.data.token)\n          commit('SET_USER', response.data.user)\n          return response\n        }\n        return response\n      } catch (error) {\n        console.error('注册失败:', error)\n        return { success: false, error: error.message || '注册失败' }\n      }\n    },\n\n    async logout({ commit }) {\n      commit('CLEAR_AUTH')\n    },\n\n    async fetchCurrentUser({ commit, state }) {\n      if (!state.token) {\n        return { success: false, error: '未登录' }\n      }\n\n      try {\n        const response = await api.getCurrentUser()\n\n        if (response.success) {\n          commit('SET_USER', response.data)\n          return response\n        }\n        return response\n      } catch (error) {\n        console.error('获取用户信息失败:', error)\n        // 如果token无效，清除认证状态\n        if (error.response && error.response.status === 401) {\n          commit('CLEAR_AUTH')\n        }\n        return { success: false, error: error.message || '获取用户信息失败' }\n      }\n    },\n\n    async updateUser({ commit }, userData) {\n      try {\n        const response = await api.updateUser(userData)\n\n        if (response.success) {\n          commit('SET_USER', response.data)\n          return response\n        }\n        return response\n      } catch (error) {\n        console.error('更新用户信息失败:', error)\n        return { success: false, error: error.message || '更新失败' }\n      }\n    }\n  },\n\n  getters: {\n    uploadedCount: state => state.files.length,\n\n    // 认证相关getters\n    isAuthenticated: state => state.isAuthenticated,\n    currentUser: state => state.user,\n    token: state => state.token\n  }\n})\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}