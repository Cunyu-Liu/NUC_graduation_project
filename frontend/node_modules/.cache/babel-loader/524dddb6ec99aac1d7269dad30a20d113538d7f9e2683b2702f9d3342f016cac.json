{"ast":null,"code":"import { defineComponent, markRaw, ref, effectScope, computed, shallowRef, watch, nextTick, onMounted, openBlock, createBlock, unref, withCtx, createVNode, Transition, createElementVNode, normalizeClass, normalizeStyle, withModifiers, createCommentVNode, createElementBlock, Fragment, renderSlot, createTextVNode, toDisplayString, resolveDynamicComponent } from 'vue';\nimport { clamp, useEventListener } from '@vueuse/core';\nimport { throttle } from 'lodash-unified';\nimport ElFocusTrap from '../../focus-trap/src/focus-trap.mjs';\nimport { ElTeleport } from '../../teleport/index.mjs';\nimport { ElIcon } from '../../icon/index.mjs';\nimport { FullScreen, ScaleToOriginal, Close, ArrowLeft, ArrowRight, ZoomOut, ZoomIn, RefreshLeft, RefreshRight } from '@element-plus/icons-vue';\nimport { imageViewerProps, imageViewerEmits } from './image-viewer.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useLocale } from '../../../hooks/use-locale/index.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useZIndex } from '../../../hooks/use-z-index/index.mjs';\nimport { useLockscreen } from '../../../hooks/use-lockscreen/index.mjs';\nimport { getEventCode } from '../../../utils/dom/event.mjs';\nimport { EVENT_CODE } from '../../../constants/aria.mjs';\nimport { keysOf } from '../../../utils/objects.mjs';\nconst _hoisted_1 = [\"src\", \"crossorigin\"];\nconst _sfc_main = defineComponent({\n  ...{\n    name: \"ElImageViewer\"\n  },\n  __name: \"image-viewer\",\n  props: imageViewerProps,\n  emits: imageViewerEmits,\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    var _a;\n    const modes = {\n      CONTAIN: {\n        name: \"contain\",\n        icon: markRaw(FullScreen)\n      },\n      ORIGINAL: {\n        name: \"original\",\n        icon: markRaw(ScaleToOriginal)\n      }\n    };\n    const props = __props;\n    const emit = __emit;\n    let stopWheelListener;\n    const {\n      t\n    } = useLocale();\n    const ns = useNamespace(\"image-viewer\");\n    const {\n      nextZIndex\n    } = useZIndex();\n    const wrapper = ref();\n    const imgRef = ref();\n    const scopeEventListener = effectScope();\n    const scaleClamped = computed(() => {\n      const {\n        scale,\n        minScale,\n        maxScale\n      } = props;\n      return clamp(scale, minScale, maxScale);\n    });\n    const loading = ref(true);\n    const loadError = ref(false);\n    const visible = ref(false);\n    const activeIndex = ref(props.initialIndex);\n    const mode = shallowRef(modes.CONTAIN);\n    const transform = ref({\n      scale: scaleClamped.value,\n      deg: 0,\n      offsetX: 0,\n      offsetY: 0,\n      enableTransition: false\n    });\n    const zIndex = ref((_a = props.zIndex) != null ? _a : nextZIndex());\n    useLockscreen(visible, {\n      ns\n    });\n    const isSingle = computed(() => {\n      const {\n        urlList\n      } = props;\n      return urlList.length <= 1;\n    });\n    const isFirst = computed(() => activeIndex.value === 0);\n    const isLast = computed(() => activeIndex.value === props.urlList.length - 1);\n    const currentImg = computed(() => props.urlList[activeIndex.value]);\n    const arrowPrevKls = computed(() => [ns.e(\"btn\"), ns.e(\"prev\"), ns.is(\"disabled\", !props.infinite && isFirst.value)]);\n    const arrowNextKls = computed(() => [ns.e(\"btn\"), ns.e(\"next\"), ns.is(\"disabled\", !props.infinite && isLast.value)]);\n    const imgStyle = computed(() => {\n      const {\n        scale,\n        deg,\n        offsetX,\n        offsetY,\n        enableTransition\n      } = transform.value;\n      let translateX = offsetX / scale;\n      let translateY = offsetY / scale;\n      const radian = deg * Math.PI / 180;\n      const cosRadian = Math.cos(radian);\n      const sinRadian = Math.sin(radian);\n      translateX = translateX * cosRadian + translateY * sinRadian;\n      translateY = translateY * cosRadian - offsetX / scale * sinRadian;\n      const style = {\n        transform: `scale(${scale}) rotate(${deg}deg) translate(${translateX}px, ${translateY}px)`,\n        transition: enableTransition ? \"transform .3s\" : \"\"\n      };\n      if (mode.value.name === modes.CONTAIN.name) {\n        style.maxWidth = style.maxHeight = \"100%\";\n      }\n      return style;\n    });\n    const progress = computed(() => `${activeIndex.value + 1} / ${props.urlList.length}`);\n    function hide() {\n      unregisterEventListener();\n      stopWheelListener == null ? void 0 : stopWheelListener();\n      visible.value = false;\n      emit(\"close\");\n    }\n    function registerEventListener() {\n      const keydownHandler = throttle(e => {\n        const code = getEventCode(e);\n        switch (code) {\n          case EVENT_CODE.esc:\n            props.closeOnPressEscape && hide();\n            break;\n          case EVENT_CODE.space:\n            toggleMode();\n            break;\n          case EVENT_CODE.left:\n            prev();\n            break;\n          case EVENT_CODE.up:\n            handleActions(\"zoomIn\");\n            break;\n          case EVENT_CODE.right:\n            next();\n            break;\n          case EVENT_CODE.down:\n            handleActions(\"zoomOut\");\n            break;\n        }\n      });\n      const mousewheelHandler = throttle(e => {\n        const delta = e.deltaY || e.deltaX;\n        handleActions(delta < 0 ? \"zoomIn\" : \"zoomOut\", {\n          zoomRate: props.zoomRate,\n          enableTransition: false\n        });\n      });\n      scopeEventListener.run(() => {\n        useEventListener(document, \"keydown\", keydownHandler);\n        useEventListener(wrapper, \"wheel\", mousewheelHandler);\n      });\n    }\n    function unregisterEventListener() {\n      scopeEventListener.stop();\n    }\n    function handleImgLoad() {\n      loading.value = false;\n    }\n    function handleImgError(e) {\n      loadError.value = true;\n      loading.value = false;\n      emit(\"error\", e);\n      e.target.alt = t(\"el.image.error\");\n    }\n    function handleMouseDown(e) {\n      if (loading.value || e.button !== 0 || !wrapper.value) return;\n      transform.value.enableTransition = false;\n      const {\n        offsetX,\n        offsetY\n      } = transform.value;\n      const startX = e.pageX;\n      const startY = e.pageY;\n      const dragHandler = throttle(ev => {\n        transform.value = {\n          ...transform.value,\n          offsetX: offsetX + ev.pageX - startX,\n          offsetY: offsetY + ev.pageY - startY\n        };\n      });\n      const removeMousemove = useEventListener(document, \"mousemove\", dragHandler);\n      const removeMouseup = useEventListener(document, \"mouseup\", () => {\n        removeMousemove();\n        removeMouseup();\n      });\n      e.preventDefault();\n    }\n    function handleTouchStart(e) {\n      if (loading.value || !wrapper.value || e.touches.length !== 1) return;\n      transform.value.enableTransition = false;\n      const {\n        offsetX,\n        offsetY\n      } = transform.value;\n      const {\n        pageX: startX,\n        pageY: startY\n      } = e.touches[0];\n      const dragHandler = throttle(ev => {\n        const targetTouch = ev.touches[0];\n        transform.value = {\n          ...transform.value,\n          offsetX: offsetX + targetTouch.pageX - startX,\n          offsetY: offsetY + targetTouch.pageY - startY\n        };\n      });\n      const removeTouchmove = useEventListener(document, \"touchmove\", dragHandler);\n      const removeTouchend = useEventListener(document, \"touchend\", () => {\n        removeTouchmove();\n        removeTouchend();\n      });\n      e.preventDefault();\n    }\n    function reset() {\n      transform.value = {\n        scale: scaleClamped.value,\n        deg: 0,\n        offsetX: 0,\n        offsetY: 0,\n        enableTransition: false\n      };\n    }\n    function toggleMode() {\n      if (loading.value || loadError.value) return;\n      const modeNames = keysOf(modes);\n      const modeValues = Object.values(modes);\n      const currentMode = mode.value.name;\n      const index = modeValues.findIndex(i => i.name === currentMode);\n      const nextIndex = (index + 1) % modeNames.length;\n      mode.value = modes[modeNames[nextIndex]];\n      reset();\n    }\n    function setActiveItem(index) {\n      loadError.value = false;\n      const len = props.urlList.length;\n      activeIndex.value = (index + len) % len;\n    }\n    function prev() {\n      if (isFirst.value && !props.infinite) return;\n      setActiveItem(activeIndex.value - 1);\n    }\n    function next() {\n      if (isLast.value && !props.infinite) return;\n      setActiveItem(activeIndex.value + 1);\n    }\n    function handleActions(action, options = {}) {\n      if (loading.value || loadError.value) return;\n      const {\n        minScale,\n        maxScale\n      } = props;\n      const {\n        zoomRate,\n        rotateDeg,\n        enableTransition\n      } = {\n        zoomRate: props.zoomRate,\n        rotateDeg: 90,\n        enableTransition: true,\n        ...options\n      };\n      switch (action) {\n        case \"zoomOut\":\n          if (transform.value.scale > minScale) {\n            transform.value.scale = Number.parseFloat((transform.value.scale / zoomRate).toFixed(3));\n          }\n          break;\n        case \"zoomIn\":\n          if (transform.value.scale < maxScale) {\n            transform.value.scale = Number.parseFloat((transform.value.scale * zoomRate).toFixed(3));\n          }\n          break;\n        case \"clockwise\":\n          transform.value.deg += rotateDeg;\n          emit(\"rotate\", transform.value.deg);\n          break;\n        case \"anticlockwise\":\n          transform.value.deg -= rotateDeg;\n          emit(\"rotate\", transform.value.deg);\n          break;\n      }\n      transform.value.enableTransition = enableTransition;\n    }\n    function onFocusoutPrevented(event) {\n      var _a2;\n      if (((_a2 = event.detail) == null ? void 0 : _a2.focusReason) === \"pointer\") {\n        event.preventDefault();\n      }\n    }\n    function onCloseRequested() {\n      if (props.closeOnPressEscape) {\n        hide();\n      }\n    }\n    function wheelHandler(e) {\n      if (!e.ctrlKey) return;\n      if (e.deltaY < 0) {\n        e.preventDefault();\n        return false;\n      } else if (e.deltaY > 0) {\n        e.preventDefault();\n        return false;\n      }\n    }\n    watch(() => scaleClamped.value, val => {\n      transform.value.scale = val;\n    });\n    watch(currentImg, () => {\n      nextTick(() => {\n        const $img = imgRef.value;\n        if (!($img == null ? void 0 : $img.complete)) {\n          loading.value = true;\n        }\n      });\n    });\n    watch(activeIndex, val => {\n      reset();\n      emit(\"switch\", val);\n    });\n    onMounted(() => {\n      visible.value = true;\n      registerEventListener();\n      stopWheelListener = useEventListener(\"wheel\", wheelHandler, {\n        passive: false\n      });\n    });\n    __expose({\n      setActiveItem\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(unref(ElTeleport), {\n        to: \"body\",\n        disabled: !_ctx.teleported\n      }, {\n        default: withCtx(() => [createVNode(Transition, {\n          name: \"viewer-fade\",\n          appear: \"\"\n        }, {\n          default: withCtx(() => [createElementVNode(\"div\", {\n            ref_key: \"wrapper\",\n            ref: wrapper,\n            tabindex: -1,\n            class: normalizeClass(unref(ns).e(\"wrapper\")),\n            style: normalizeStyle({\n              zIndex: zIndex.value\n            })\n          }, [createVNode(unref(ElFocusTrap), {\n            loop: \"\",\n            trapped: \"\",\n            \"focus-trap-el\": wrapper.value,\n            \"focus-start-el\": \"container\",\n            onFocusoutPrevented,\n            onReleaseRequested: onCloseRequested\n          }, {\n            default: withCtx(() => [createElementVNode(\"div\", {\n              class: normalizeClass(unref(ns).e(\"mask\")),\n              onClick: _cache[0] || (_cache[0] = withModifiers($event => _ctx.hideOnClickModal && hide(), [\"self\"]))\n            }, null, 2), createCommentVNode(\" CLOSE \"), createElementVNode(\"span\", {\n              class: normalizeClass([unref(ns).e(\"btn\"), unref(ns).e(\"close\")]),\n              onClick: hide\n            }, [createVNode(unref(ElIcon), null, {\n              default: withCtx(() => [createVNode(unref(Close))]),\n              _: 1\n            })], 2), createCommentVNode(\" ARROW \"), !isSingle.value ? (openBlock(), createElementBlock(Fragment, {\n              key: 0\n            }, [createElementVNode(\"span\", {\n              class: normalizeClass(arrowPrevKls.value),\n              onClick: prev\n            }, [createVNode(unref(ElIcon), null, {\n              default: withCtx(() => [createVNode(unref(ArrowLeft))]),\n              _: 1\n            })], 2), createElementVNode(\"span\", {\n              class: normalizeClass(arrowNextKls.value),\n              onClick: next\n            }, [createVNode(unref(ElIcon), null, {\n              default: withCtx(() => [createVNode(unref(ArrowRight))]),\n              _: 1\n            })], 2)], 64)) : createCommentVNode(\"v-if\", true), _ctx.$slots.progress || _ctx.showProgress ? (openBlock(), createElementBlock(\"div\", {\n              key: 1,\n              class: normalizeClass([unref(ns).e(\"btn\"), unref(ns).e(\"progress\")])\n            }, [renderSlot(_ctx.$slots, \"progress\", {\n              activeIndex: activeIndex.value,\n              total: _ctx.urlList.length\n            }, () => [createTextVNode(toDisplayString(progress.value), 1)])], 2)) : createCommentVNode(\"v-if\", true), createCommentVNode(\" ACTIONS \"), createElementVNode(\"div\", {\n              class: normalizeClass([unref(ns).e(\"btn\"), unref(ns).e(\"actions\")])\n            }, [createElementVNode(\"div\", {\n              class: normalizeClass(unref(ns).e(\"actions__inner\"))\n            }, [renderSlot(_ctx.$slots, \"toolbar\", {\n              actions: handleActions,\n              prev,\n              next,\n              reset: toggleMode,\n              activeIndex: activeIndex.value,\n              setActiveItem\n            }, () => [createVNode(unref(ElIcon), {\n              onClick: _cache[1] || (_cache[1] = $event => handleActions(\"zoomOut\"))\n            }, {\n              default: withCtx(() => [createVNode(unref(ZoomOut))]),\n              _: 1\n            }), createVNode(unref(ElIcon), {\n              onClick: _cache[2] || (_cache[2] = $event => handleActions(\"zoomIn\"))\n            }, {\n              default: withCtx(() => [createVNode(unref(ZoomIn))]),\n              _: 1\n            }), createElementVNode(\"i\", {\n              class: normalizeClass(unref(ns).e(\"actions__divider\"))\n            }, null, 2), createVNode(unref(ElIcon), {\n              onClick: toggleMode\n            }, {\n              default: withCtx(() => [(openBlock(), createBlock(resolveDynamicComponent(mode.value.icon)))]),\n              _: 1\n            }), createElementVNode(\"i\", {\n              class: normalizeClass(unref(ns).e(\"actions__divider\"))\n            }, null, 2), createVNode(unref(ElIcon), {\n              onClick: _cache[3] || (_cache[3] = $event => handleActions(\"anticlockwise\"))\n            }, {\n              default: withCtx(() => [createVNode(unref(RefreshLeft))]),\n              _: 1\n            }), createVNode(unref(ElIcon), {\n              onClick: _cache[4] || (_cache[4] = $event => handleActions(\"clockwise\"))\n            }, {\n              default: withCtx(() => [createVNode(unref(RefreshRight))]),\n              _: 1\n            })])], 2)], 2), createCommentVNode(\" CANVAS \"), createElementVNode(\"div\", {\n              class: normalizeClass(unref(ns).e(\"canvas\"))\n            }, [loadError.value && _ctx.$slots[\"viewer-error\"] ? renderSlot(_ctx.$slots, \"viewer-error\", {\n              key: 0,\n              activeIndex: activeIndex.value,\n              src: currentImg.value\n            }) : (openBlock(), createElementBlock(\"img\", {\n              ref_key: \"imgRef\",\n              ref: imgRef,\n              key: currentImg.value,\n              src: currentImg.value,\n              style: normalizeStyle(imgStyle.value),\n              class: normalizeClass(unref(ns).e(\"img\")),\n              crossorigin: _ctx.crossorigin,\n              onLoad: handleImgLoad,\n              onError: handleImgError,\n              onMousedown: handleMouseDown,\n              onTouchstart: handleTouchStart\n            }, null, 46, _hoisted_1))], 2), renderSlot(_ctx.$slots, \"default\")]),\n            _: 3\n          }, 8, [\"focus-trap-el\"])], 6)]),\n          _: 3\n        })]),\n        _: 3\n      }, 8, [\"disabled\"]);\n    };\n  }\n});\nvar ImageViewer = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue\"]]);\nexport { ImageViewer as default };","map":{"version":3,"names":["modes","CONTAIN","name","icon","markRaw","FullScreen","ORIGINAL","ScaleToOriginal","props","__props","emit","__emit","stopWheelListener","t","useLocale","ns","useNamespace","nextZIndex","useZIndex","wrapper","ref","imgRef","scopeEventListener","effectScope","scaleClamped","computed","scale","minScale","maxScale","clamp","loading","loadError","visible","activeIndex","initialIndex","mode","shallowRef","transform","value","deg","offsetX","offsetY","enableTransition","zIndex","_a","useLockscreen","isSingle","urlList","length","isFirst","isLast","currentImg","arrowPrevKls","e","is","infinite","arrowNextKls","imgStyle","translateX","translateY","radian","Math","PI","cosRadian","cos","sinRadian","sin","style","transition","maxWidth","maxHeight","progress","hide","unregisterEventListener","registerEventListener","keydownHandler","throttle","code","getEventCode","EVENT_CODE","esc","closeOnPressEscape","space","toggleMode","left","prev","up","handleActions","right","next","down","mousewheelHandler","delta","deltaY","deltaX","zoomRate","run","useEventListener","document","stop","handleImgLoad","handleImgError","target","alt","handleMouseDown","button","startX","pageX","startY","pageY","dragHandler","ev","removeMousemove","removeMouseup","preventDefault","handleTouchStart","touches","targetTouch","removeTouchmove","removeTouchend","reset","modeNames","keysOf","modeValues","Object","values","currentMode","index","findIndex","i","nextIndex","setActiveItem","len","action","options","rotateDeg","Number","parseFloat","toFixed","onFocusoutPrevented","event","_a2","detail","focusReason","onCloseRequested","wheelHandler","ctrlKey","watch","val","nextTick","$img","complete","onMounted","passive","__expose","createBlock","unref","ElTeleport","to","disabled","_ctx","teleported","default","withCtx","createVNode","Transition","appear","createElementVNode","ref_key","tabindex","class","normalizeClass","normalizeStyle","ElFocusTrap","loop","trapped","onReleaseRequested","onClick","_cache","withModifiers","$event","hideOnClickModal","createCommentVNode","ElIcon","Close","_","openBlock","createElementBlock","Fragment","key","ArrowLeft","ArrowRight","$slots","showProgress","renderSlot","total","createTextVNode","toDisplayString","actions","ZoomOut","ZoomIn","resolveDynamicComponent","RefreshLeft","RefreshRight","src","crossorigin","onLoad","onError","onMousedown","onTouchstart","_hoisted_1"],"sources":["../../../../../../packages/components/image-viewer/src/image-viewer.vue"],"sourcesContent":["<template>\n  <el-teleport to=\"body\" :disabled=\"!teleported\">\n    <transition name=\"viewer-fade\" appear>\n      <div\n        ref=\"wrapper\"\n        :tabindex=\"-1\"\n        :class=\"ns.e('wrapper')\"\n        :style=\"{ zIndex }\"\n      >\n        <el-focus-trap\n          loop\n          trapped\n          :focus-trap-el=\"wrapper\"\n          focus-start-el=\"container\"\n          @focusout-prevented=\"onFocusoutPrevented\"\n          @release-requested=\"onCloseRequested\"\n        >\n          <div :class=\"ns.e('mask')\" @click.self=\"hideOnClickModal && hide()\" />\n\n          <!-- CLOSE -->\n          <span :class=\"[ns.e('btn'), ns.e('close')]\" @click=\"hide\">\n            <el-icon>\n              <Close />\n            </el-icon>\n          </span>\n\n          <!-- ARROW -->\n          <template v-if=\"!isSingle\">\n            <span :class=\"arrowPrevKls\" @click=\"prev\">\n              <el-icon>\n                <ArrowLeft />\n              </el-icon>\n            </span>\n            <span :class=\"arrowNextKls\" @click=\"next\">\n              <el-icon>\n                <ArrowRight />\n              </el-icon>\n            </span>\n          </template>\n          <div\n            v-if=\"$slots.progress || showProgress\"\n            :class=\"[ns.e('btn'), ns.e('progress')]\"\n          >\n            <slot\n              name=\"progress\"\n              :active-index=\"activeIndex\"\n              :total=\"urlList.length\"\n            >\n              {{ progress }}\n            </slot>\n          </div>\n          <!-- ACTIONS -->\n          <div :class=\"[ns.e('btn'), ns.e('actions')]\">\n            <div :class=\"ns.e('actions__inner')\">\n              <slot\n                name=\"toolbar\"\n                :actions=\"handleActions\"\n                :prev=\"prev\"\n                :next=\"next\"\n                :reset=\"toggleMode\"\n                :active-index=\"activeIndex\"\n                :set-active-item=\"setActiveItem\"\n              >\n                <el-icon @click=\"handleActions('zoomOut')\">\n                  <ZoomOut />\n                </el-icon>\n                <el-icon @click=\"handleActions('zoomIn')\">\n                  <ZoomIn />\n                </el-icon>\n                <i :class=\"ns.e('actions__divider')\" />\n                <el-icon @click=\"toggleMode\">\n                  <component :is=\"mode.icon\" />\n                </el-icon>\n                <i :class=\"ns.e('actions__divider')\" />\n                <el-icon @click=\"handleActions('anticlockwise')\">\n                  <RefreshLeft />\n                </el-icon>\n                <el-icon @click=\"handleActions('clockwise')\">\n                  <RefreshRight />\n                </el-icon>\n              </slot>\n            </div>\n          </div>\n          <!-- CANVAS -->\n          <div :class=\"ns.e('canvas')\">\n            <slot\n              v-if=\"loadError && $slots['viewer-error']\"\n              name=\"viewer-error\"\n              :active-index=\"activeIndex\"\n              :src=\"currentImg\"\n            />\n            <img\n              v-else\n              ref=\"imgRef\"\n              :key=\"currentImg\"\n              :src=\"currentImg\"\n              :style=\"imgStyle\"\n              :class=\"ns.e('img')\"\n              :crossorigin=\"crossorigin\"\n              @load=\"handleImgLoad\"\n              @error=\"handleImgError\"\n              @mousedown=\"handleMouseDown\"\n              @touchstart=\"handleTouchStart\"\n            />\n          </div>\n          <slot />\n        </el-focus-trap>\n      </div>\n    </transition>\n  </el-teleport>\n</template>\n\n<script lang=\"ts\" setup>\nimport {\n  computed,\n  effectScope,\n  markRaw,\n  nextTick,\n  onMounted,\n  ref,\n  shallowRef,\n  watch,\n} from 'vue'\nimport { clamp, useEventListener } from '@vueuse/core'\nimport { throttle } from 'lodash-unified'\nimport {\n  useLocale,\n  useLockscreen,\n  useNamespace,\n  useZIndex,\n} from '@element-plus/hooks'\nimport { EVENT_CODE } from '@element-plus/constants'\nimport { getEventCode, keysOf } from '@element-plus/utils'\nimport ElFocusTrap from '@element-plus/components/focus-trap'\nimport ElTeleport from '@element-plus/components/teleport'\nimport ElIcon from '@element-plus/components/icon'\nimport {\n  ArrowLeft,\n  ArrowRight,\n  Close,\n  FullScreen,\n  RefreshLeft,\n  RefreshRight,\n  ScaleToOriginal,\n  ZoomIn,\n  ZoomOut,\n} from '@element-plus/icons-vue'\nimport { imageViewerEmits, imageViewerProps } from './image-viewer'\n\nimport type { CSSProperties } from 'vue'\nimport type { ImageViewerAction, ImageViewerMode } from './image-viewer'\n\nconst modes: Record<'CONTAIN' | 'ORIGINAL', ImageViewerMode> = {\n  CONTAIN: {\n    name: 'contain',\n    icon: markRaw(FullScreen),\n  },\n  ORIGINAL: {\n    name: 'original',\n    icon: markRaw(ScaleToOriginal),\n  },\n}\n\ndefineOptions({\n  name: 'ElImageViewer',\n})\n\nconst props = defineProps(imageViewerProps)\nconst emit = defineEmits(imageViewerEmits)\n\nlet stopWheelListener: (() => void) | undefined\n\nconst { t } = useLocale()\nconst ns = useNamespace('image-viewer')\nconst { nextZIndex } = useZIndex()\nconst wrapper = ref<HTMLDivElement>()\nconst imgRef = ref<HTMLImageElement>()\n\nconst scopeEventListener = effectScope()\n\nconst scaleClamped = computed(() => {\n  const { scale, minScale, maxScale } = props\n  return clamp(scale, minScale, maxScale)\n})\n\nconst loading = ref(true)\nconst loadError = ref(false)\nconst visible = ref(false)\nconst activeIndex = ref(props.initialIndex)\nconst mode = shallowRef<ImageViewerMode>(modes.CONTAIN)\nconst transform = ref({\n  scale: scaleClamped.value,\n  deg: 0,\n  offsetX: 0,\n  offsetY: 0,\n  enableTransition: false,\n})\nconst zIndex = ref(props.zIndex ?? nextZIndex())\n\nuseLockscreen(visible, { ns })\n\nconst isSingle = computed(() => {\n  const { urlList } = props\n  return urlList.length <= 1\n})\n\nconst isFirst = computed(() => activeIndex.value === 0)\n\nconst isLast = computed(() => activeIndex.value === props.urlList.length - 1)\n\nconst currentImg = computed(() => props.urlList[activeIndex.value])\n\nconst arrowPrevKls = computed(() => [\n  ns.e('btn'),\n  ns.e('prev'),\n  ns.is('disabled', !props.infinite && isFirst.value),\n])\n\nconst arrowNextKls = computed(() => [\n  ns.e('btn'),\n  ns.e('next'),\n  ns.is('disabled', !props.infinite && isLast.value),\n])\n\nconst imgStyle = computed(() => {\n  const { scale, deg, offsetX, offsetY, enableTransition } = transform.value\n  let translateX = offsetX / scale\n  let translateY = offsetY / scale\n\n  const radian = (deg * Math.PI) / 180\n  const cosRadian = Math.cos(radian)\n  const sinRadian = Math.sin(radian)\n  translateX = translateX * cosRadian + translateY * sinRadian\n  translateY = translateY * cosRadian - (offsetX / scale) * sinRadian\n\n  const style: CSSProperties = {\n    transform: `scale(${scale}) rotate(${deg}deg) translate(${translateX}px, ${translateY}px)`,\n    transition: enableTransition ? 'transform .3s' : '',\n  }\n  if (mode.value.name === modes.CONTAIN.name) {\n    style.maxWidth = style.maxHeight = '100%'\n  }\n  return style\n})\n\nconst progress = computed(\n  () => `${activeIndex.value + 1} / ${props.urlList.length}`\n)\n\nfunction hide() {\n  unregisterEventListener()\n  stopWheelListener?.()\n  visible.value = false\n  emit('close')\n}\n\nfunction registerEventListener() {\n  const keydownHandler = throttle((e: KeyboardEvent) => {\n    const code = getEventCode(e)\n\n    switch (code) {\n      // ESC\n      case EVENT_CODE.esc:\n        props.closeOnPressEscape && hide()\n        break\n      // SPACE\n      case EVENT_CODE.space:\n        toggleMode()\n        break\n      // LEFT_ARROW\n      case EVENT_CODE.left:\n        prev()\n        break\n      // UP_ARROW\n      case EVENT_CODE.up:\n        handleActions('zoomIn')\n        break\n      // RIGHT_ARROW\n      case EVENT_CODE.right:\n        next()\n        break\n      // DOWN_ARROW\n      case EVENT_CODE.down:\n        handleActions('zoomOut')\n        break\n    }\n  })\n  const mousewheelHandler = throttle((e: WheelEvent) => {\n    const delta = e.deltaY || e.deltaX\n    handleActions(delta < 0 ? 'zoomIn' : 'zoomOut', {\n      zoomRate: props.zoomRate,\n      enableTransition: false,\n    })\n  })\n\n  scopeEventListener.run(() => {\n    useEventListener(document, 'keydown', keydownHandler)\n    useEventListener(wrapper, 'wheel', mousewheelHandler)\n  })\n}\n\nfunction unregisterEventListener() {\n  scopeEventListener.stop()\n}\n\nfunction handleImgLoad() {\n  loading.value = false\n}\n\nfunction handleImgError(e: Event) {\n  loadError.value = true\n  loading.value = false\n  emit('error', e)\n  ;(e.target as HTMLImageElement).alt = t('el.image.error')\n}\n\nfunction handleMouseDown(e: MouseEvent) {\n  if (loading.value || e.button !== 0 || !wrapper.value) return\n  transform.value.enableTransition = false\n\n  const { offsetX, offsetY } = transform.value\n  const startX = e.pageX\n  const startY = e.pageY\n\n  const dragHandler = throttle((ev: MouseEvent) => {\n    transform.value = {\n      ...transform.value,\n      offsetX: offsetX + ev.pageX - startX,\n      offsetY: offsetY + ev.pageY - startY,\n    }\n  })\n  const removeMousemove = useEventListener(document, 'mousemove', dragHandler)\n  const removeMouseup = useEventListener(document, 'mouseup', () => {\n    removeMousemove()\n    removeMouseup()\n  })\n\n  e.preventDefault()\n}\n\nfunction handleTouchStart(e: TouchEvent) {\n  if (loading.value || !wrapper.value || e.touches.length !== 1) return\n  transform.value.enableTransition = false\n\n  const { offsetX, offsetY } = transform.value\n  const { pageX: startX, pageY: startY } = e.touches[0]\n\n  const dragHandler = throttle((ev: TouchEvent) => {\n    const targetTouch = ev.touches[0]\n    transform.value = {\n      ...transform.value,\n      offsetX: offsetX + targetTouch.pageX - startX,\n      offsetY: offsetY + targetTouch.pageY - startY,\n    }\n  })\n  const removeTouchmove = useEventListener(document, 'touchmove', dragHandler)\n  const removeTouchend = useEventListener(document, 'touchend', () => {\n    removeTouchmove()\n    removeTouchend()\n  })\n\n  e.preventDefault()\n}\n\nfunction reset() {\n  transform.value = {\n    scale: scaleClamped.value,\n    deg: 0,\n    offsetX: 0,\n    offsetY: 0,\n    enableTransition: false,\n  }\n}\n\nfunction toggleMode() {\n  if (loading.value || loadError.value) return\n\n  const modeNames = keysOf(modes)\n  const modeValues = Object.values(modes)\n  const currentMode = mode.value.name\n  const index = modeValues.findIndex((i) => i.name === currentMode)\n  const nextIndex = (index + 1) % modeNames.length\n  mode.value = modes[modeNames[nextIndex]]\n  reset()\n}\n\nfunction setActiveItem(index: number) {\n  loadError.value = false\n  const len = props.urlList.length\n  activeIndex.value = (index + len) % len\n}\n\nfunction prev() {\n  if (isFirst.value && !props.infinite) return\n  setActiveItem(activeIndex.value - 1)\n}\n\nfunction next() {\n  if (isLast.value && !props.infinite) return\n  setActiveItem(activeIndex.value + 1)\n}\n\nfunction handleActions(action: ImageViewerAction, options = {}) {\n  if (loading.value || loadError.value) return\n  const { minScale, maxScale } = props\n  const { zoomRate, rotateDeg, enableTransition } = {\n    zoomRate: props.zoomRate,\n    rotateDeg: 90,\n    enableTransition: true,\n    ...options,\n  }\n  switch (action) {\n    case 'zoomOut':\n      if (transform.value.scale > minScale) {\n        transform.value.scale = Number.parseFloat(\n          (transform.value.scale / zoomRate).toFixed(3)\n        )\n      }\n      break\n    case 'zoomIn':\n      if (transform.value.scale < maxScale) {\n        transform.value.scale = Number.parseFloat(\n          (transform.value.scale * zoomRate).toFixed(3)\n        )\n      }\n      break\n    case 'clockwise':\n      transform.value.deg += rotateDeg\n      emit('rotate', transform.value.deg)\n      break\n    case 'anticlockwise':\n      transform.value.deg -= rotateDeg\n      emit('rotate', transform.value.deg)\n      break\n  }\n  transform.value.enableTransition = enableTransition\n}\n\nfunction onFocusoutPrevented(event: CustomEvent) {\n  if (event.detail?.focusReason === 'pointer') {\n    event.preventDefault()\n  }\n}\n\nfunction onCloseRequested() {\n  if (props.closeOnPressEscape) {\n    hide()\n  }\n}\n\nfunction wheelHandler(e: WheelEvent) {\n  if (!e.ctrlKey) return\n\n  if (e.deltaY < 0) {\n    e.preventDefault()\n    return false\n  } else if (e.deltaY > 0) {\n    e.preventDefault()\n    return false\n  }\n}\n\nwatch(\n  () => scaleClamped.value,\n  (val) => {\n    transform.value.scale = val\n  }\n)\n\nwatch(currentImg, () => {\n  nextTick(() => {\n    const $img = imgRef.value\n    if (!$img?.complete) {\n      loading.value = true\n    }\n  })\n})\n\nwatch(activeIndex, (val) => {\n  reset()\n  emit('switch', val)\n})\n\nonMounted(() => {\n  visible.value = true\n  registerEventListener()\n\n  stopWheelListener = useEventListener('wheel', wheelHandler, {\n    passive: false,\n  })\n})\n\ndefineExpose({\n  /**\n   * @description manually switch image\n   */\n  setActiveItem,\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}