{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { getEventCode } from '../../../utils/dom/event.mjs';\nimport { EVENT_CODE } from '../../../constants/aria.mjs';\nconst MAP_KEY_TO_FOCUS_INTENT = {\n  ArrowLeft: \"prev\",\n  ArrowUp: \"prev\",\n  ArrowRight: \"next\",\n  ArrowDown: \"next\",\n  PageUp: \"first\",\n  Home: \"first\",\n  PageDown: \"last\",\n  End: \"last\"\n};\nconst getDirectionAwareKey = (key, dir) => {\n  if (dir !== \"rtl\") return key;\n  switch (key) {\n    case EVENT_CODE.right:\n      return EVENT_CODE.left;\n    case EVENT_CODE.left:\n      return EVENT_CODE.right;\n    default:\n      return key;\n  }\n};\nconst getFocusIntent = (event, orientation, dir) => {\n  const code = getEventCode(event);\n  const key = getDirectionAwareKey(code, dir);\n  if (orientation === \"vertical\" && [EVENT_CODE.left, EVENT_CODE.right].includes(key)) return void 0;\n  if (orientation === \"horizontal\" && [EVENT_CODE.up, EVENT_CODE.down].includes(key)) return void 0;\n  return MAP_KEY_TO_FOCUS_INTENT[key];\n};\nconst reorderArray = (array, atIdx) => {\n  return array.map((_, idx) => array[(idx + atIdx) % array.length]);\n};\nconst focusFirst = elements => {\n  const {\n    activeElement: prevActive\n  } = document;\n  for (const element of elements) {\n    if (element === prevActive) return;\n    element.focus();\n    if (prevActive !== document.activeElement) return;\n  }\n};\nexport { focusFirst, getFocusIntent, reorderArray };","map":{"version":3,"names":["MAP_KEY_TO_FOCUS_INTENT","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","PageUp","Home","PageDown","End","getDirectionAwareKey","key","dir","EVENT_CODE","right","left","getFocusIntent","event","orientation","code","getEventCode","includes","up","down","reorderArray","array","atIdx","map","_","idx","length","focusFirst","elements","activeElement","prevActive","document","element","focus"],"sources":["../../../../../../packages/components/roving-focus-group/src/utils.ts"],"sourcesContent":["import { EVENT_CODE } from '@element-plus/constants'\nimport { getEventCode } from '@element-plus/utils'\n\nimport type { HTMLAttributes } from 'vue'\n\ntype Orientation = HTMLAttributes['aria-orientation']\ntype Direction = 'ltr' | 'rtl'\ntype FocusIntent = 'first' | 'last' | 'prev' | 'next'\n\nconst MAP_KEY_TO_FOCUS_INTENT: Record<string, FocusIntent> = {\n  ArrowLeft: 'prev',\n  ArrowUp: 'prev',\n  ArrowRight: 'next',\n  ArrowDown: 'next',\n  PageUp: 'first',\n  Home: 'first',\n  PageDown: 'last',\n  End: 'last',\n}\n\nconst getDirectionAwareKey = (key: string, dir?: Direction) => {\n  if (dir !== 'rtl') return key\n\n  switch (key) {\n    case EVENT_CODE.right:\n      return EVENT_CODE.left\n    case EVENT_CODE.left:\n      return EVENT_CODE.right\n    default:\n      return key\n  }\n}\n\nexport const getFocusIntent = (\n  event: KeyboardEvent,\n  orientation?: Orientation,\n  dir?: Direction\n) => {\n  const code = getEventCode(event)\n  const key = getDirectionAwareKey(code, dir)\n  if (\n    orientation === 'vertical' &&\n    [EVENT_CODE.left, EVENT_CODE.right].includes(key)\n  )\n    return undefined\n  if (\n    orientation === 'horizontal' &&\n    [EVENT_CODE.up, EVENT_CODE.down].includes(key)\n  )\n    return undefined\n  return MAP_KEY_TO_FOCUS_INTENT[key]\n}\n\nexport const reorderArray = <T>(array: T[], atIdx: number) => {\n  return array.map((_, idx) => array[(idx + atIdx) % array.length])\n}\n\nexport const focusFirst = (elements: HTMLElement[]) => {\n  const { activeElement: prevActive } = document\n\n  for (const element of elements) {\n    if (element === prevActive) return\n    element.focus()\n    if (prevActive !== document.activeElement) return\n  }\n}\n"],"mappings":";;;;AASA,MAAMA,uBAAuD;EAC3DC,SAAW;EACXC,OAAS;EACTC,UAAY;EACZC,SAAW;EACXC,MAAQ;EACRC,IAAM;EACNC,QAAU;EACVC,GAAK;AACP;AAEA,MAAMC,oBAAA,GAAuBA,CAACC,GAAA,EAAaC,GAAoB;EAC7D,IAAIA,GAAQ,YAAc,OAAAD,GAAA;EAElB,QAAAA,GAAA;IAAA,KACDE,UAAW,CAAAC,KAAA;MACd,OAAOD,UAAW,CAAAE,IAAA;IAAA,KACfF,UAAW,CAAAE,IAAA;MACd,OAAOF,UAAW,CAAAC,KAAA;IAAA;MAEX,OAAAH,GAAA;EAAA;AAEb;AAEO,MAAMK,cAAiB,GAAAA,CAC5BC,KACA,EAAAC,WAAA,EACAN,GACG;EACG,MAAAO,IAAA,GAAOC,YAAA,CAAaH,KAAK;EACzB,MAAAN,GAAA,GAAMD,oBAAqB,CAAAS,IAAA,EAAMP,GAAG;EAExC,IAAAM,WAAA,KAAgB,cAChB,CAACL,UAAA,CAAWE,IAAA,EAAMF,UAAW,CAAAC,KAAK,CAAE,CAAAO,QAAA,CAASV,GAAG,GAEzC;EAEP,IAAAO,WAAA,KAAgB,gBAChB,CAACL,UAAA,CAAWS,EAAA,EAAIT,UAAW,CAAAU,IAAI,CAAE,CAAAF,QAAA,CAASV,GAAG,GAEtC;EACT,OAAOV,uBAAwB,CAAAU,GAAA;AACjC;AAEa,MAAAa,YAAA,GAAeA,CAAIC,KAAA,EAAYC,KAAkB;EACrD,OAAAD,KAAA,CAAME,GAAA,CAAI,CAACC,CAAA,EAAGC,GAAA,KAAQJ,KAAO,EAAAI,GAAA,GAAMH,KAAS,IAAAD,KAAA,CAAMK,MAAO;AAClE;AAEa,MAAAC,UAAA,GAAcC,QAA4B;EAC/C;IAAEC,aAAe,EAAAC;EAAA,CAAe,GAAAC,QAAA;EAEtC,WAAWC,OAAA,IAAWJ,QAAU;IAC9B,IAAII,OAAY,KAAAF,UAAA,EAAY;IAC5BE,OAAA,CAAQC,KAAM;IACd,IAAIH,UAAA,KAAeC,QAAS,CAAAF,aAAA,EAAe;EAAA;AAE/C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}