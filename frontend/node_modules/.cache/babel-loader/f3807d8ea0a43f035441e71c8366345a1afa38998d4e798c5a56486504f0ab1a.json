{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.every.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport { getCurrentInstance, inject, ref, computed } from 'vue';\nimport { isEqual } from 'lodash-unified';\nimport { buildProps, definePropType } from '../../utils/vue/props/runtime.mjs';\nimport { isFunction, isArray } from '@vue/shared';\nimport { debugWarn } from '../../utils/error.mjs';\nconst emptyValuesContextKey = Symbol(\"emptyValuesContextKey\");\nconst SCOPE = \"use-empty-values\";\nconst DEFAULT_EMPTY_VALUES = [\"\", void 0, null];\nconst DEFAULT_VALUE_ON_CLEAR = void 0;\nconst useEmptyValuesProps = buildProps({\n  emptyValues: Array,\n  valueOnClear: {\n    type: definePropType([String, Number, Boolean, Function]),\n    default: void 0,\n    validator: val => {\n      val = isFunction(val) ? val() : val;\n      if (isArray(val)) {\n        return val.every(item => !item);\n      }\n      return !val;\n    }\n  }\n});\nconst useEmptyValues = (props, defaultValue) => {\n  const config = getCurrentInstance() ? inject(emptyValuesContextKey, ref({})) : ref({});\n  const emptyValues = computed(() => props.emptyValues || config.value.emptyValues || DEFAULT_EMPTY_VALUES);\n  const valueOnClear = computed(() => {\n    if (isFunction(props.valueOnClear)) {\n      return props.valueOnClear();\n    } else if (props.valueOnClear !== void 0) {\n      return props.valueOnClear;\n    } else if (isFunction(config.value.valueOnClear)) {\n      return config.value.valueOnClear();\n    } else if (config.value.valueOnClear !== void 0) {\n      return config.value.valueOnClear;\n    }\n    return defaultValue !== void 0 ? defaultValue : DEFAULT_VALUE_ON_CLEAR;\n  });\n  const isEmptyValue = value => {\n    let result = true;\n    if (isArray(value)) {\n      result = emptyValues.value.some(emptyValue => {\n        return isEqual(value, emptyValue);\n      });\n    } else {\n      result = emptyValues.value.includes(value);\n    }\n    return result;\n  };\n  if (!isEmptyValue(valueOnClear.value)) {\n    debugWarn(SCOPE, \"value-on-clear should be a value of empty-values\");\n  }\n  return {\n    emptyValues,\n    valueOnClear,\n    isEmptyValue\n  };\n};\nexport { DEFAULT_EMPTY_VALUES, DEFAULT_VALUE_ON_CLEAR, SCOPE, emptyValuesContextKey, useEmptyValues, useEmptyValuesProps };","map":{"version":3,"names":["emptyValuesContextKey","Symbol","SCOPE","DEFAULT_EMPTY_VALUES","DEFAULT_VALUE_ON_CLEAR","useEmptyValuesProps","buildProps","emptyValues","Array","valueOnClear","type","definePropType","String","Number","Boolean","Function","default","validator","val","isFunction","isArray","every","item","useEmptyValues","props","defaultValue","config","getCurrentInstance","inject","ref","computed","value","isEmptyValue","result","some","emptyValue","isEqual","includes","debugWarn"],"sources":["../../../../../packages/hooks/use-empty-values/index.ts"],"sourcesContent":["import { computed, getCurrentInstance, inject, ref } from 'vue'\nimport {\n  buildProps,\n  debugWarn,\n  definePropType,\n  isArray,\n  isFunction,\n} from '@element-plus/utils'\nimport { isEqual } from 'lodash-unified'\n\nimport type { ExtractPropTypes, InjectionKey, Ref } from 'vue'\n\ntype EmptyValuesContext = ExtractPropTypes<typeof useEmptyValuesProps>\n\nexport const emptyValuesContextKey: InjectionKey<Ref<EmptyValuesContext>> =\n  Symbol('emptyValuesContextKey')\nexport const SCOPE = 'use-empty-values'\nexport const DEFAULT_EMPTY_VALUES = ['', undefined, null]\nexport const DEFAULT_VALUE_ON_CLEAR = undefined\n\nexport const useEmptyValuesProps = buildProps({\n  /**\n   * @description empty values supported by the component\n   */\n  emptyValues: Array,\n  /**\n   * @description return value when cleared, if you want to set `undefined`, use `() => undefined`\n   */\n  valueOnClear: {\n    /* eslint-disable-next-line @typescript-eslint/no-unsafe-function-type */\n    type: definePropType<string | number | boolean | Function | null>([\n      String,\n      Number,\n      Boolean,\n      Function,\n    ]),\n    default: undefined,\n    validator: (val: unknown) => {\n      val = isFunction(val) ? val() : val\n      if (isArray(val)) {\n        return val.every((item) => !item)\n      }\n      return !val\n    },\n  },\n} as const)\n\nexport const useEmptyValues = (\n  props: EmptyValuesContext,\n  defaultValue?: null | undefined\n) => {\n  const config = getCurrentInstance()\n    ? inject(emptyValuesContextKey, ref<EmptyValuesContext>({}))\n    : ref<EmptyValuesContext>({})\n\n  const emptyValues = computed(\n    () => props.emptyValues || config.value.emptyValues || DEFAULT_EMPTY_VALUES\n  )\n\n  const valueOnClear = computed(() => {\n    // function is used for undefined cause undefined can't be a value of prop\n    if (isFunction(props.valueOnClear)) {\n      return props.valueOnClear()\n    } else if (props.valueOnClear !== undefined) {\n      return props.valueOnClear\n    } else if (isFunction(config.value.valueOnClear)) {\n      return config.value.valueOnClear()\n    } else if (config.value.valueOnClear !== undefined) {\n      return config.value.valueOnClear\n    }\n    return defaultValue !== undefined ? defaultValue : DEFAULT_VALUE_ON_CLEAR\n  })\n\n  const isEmptyValue = (value: unknown) => {\n    let result = true\n    if (isArray(value)) {\n      result = emptyValues.value.some((emptyValue) => {\n        return isEqual(value, emptyValue)\n      })\n    } else {\n      result = emptyValues.value.includes(value)\n    }\n    return result\n  }\n\n  if (!isEmptyValue(valueOnClear.value)) {\n    debugWarn(SCOPE, 'value-on-clear should be a value of empty-values')\n  }\n\n  return {\n    emptyValues,\n    valueOnClear,\n    isEmptyValue,\n  }\n}\n"],"mappings":";;;;;;;;AAca,MAAAA,qBAAA,GACXC,MAAA,CAAO,uBAAuB;AACzB,MAAMC,KAAQ;AACd,MAAMC,oBAAuB,IAAC,EAAI,UAAW,IAAI;AACjD,MAAMC,sBAAyB;AAE/B,MAAMC,mBAAA,GAAsBC,UAAW;EAI5CC,WAAa,EAAAC,KAAA;EAIbC,YAAc;IAEZC,IAAA,EAAMC,cAA4D,EAChEC,MAAA,EACAC,MAAA,EACAC,OAAA,EACAC,QAAA,CACD;IACDC,OAAS;IACTC,SAAA,EAAYC,GAAiB;MAC3BA,GAAA,GAAMC,UAAW,CAAAD,GAAG,CAAI,GAAAA,GAAA,EAAQ,GAAAA,GAAA;MAC5B,IAAAE,OAAA,CAAQF,GAAG,CAAG;QAChB,OAAOA,GAAI,CAAAG,KAAA,CAAOC,IAAA,IAAS,CAACA,IAAI;MAAA;MAElC,OAAO,CAACJ,GAAA;IAAA;EACV;AAEJ,CAAU;AAEG,MAAAK,cAAA,GAAiBA,CAC5BC,KAAA,EACAC,YACG;EACH,MAAMC,MAAS,GAAAC,kBAAA,EACX,GAAAC,MAAA,CAAO5B,qBAAuB,EAAA6B,GAAA,CAAwB,EAAE,CAAC,IACzDA,GAAwB,GAAE;EAE9B,MAAMtB,WAAc,GAAAuB,QAAA,CAClB,MAAMN,KAAA,CAAMjB,WAAe,IAAAmB,MAAA,CAAOK,KAAA,CAAMxB,WAAe,IAAAJ,oBAAA,CACzD;EAEM,MAAAM,YAAA,GAAeqB,QAAA,CAAS,MAAM;IAE9B,IAAAX,UAAA,CAAWK,KAAM,CAAAf,YAAY,CAAG;MAClC,OAAOe,KAAA,CAAMf,YAAa;IAAA,CAC5B,UAAWe,KAAM,CAAAf,YAAA,KAAiB,KAAW;MAC3C,OAAOe,KAAM,CAAAf,YAAA;IAAA,CACJ,UAAAU,UAAA,CAAWO,MAAO,CAAAK,KAAA,CAAMtB,YAAY,CAAG;MACzC,OAAAiB,MAAA,CAAOK,KAAA,CAAMtB,YAAa;IAAA,CACxB,UAAAiB,MAAA,CAAOK,KAAM,CAAAtB,YAAA,KAAiB,KAAW;MAClD,OAAOiB,MAAA,CAAOK,KAAM,CAAAtB,YAAA;IAAA;IAEf,OAAAgB,YAAA,KAAiB,SAAYA,YAAe,GAAArB,sBAAA;EAAA,CACpD;EAEK,MAAA4B,YAAA,GAAgBD,KAAmB;IACvC,IAAIE,MAAS;IACT,IAAAb,OAAA,CAAQW,KAAK,CAAG;MAClBE,MAAA,GAAS1B,WAAY,CAAAwB,KAAA,CAAMG,IAAK,CAACC,UAAe;QACvC,OAAAC,OAAA,CAAQL,KAAA,EAAOI,UAAU;MAAA,CACjC;IAAA,CACI;MACIF,MAAA,GAAA1B,WAAA,CAAYwB,KAAM,CAAAM,QAAA,CAASN,KAAK;IAAA;IAEpC,OAAAE,MAAA;EAAA,CACT;EAEA,IAAI,CAACD,YAAA,CAAavB,YAAa,CAAAsB,KAAK,CAAG;IACrCO,SAAA,CAAUpC,KAAA,EAAO,kDAAkD;EAAA;EAG9D;IACLK,WAAA;IACAE,YAAA;IACAuB;EAAA,CACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}