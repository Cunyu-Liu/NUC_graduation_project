{"ast":null,"code":"import { getCurrentInstance, inject, unref } from 'vue';\nimport { isClient, computedEager } from '@vueuse/core';\nimport { useGetDerivedNamespace } from '../use-namespace/index.mjs';\nimport { debugWarn } from '../../utils/error.mjs';\nconst defaultIdInjection = {\n  prefix: Math.floor(Math.random() * 1e4),\n  current: 0\n};\nconst ID_INJECTION_KEY = Symbol(\"elIdInjection\");\nconst useIdInjection = () => {\n  return getCurrentInstance() ? inject(ID_INJECTION_KEY, defaultIdInjection) : defaultIdInjection;\n};\nconst useId = deterministicId => {\n  const idInjection = useIdInjection();\n  if (!isClient && idInjection === defaultIdInjection) {\n    debugWarn(\"IdInjection\", `Looks like you are using server rendering, you must provide a id provider to ensure the hydration process to be succeed\nusage: app.provide(ID_INJECTION_KEY, {\n  prefix: number,\n  current: number,\n})`);\n  }\n  const namespace = useGetDerivedNamespace();\n  const idRef = computedEager(() => unref(deterministicId) || `${namespace.value}-id-${idInjection.prefix}-${idInjection.current++}`);\n  return idRef;\n};\nexport { ID_INJECTION_KEY, useId, useIdInjection };","map":{"version":3,"names":["defaultIdInjection","prefix","Math","floor","random","current","ID_INJECTION_KEY","Symbol","useIdInjection","getCurrentInstance","inject","useId","deterministicId","idInjection","isClient","debugWarn","namespace","useGetDerivedNamespace","idRef","computedEager","unref","value"],"sources":["../../../../../packages/hooks/use-id/index.ts"],"sourcesContent":["import { getCurrentInstance, inject, unref } from 'vue'\nimport { computedEager } from '@vueuse/core'\nimport { debugWarn, isClient } from '@element-plus/utils'\nimport { useGetDerivedNamespace } from '../use-namespace'\n\nimport type { MaybeRef } from '@vueuse/core'\nimport type { InjectionKey, Ref } from 'vue'\n\nexport type ElIdInjectionContext = {\n  prefix: number\n  current: number\n}\n\nconst defaultIdInjection = {\n  prefix: Math.floor(Math.random() * 10000),\n  current: 0,\n}\n\nexport const ID_INJECTION_KEY: InjectionKey<ElIdInjectionContext> =\n  Symbol('elIdInjection')\n\nexport const useIdInjection = (): ElIdInjectionContext => {\n  return getCurrentInstance()\n    ? inject(ID_INJECTION_KEY, defaultIdInjection)\n    : defaultIdInjection\n}\n\nexport const useId = (deterministicId?: MaybeRef<string>): Ref<string> => {\n  const idInjection = useIdInjection()\n  if (!isClient && idInjection === defaultIdInjection) {\n    debugWarn(\n      'IdInjection',\n      `Looks like you are using server rendering, you must provide a id provider to ensure the hydration process to be succeed\nusage: app.provide(ID_INJECTION_KEY, {\n  prefix: number,\n  current: number,\n})`\n    )\n  }\n\n  const namespace = useGetDerivedNamespace()\n\n  // NOTE: Here we use `computedEager` to calculate the id value immediately, avoiding inconsistent id generation due to the lazy feature of `computed` when server rendering.\n  const idRef = computedEager(\n    () =>\n      unref(deterministicId) ||\n      `${namespace.value}-id-${idInjection.prefix}-${idInjection.current++}`\n  )\n\n  return idRef\n}\n"],"mappings":";;;;AAaA,MAAMA,kBAAqB;EACzBC,MAAA,EAAQC,IAAK,CAAAC,KAAA,CAAMD,IAAK,CAAAE,MAAA,KAAW,GAAK;EACxCC,OAAS;AACX;AAEa,MAAAC,gBAAA,GACXC,MAAA,CAAO,eAAe;AAEjB,MAAMC,cAAA,GAAiBA,CAAA,KAA4B;EACxD,OAAOC,kBAAmB,KACtBC,MAAO,CAAAJ,gBAAA,EAAkBN,kBAAkB,CAC3C,GAAAA,kBAAA;AACN;AAEa,MAAAW,KAAA,GAASC,eAAoD;EACxE,MAAMC,WAAA,GAAcL,cAAe;EAC/B,KAACM,QAAY,IAAAD,WAAA,KAAgBb,kBAAoB;IACnDe,SAAA,CACE,eACA;AAAA;AAAA;AAAA;AAAA,IAKF;EAAA;EAGF,MAAMC,SAAA,GAAYC,sBAAuB;EAGzC,MAAMC,KAAQ,GAAAC,aAAA,CACZ,MACEC,KAAA,CAAMR,eAAe,KACrB,GAAGI,SAAU,CAAAK,KAAA,OAAYR,WAAY,CAAAZ,MAAA,IAAUY,WAAY,CAAAR,OAAA,KAC/D;EAEO,OAAAa,KAAA;AACT","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}