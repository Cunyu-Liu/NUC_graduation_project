{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.every.js\";\nimport { defineComponent, ref, computed, watch, openBlock, createElementBlock, normalizeClass, unref, renderSlot, createCommentVNode, withDirectives, createVNode, withCtx, Fragment, renderList, withModifiers, createElementVNode, toDisplayString, vShow, createTextVNode, nextTick } from 'vue';\nimport { ElScrollbar } from '../../scrollbar/index.mjs';\nimport { mentionDropdownProps, mentionDropdownEmits } from './mention-dropdown.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useLocale } from '../../../hooks/use-locale/index.mjs';\nimport { scrollIntoView } from '../../../utils/dom/scroll.mjs';\nconst _hoisted_1 = [\"id\", \"aria-disabled\", \"aria-selected\", \"onMousemove\", \"onClick\"];\nconst _sfc_main = defineComponent({\n  ...{\n    name: \"ElMentionDropdown\"\n  },\n  __name: \"mention-dropdown\",\n  props: mentionDropdownProps,\n  emits: mentionDropdownEmits,\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    const props = __props;\n    const emit = __emit;\n    const ns = useNamespace(\"mention\");\n    const {\n      t\n    } = useLocale();\n    const hoveringIndex = ref(-1);\n    const scrollbarRef = ref();\n    const optionRefs = ref();\n    const dropdownRef = ref();\n    const optionkls = (item, index) => [ns.be(\"dropdown\", \"item\"), ns.is(\"hovering\", hoveringIndex.value === index), ns.is(\"disabled\", item.disabled || props.disabled)];\n    const handleSelect = item => {\n      if (item.disabled || props.disabled) return;\n      emit(\"select\", item);\n    };\n    const handleMouseEnter = index => {\n      hoveringIndex.value = index;\n    };\n    const filteredAllDisabled = computed(() => props.disabled || props.options.every(item => item.disabled));\n    const hoverOption = computed(() => props.options[hoveringIndex.value]);\n    const selectHoverOption = () => {\n      if (!hoverOption.value) return;\n      emit(\"select\", hoverOption.value);\n    };\n    const navigateOptions = direction => {\n      const {\n        options\n      } = props;\n      if (options.length === 0 || filteredAllDisabled.value) return;\n      if (direction === \"next\") {\n        hoveringIndex.value++;\n        if (hoveringIndex.value === options.length) {\n          hoveringIndex.value = 0;\n        }\n      } else if (direction === \"prev\") {\n        hoveringIndex.value--;\n        if (hoveringIndex.value < 0) {\n          hoveringIndex.value = options.length - 1;\n        }\n      }\n      const option = options[hoveringIndex.value];\n      if (option.disabled) {\n        navigateOptions(direction);\n        return;\n      }\n      nextTick(() => scrollToOption(option));\n    };\n    const scrollToOption = option => {\n      var _a, _b, _c, _d;\n      const {\n        options\n      } = props;\n      const index = options.findIndex(item => item.value === option.value);\n      const target = (_a = optionRefs.value) == null ? void 0 : _a[index];\n      if (target) {\n        const menu = (_c = (_b = dropdownRef.value) == null ? void 0 : _b.querySelector) == null ? void 0 : _c.call(_b, `.${ns.be(\"dropdown\", \"wrap\")}`);\n        if (menu) {\n          scrollIntoView(menu, target);\n        }\n      }\n      (_d = scrollbarRef.value) == null ? void 0 : _d.handleScroll();\n    };\n    const resetHoveringIndex = () => {\n      if (filteredAllDisabled.value || props.options.length === 0) {\n        hoveringIndex.value = -1;\n      } else {\n        hoveringIndex.value = 0;\n      }\n    };\n    watch(() => props.options, resetHoveringIndex, {\n      immediate: true\n    });\n    __expose({\n      hoveringIndex,\n      navigateOptions,\n      selectHoverOption,\n      hoverOption\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", {\n        ref_key: \"dropdownRef\",\n        ref: dropdownRef,\n        class: normalizeClass(unref(ns).b(\"dropdown\"))\n      }, [_ctx.$slots.header ? (openBlock(), createElementBlock(\"div\", {\n        key: 0,\n        class: normalizeClass(unref(ns).be(\"dropdown\", \"header\"))\n      }, [renderSlot(_ctx.$slots, \"header\")], 2)) : createCommentVNode(\"v-if\", true), withDirectives(createVNode(unref(ElScrollbar), {\n        id: _ctx.contentId,\n        ref_key: \"scrollbarRef\",\n        ref: scrollbarRef,\n        tag: \"ul\",\n        \"wrap-class\": unref(ns).be(\"dropdown\", \"wrap\"),\n        \"view-class\": unref(ns).be(\"dropdown\", \"list\"),\n        role: \"listbox\",\n        \"aria-label\": _ctx.ariaLabel,\n        \"aria-orientation\": \"vertical\"\n      }, {\n        default: withCtx(() => [(openBlock(true), createElementBlock(Fragment, null, renderList(_ctx.options, (item, index) => {\n          return openBlock(), createElementBlock(\"li\", {\n            id: `${_ctx.contentId}-${index}`,\n            ref_for: true,\n            ref_key: \"optionRefs\",\n            ref: optionRefs,\n            key: index,\n            class: normalizeClass(optionkls(item, index)),\n            role: \"option\",\n            \"aria-disabled\": item.disabled || _ctx.disabled || void 0,\n            \"aria-selected\": hoveringIndex.value === index,\n            onMousemove: $event => handleMouseEnter(index),\n            onClick: withModifiers($event => handleSelect(item), [\"stop\"])\n          }, [renderSlot(_ctx.$slots, \"label\", {\n            item,\n            index\n          }, () => {\n            var _a;\n            return [createElementVNode(\"span\", null, toDisplayString((_a = item.label) != null ? _a : item.value), 1)];\n          })], 42, _hoisted_1);\n        }), 128))]),\n        _: 3\n      }, 8, [\"id\", \"wrap-class\", \"view-class\", \"aria-label\"]), [[vShow, _ctx.options.length > 0 && !_ctx.loading]]), _ctx.loading ? (openBlock(), createElementBlock(\"div\", {\n        key: 1,\n        class: normalizeClass(unref(ns).be(\"dropdown\", \"loading\"))\n      }, [renderSlot(_ctx.$slots, \"loading\", {}, () => [createTextVNode(toDisplayString(unref(t)(\"el.mention.loading\")), 1)])], 2)) : createCommentVNode(\"v-if\", true), _ctx.$slots.footer ? (openBlock(), createElementBlock(\"div\", {\n        key: 2,\n        class: normalizeClass(unref(ns).be(\"dropdown\", \"footer\"))\n      }, [renderSlot(_ctx.$slots, \"footer\")], 2)) : createCommentVNode(\"v-if\", true)], 2);\n    };\n  }\n});\nvar ElMentionDropdown = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/mention/src/mention-dropdown.vue\"]]);\nexport { ElMentionDropdown as default };","map":{"version":3,"names":["props","__props","emit","__emit","ns","useNamespace","t","useLocale","hoveringIndex","ref","scrollbarRef","optionRefs","dropdownRef","optionkls","item","index","be","is","value","disabled","handleSelect","handleMouseEnter","filteredAllDisabled","computed","options","every","hoverOption","selectHoverOption","navigateOptions","direction","length","option","nextTick","scrollToOption","findIndex","target","_a","menu","_c","_b","querySelector","call","scrollIntoView","_d","handleScroll","resetHoveringIndex","watch","immediate","__expose","openBlock","createElementBlock","ref_key","class","normalizeClass","unref","b","_ctx","$slots","header","key","renderSlot","createVNode","ElScrollbar","id","contentId","tag","role","ariaLabel","default","withCtx","Fragment","renderList","ref_for","onMousemove","$event","onClick","withModifiers","createElementVNode","toDisplayString","label","_hoisted_1","loading","createTextVNode","footer"],"sources":["../../../../../../packages/components/mention/src/mention-dropdown.vue"],"sourcesContent":["<template>\n  <div ref=\"dropdownRef\" :class=\"ns.b('dropdown')\">\n    <div v-if=\"$slots.header\" :class=\"ns.be('dropdown', 'header')\">\n      <slot name=\"header\" />\n    </div>\n    <el-scrollbar\n      v-show=\"options.length > 0 && !loading\"\n      :id=\"contentId\"\n      ref=\"scrollbarRef\"\n      tag=\"ul\"\n      :wrap-class=\"ns.be('dropdown', 'wrap')\"\n      :view-class=\"ns.be('dropdown', 'list')\"\n      role=\"listbox\"\n      :aria-label=\"ariaLabel\"\n      aria-orientation=\"vertical\"\n    >\n      <li\n        v-for=\"(item, index) in options\"\n        :id=\"`${contentId}-${index}`\"\n        ref=\"optionRefs\"\n        :key=\"index\"\n        :class=\"optionkls(item, index)\"\n        role=\"option\"\n        :aria-disabled=\"item.disabled || disabled || undefined\"\n        :aria-selected=\"hoveringIndex === index\"\n        @mousemove=\"handleMouseEnter(index)\"\n        @click.stop=\"handleSelect(item)\"\n      >\n        <slot name=\"label\" :item=\"item\" :index=\"index\">\n          <span>{{ item.label ?? item.value }}</span>\n        </slot>\n      </li>\n    </el-scrollbar>\n    <div v-if=\"loading\" :class=\"ns.be('dropdown', 'loading')\">\n      <slot name=\"loading\"> {{ t('el.mention.loading') }} </slot>\n    </div>\n    <div v-if=\"$slots.footer\" :class=\"ns.be('dropdown', 'footer')\">\n      <slot name=\"footer\" />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, nextTick, ref, watch } from 'vue'\nimport { useLocale, useNamespace } from '@element-plus/hooks'\nimport { scrollIntoView } from '@element-plus/utils'\nimport ElScrollbar from '@element-plus/components/scrollbar'\nimport { mentionDropdownEmits, mentionDropdownProps } from './mention-dropdown'\n\nimport type { MentionOption } from './types'\n\ndefineOptions({\n  name: 'ElMentionDropdown',\n})\n\nconst props = defineProps(mentionDropdownProps)\nconst emit = defineEmits(mentionDropdownEmits)\n\nconst ns = useNamespace('mention')\nconst { t } = useLocale()\nconst hoveringIndex = ref(-1)\n\nconst scrollbarRef = ref<InstanceType<typeof ElScrollbar>>()\nconst optionRefs = ref<HTMLElement[]>()\nconst dropdownRef = ref<HTMLElement>()\n\nconst optionkls = (item: MentionOption, index: number) => [\n  ns.be('dropdown', 'item'),\n  ns.is('hovering', hoveringIndex.value === index),\n  ns.is('disabled', item.disabled || props.disabled),\n]\n\nconst handleSelect = (item: MentionOption) => {\n  if (item.disabled || props.disabled) return\n  emit('select', item)\n}\n\nconst handleMouseEnter = (index: number) => {\n  hoveringIndex.value = index\n}\n\nconst filteredAllDisabled = computed(\n  () => props.disabled || props.options.every((item) => item.disabled)\n)\n\nconst hoverOption = computed(() => props.options[hoveringIndex.value])\n\nconst selectHoverOption = () => {\n  if (!hoverOption.value) return\n  emit('select', hoverOption.value)\n}\n\nconst navigateOptions = (direction: 'next' | 'prev') => {\n  const { options } = props\n  if (options.length === 0 || filteredAllDisabled.value) return\n\n  if (direction === 'next') {\n    hoveringIndex.value++\n    if (hoveringIndex.value === options.length) {\n      hoveringIndex.value = 0\n    }\n  } else if (direction === 'prev') {\n    hoveringIndex.value--\n    if (hoveringIndex.value < 0) {\n      hoveringIndex.value = options.length - 1\n    }\n  }\n  const option = options[hoveringIndex.value]\n  if (option.disabled) {\n    navigateOptions(direction)\n    return\n  }\n  nextTick(() => scrollToOption(option))\n}\n\nconst scrollToOption = (option: MentionOption) => {\n  const { options } = props\n\n  const index = options.findIndex((item) => item.value === option.value)\n  const target = optionRefs.value?.[index]\n\n  if (target) {\n    const menu = dropdownRef.value?.querySelector?.(\n      `.${ns.be('dropdown', 'wrap')}`\n    )\n    if (menu) {\n      scrollIntoView(menu as HTMLElement, target)\n    }\n  }\n  scrollbarRef.value?.handleScroll()\n}\n\nconst resetHoveringIndex = () => {\n  if (filteredAllDisabled.value || props.options.length === 0) {\n    hoveringIndex.value = -1\n  } else {\n    hoveringIndex.value = 0\n  }\n}\n\nwatch(() => props.options, resetHoveringIndex, {\n  immediate: true,\n})\n\ndefineExpose({\n  hoveringIndex,\n  navigateOptions,\n  selectHoverOption,\n  hoverOption,\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}