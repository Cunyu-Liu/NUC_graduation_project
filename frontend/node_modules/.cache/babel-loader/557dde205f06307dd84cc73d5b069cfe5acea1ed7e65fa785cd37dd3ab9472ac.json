{"ast":null,"code":"import { defineComponent, ref, computed, toRef, watch, useSlots, provide, openBlock, createElementBlock, Fragment, createVNode, unref, withCtx, createElementVNode, mergeProps, normalizeStyle, createBlock, renderSlot, createCommentVNode } from 'vue';\nimport { useVModel } from '@vueuse/core';\nimport { ElTeleport } from '../../teleport/index.mjs';\nimport ElTourMask from './mask2.mjs';\nimport ElTourContent from './content2.mjs';\nimport ElTourSteps from './steps.mjs';\nimport { tourProps, tourEmits } from './tour.mjs';\nimport { useTarget, tourKey } from './helper.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { isBoolean } from '../../../utils/types.mjs';\nimport { useZIndex } from '../../../hooks/use-z-index/index.mjs';\nimport { UPDATE_MODEL_EVENT, CHANGE_EVENT } from '../../../constants/event.mjs';\nconst _sfc_main = defineComponent({\n  ...{\n    name: \"ElTour\",\n    inheritAttrs: false\n  },\n  __name: \"tour\",\n  props: tourProps,\n  emits: tourEmits,\n  setup(__props, {\n    emit: __emit\n  }) {\n    const props = __props;\n    const emit = __emit;\n    const ns = useNamespace(\"tour\");\n    const total = ref(0);\n    const currentStep = ref();\n    const current = useVModel(props, \"current\", emit, {\n      passive: true\n    });\n    const currentTarget = computed(() => {\n      var _a;\n      return (_a = currentStep.value) == null ? void 0 : _a.target;\n    });\n    const kls = computed(() => [ns.b(), mergedType.value === \"primary\" ? ns.m(\"primary\") : \"\"]);\n    const mergedPlacement = computed(() => {\n      var _a;\n      return ((_a = currentStep.value) == null ? void 0 : _a.placement) || props.placement;\n    });\n    const mergedContentStyle = computed(() => {\n      var _a, _b;\n      return (_b = (_a = currentStep.value) == null ? void 0 : _a.contentStyle) != null ? _b : props.contentStyle;\n    });\n    const mergedMask = computed(() => {\n      var _a, _b;\n      return (_b = (_a = currentStep.value) == null ? void 0 : _a.mask) != null ? _b : props.mask;\n    });\n    const mergedShowMask = computed(() => !!mergedMask.value && props.modelValue);\n    const mergedMaskStyle = computed(() => isBoolean(mergedMask.value) ? void 0 : mergedMask.value);\n    const mergedShowArrow = computed(() => {\n      var _a, _b;\n      return !!currentTarget.value && ((_b = (_a = currentStep.value) == null ? void 0 : _a.showArrow) != null ? _b : props.showArrow);\n    });\n    const mergedScrollIntoViewOptions = computed(() => {\n      var _a, _b;\n      return (_b = (_a = currentStep.value) == null ? void 0 : _a.scrollIntoViewOptions) != null ? _b : props.scrollIntoViewOptions;\n    });\n    const mergedType = computed(() => {\n      var _a, _b;\n      return (_b = (_a = currentStep.value) == null ? void 0 : _a.type) != null ? _b : props.type;\n    });\n    const {\n      nextZIndex\n    } = useZIndex();\n    const nowZIndex = nextZIndex();\n    const mergedZIndex = computed(() => {\n      var _a;\n      return (_a = props.zIndex) != null ? _a : nowZIndex;\n    });\n    const {\n      mergedPosInfo: pos,\n      triggerTarget\n    } = useTarget(currentTarget, toRef(props, \"modelValue\"), toRef(props, \"gap\"), mergedMask, mergedScrollIntoViewOptions);\n    watch(() => props.modelValue, val => {\n      if (!val) {\n        current.value = 0;\n      }\n    });\n    const onEscClose = () => {\n      if (props.closeOnPressEscape) {\n        emit(UPDATE_MODEL_EVENT, false);\n        emit(\"close\", current.value);\n      }\n    };\n    const onUpdateTotal = val => {\n      total.value = val;\n    };\n    const slots = useSlots();\n    provide(tourKey, {\n      currentStep,\n      current,\n      total,\n      showClose: toRef(props, \"showClose\"),\n      closeIcon: toRef(props, \"closeIcon\"),\n      mergedType,\n      ns,\n      slots,\n      updateModelValue(modelValue) {\n        emit(UPDATE_MODEL_EVENT, modelValue);\n      },\n      onClose() {\n        emit(\"close\", current.value);\n      },\n      onFinish() {\n        emit(\"finish\");\n      },\n      onChange() {\n        emit(CHANGE_EVENT, current.value);\n      }\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(Fragment, null, [createVNode(unref(ElTeleport), {\n        to: _ctx.appendTo\n      }, {\n        default: withCtx(() => {\n          var _a, _b;\n          return [createElementVNode(\"div\", mergeProps({\n            class: kls.value\n          }, _ctx.$attrs), [createVNode(ElTourMask, {\n            visible: mergedShowMask.value,\n            fill: (_a = mergedMaskStyle.value) == null ? void 0 : _a.color,\n            style: normalizeStyle((_b = mergedMaskStyle.value) == null ? void 0 : _b.style),\n            pos: unref(pos),\n            \"z-index\": mergedZIndex.value,\n            \"target-area-clickable\": _ctx.targetAreaClickable\n          }, null, 8, [\"visible\", \"fill\", \"style\", \"pos\", \"z-index\", \"target-area-clickable\"]), _ctx.modelValue ? (openBlock(), createBlock(ElTourContent, {\n            key: unref(current),\n            reference: unref(triggerTarget),\n            placement: mergedPlacement.value,\n            \"show-arrow\": mergedShowArrow.value,\n            \"z-index\": mergedZIndex.value,\n            style: normalizeStyle(mergedContentStyle.value),\n            onClose: onEscClose\n          }, {\n            default: withCtx(() => [createVNode(unref(ElTourSteps), {\n              current: unref(current),\n              onUpdateTotal\n            }, {\n              default: withCtx(() => [renderSlot(_ctx.$slots, \"default\")]),\n              _: 3\n            }, 8, [\"current\"])]),\n            _: 3\n          }, 8, [\"reference\", \"placement\", \"show-arrow\", \"z-index\", \"style\"])) : createCommentVNode(\"v-if\", true)], 16)];\n        }),\n        _: 3\n      }, 8, [\"to\"]), createCommentVNode(\" just for IDE \"), createCommentVNode(\"v-if\", true)], 64);\n    };\n  }\n});\nvar Tour = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/tour/src/tour.vue\"]]);\nexport { Tour as default };","map":{"version":3,"names":["props","__props","emit","__emit","ns","useNamespace","total","ref","currentStep","current","useVModel","passive","currentTarget","computed","_a","value","target","kls","b","mergedType","m","mergedPlacement","placement","mergedContentStyle","_b","contentStyle","mergedMask","mask","mergedShowMask","modelValue","mergedMaskStyle","isBoolean","mergedShowArrow","showArrow","mergedScrollIntoViewOptions","scrollIntoViewOptions","type","nextZIndex","useZIndex","nowZIndex","mergedZIndex","zIndex","mergedPosInfo","pos","triggerTarget","useTarget","toRef","watch","val","onEscClose","closeOnPressEscape","UPDATE_MODEL_EVENT","onUpdateTotal","slots","useSlots","provide","tourKey","showClose","closeIcon","updateModelValue","onClose","onFinish","onChange","CHANGE_EVENT","createVNode","unref","ElTeleport","to","_ctx","appendTo","default","withCtx","createElementVNode","mergeProps","class","$attrs","ElTourMask","visible","fill","color","style","normalizeStyle","targetAreaClickable","openBlock","createBlock","ElTourContent","key","reference","ElTourSteps","renderSlot","$slots","_","createCommentVNode"],"sources":["../../../../../../packages/components/tour/src/tour.vue"],"sourcesContent":["<template>\n  <el-teleport :to=\"appendTo\">\n    <div :class=\"kls\" v-bind=\"$attrs\">\n      <el-tour-mask\n        :visible=\"mergedShowMask\"\n        :fill=\"mergedMaskStyle?.color\"\n        :style=\"mergedMaskStyle?.style\"\n        :pos=\"pos\"\n        :z-index=\"mergedZIndex\"\n        :target-area-clickable=\"targetAreaClickable\"\n      />\n      <el-tour-content\n        v-if=\"modelValue\"\n        :key=\"current\"\n        :reference=\"triggerTarget\"\n        :placement=\"mergedPlacement\"\n        :show-arrow=\"mergedShowArrow\"\n        :z-index=\"mergedZIndex\"\n        :style=\"mergedContentStyle\"\n        @close=\"onEscClose\"\n      >\n        <el-tour-steps :current=\"current\" @update-total=\"onUpdateTotal\">\n          <slot />\n        </el-tour-steps>\n      </el-tour-content>\n    </div>\n  </el-teleport>\n  <!-- just for IDE -->\n  <slot v-if=\"false\" name=\"indicators\" :current=\"current + 1\" :total=\"total\" />\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, provide, ref, toRef, useSlots, watch } from 'vue'\nimport { useVModel } from '@vueuse/core'\nimport { useNamespace, useZIndex } from '@element-plus/hooks'\nimport { isBoolean } from '@element-plus/utils'\nimport ElTeleport from '@element-plus/components/teleport'\nimport { CHANGE_EVENT, UPDATE_MODEL_EVENT } from '@element-plus/constants'\nimport ElTourMask from './mask.vue'\nimport ElTourContent from './content.vue'\nimport ElTourSteps from './steps'\nimport { tourEmits, tourProps } from './tour'\nimport { tourKey, useTarget } from './helper'\n\nimport type { TourStepProps } from './step'\n\ndefineOptions({\n  name: 'ElTour',\n  inheritAttrs: false,\n})\n\nconst props = defineProps(tourProps)\nconst emit = defineEmits(tourEmits)\n\nconst ns = useNamespace('tour')\nconst total = ref(0)\nconst currentStep = ref<TourStepProps>()\n\nconst current = useVModel(props, 'current', emit, {\n  passive: true,\n})\n\nconst currentTarget = computed(() => currentStep.value?.target)\n\nconst kls = computed(() => [\n  ns.b(),\n  mergedType.value === 'primary' ? ns.m('primary') : '',\n])\n\nconst mergedPlacement = computed(\n  () => currentStep.value?.placement || props.placement\n)\n\nconst mergedContentStyle = computed(\n  () => currentStep.value?.contentStyle ?? props.contentStyle\n)\n\nconst mergedMask = computed(() => currentStep.value?.mask ?? props.mask)\nconst mergedShowMask = computed(() => !!mergedMask.value && props.modelValue)\nconst mergedMaskStyle = computed(() =>\n  isBoolean(mergedMask.value) ? undefined : mergedMask.value\n)\n\nconst mergedShowArrow = computed(\n  () =>\n    !!currentTarget.value && (currentStep.value?.showArrow ?? props.showArrow)\n)\n\nconst mergedScrollIntoViewOptions = computed(\n  () => currentStep.value?.scrollIntoViewOptions ?? props.scrollIntoViewOptions\n)\nconst mergedType = computed(() => currentStep.value?.type ?? props.type)\n\nconst { nextZIndex } = useZIndex()\nconst nowZIndex = nextZIndex()\nconst mergedZIndex = computed(() => props.zIndex ?? nowZIndex)\n\nconst { mergedPosInfo: pos, triggerTarget } = useTarget(\n  currentTarget,\n  toRef(props, 'modelValue'),\n  toRef(props, 'gap'),\n  mergedMask,\n  mergedScrollIntoViewOptions\n)\n\nwatch(\n  () => props.modelValue,\n  (val) => {\n    if (!val) {\n      current.value = 0\n    }\n  }\n)\n\nconst onEscClose = () => {\n  if (props.closeOnPressEscape) {\n    emit(UPDATE_MODEL_EVENT, false)\n    emit('close', current.value)\n  }\n}\n\nconst onUpdateTotal = (val: number) => {\n  total.value = val\n}\n\nconst slots = useSlots()\n\nprovide(tourKey, {\n  currentStep,\n  current,\n  total,\n  showClose: toRef(props, 'showClose'),\n  closeIcon: toRef(props, 'closeIcon'),\n  mergedType,\n  ns,\n  slots,\n  updateModelValue(modelValue) {\n    emit(UPDATE_MODEL_EVENT, modelValue)\n  },\n  onClose() {\n    emit('close', current.value)\n  },\n  onFinish() {\n    emit('finish')\n  },\n  onChange() {\n    emit(CHANGE_EVENT, current.value)\n  },\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}