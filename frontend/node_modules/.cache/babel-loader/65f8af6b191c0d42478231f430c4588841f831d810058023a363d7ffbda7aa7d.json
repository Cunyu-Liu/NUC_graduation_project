{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport { defineComponent, inject, h } from 'vue';\nimport useLayoutObserver from '../layout-observer.mjs';\nimport { TABLE_INJECTION_KEY } from '../tokens.mjs';\nimport useStyle from './style-helper.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nvar TableFooter = defineComponent({\n  name: \"ElTableFooter\",\n  props: {\n    fixed: {\n      type: String,\n      default: \"\"\n    },\n    store: {\n      required: true,\n      type: Object\n    },\n    summaryMethod: Function,\n    sumText: String,\n    border: Boolean,\n    defaultSort: {\n      type: Object,\n      default: () => {\n        return {\n          prop: \"\",\n          order: \"\"\n        };\n      }\n    }\n  },\n  setup(props) {\n    const parent = inject(TABLE_INJECTION_KEY);\n    const ns = useNamespace(\"table\");\n    const {\n      getCellClasses,\n      getCellStyles,\n      columns\n    } = useStyle(props);\n    const {\n      onScrollableChange,\n      onColumnsChange\n    } = useLayoutObserver(parent);\n    return {\n      ns,\n      onScrollableChange,\n      onColumnsChange,\n      getCellClasses,\n      getCellStyles,\n      columns\n    };\n  },\n  render() {\n    const {\n      columns,\n      getCellStyles,\n      getCellClasses,\n      summaryMethod,\n      sumText\n    } = this;\n    const data = this.store.states.data.value;\n    let sums = [];\n    if (summaryMethod) {\n      sums = summaryMethod({\n        columns,\n        data\n      });\n    } else {\n      columns.forEach((column, index) => {\n        if (index === 0) {\n          sums[index] = sumText;\n          return;\n        }\n        const values = data.map(item => Number(item[column.property]));\n        const precisions = [];\n        let notNumber = true;\n        values.forEach(value => {\n          if (!Number.isNaN(+value)) {\n            notNumber = false;\n            const decimal = `${value}`.split(\".\")[1];\n            precisions.push(decimal ? decimal.length : 0);\n          }\n        });\n        const precision = Math.max.apply(null, precisions);\n        if (!notNumber) {\n          sums[index] = values.reduce((prev, curr) => {\n            const value = Number(curr);\n            if (!Number.isNaN(+value)) {\n              return Number.parseFloat((prev + curr).toFixed(Math.min(precision, 20)));\n            } else {\n              return prev;\n            }\n          }, 0);\n        } else {\n          sums[index] = \"\";\n        }\n      });\n    }\n    return h(h(\"tfoot\", [h(\"tr\", {}, [...columns.map((column, cellIndex) => h(\"td\", {\n      key: cellIndex,\n      colspan: column.colSpan,\n      rowspan: column.rowSpan,\n      class: getCellClasses(columns, cellIndex),\n      style: getCellStyles(column, cellIndex)\n    }, [h(\"div\", {\n      class: [\"cell\", column.labelClassName]\n    }, [sums[cellIndex]])]))])]));\n  }\n});\nexport { TableFooter as default };","map":{"version":3,"names":["TableFooter","defineComponent","name","props","fixed","type","String","default","store","required","Object","summaryMethod","Function","sumText","border","Boolean","defaultSort","prop","order","setup","parent","inject","TABLE_INJECTION_KEY","ns","useNamespace","getCellClasses","getCellStyles","columns","useStyle","onScrollableChange","onColumnsChange","useLayoutObserver","render","data","states","value","sums","forEach","column","index","values","map","item","Number","property","precisions","notNumber","isNaN","decimal","split","push","length","precision","Math","max","apply","reduce","prev","curr","parseFloat","toFixed","min","h","cellIndex","key","colspan","colSpan","rowspan","rowSpan","class","style","labelClassName"],"sources":["../../../../../../../packages/components/table/src/table-footer/index.ts"],"sourcesContent":["import { defineComponent, h, inject } from 'vue'\nimport { useNamespace } from '@element-plus/hooks'\nimport useLayoutObserver from '../layout-observer'\nimport { TABLE_INJECTION_KEY } from '../tokens'\nimport useStyle from './style-helper'\n\nimport type { Store } from '../store'\nimport type { PropType, VNode } from 'vue'\nimport type { DefaultRow, Sort, SummaryMethod, Table } from '../table/defaults'\n\nexport interface TableFooter<T extends DefaultRow> {\n  fixed: string\n  store: Store<T>\n  summaryMethod: SummaryMethod<T>\n  sumText: string\n  border: boolean\n  defaultSort: Sort\n}\n\nexport default defineComponent({\n  name: 'ElTableFooter',\n\n  props: {\n    fixed: {\n      type: String,\n      default: '',\n    },\n    store: {\n      required: true,\n      type: Object as PropType<TableFooter<any>['store']>,\n    },\n    summaryMethod: Function as PropType<TableFooter<any>['summaryMethod']>,\n    sumText: String,\n    border: Boolean,\n    defaultSort: {\n      type: Object as PropType<TableFooter<any>['defaultSort']>,\n      default: () => {\n        return {\n          prop: '',\n          order: '',\n        }\n      },\n    },\n  },\n  setup(props) {\n    const parent = inject(TABLE_INJECTION_KEY) as Table<any>\n    const ns = useNamespace('table')\n    const { getCellClasses, getCellStyles, columns } = useStyle(\n      props as TableFooter<any>\n    )\n    const { onScrollableChange, onColumnsChange } = useLayoutObserver(parent!)\n\n    return {\n      ns,\n      onScrollableChange,\n      onColumnsChange,\n      getCellClasses,\n      getCellStyles,\n      columns,\n    }\n  },\n  render() {\n    const { columns, getCellStyles, getCellClasses, summaryMethod, sumText } =\n      this\n    const data = this.store.states.data.value\n    let sums: (string | VNode | number | undefined)[] = []\n    if (summaryMethod) {\n      sums = summaryMethod({\n        columns,\n        data,\n      })\n    } else {\n      columns.forEach((column, index) => {\n        if (index === 0) {\n          sums[index] = sumText\n          return\n        }\n        const values = data.map((item) => Number(item[column.property]))\n        const precisions: number[] = []\n        let notNumber = true\n        values.forEach((value) => {\n          if (!Number.isNaN(+value)) {\n            notNumber = false\n            const decimal = `${value}`.split('.')[1]\n            precisions.push(decimal ? decimal.length : 0)\n          }\n        })\n        const precision = Math.max.apply(null, precisions)\n        if (!notNumber) {\n          sums[index] = values.reduce((prev, curr) => {\n            const value = Number(curr)\n            if (!Number.isNaN(+value)) {\n              return Number.parseFloat(\n                (prev + curr).toFixed(Math.min(precision, 20))\n              )\n            } else {\n              return prev\n            }\n          }, 0)\n        } else {\n          sums[index] = ''\n        }\n      })\n    }\n    return h(\n      h('tfoot', [\n        h('tr', {}, [\n          ...columns.map((column, cellIndex) =>\n            h(\n              'td',\n              {\n                key: cellIndex,\n                colspan: column.colSpan,\n                rowspan: column.rowSpan,\n                class: getCellClasses(columns, cellIndex),\n                style: getCellStyles(column, cellIndex),\n              },\n              [\n                h(\n                  'div',\n                  {\n                    class: ['cell', column.labelClassName],\n                  },\n                  [sums[cellIndex]]\n                ),\n              ]\n            )\n          ),\n        ]),\n      ])\n    )\n  },\n})\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}