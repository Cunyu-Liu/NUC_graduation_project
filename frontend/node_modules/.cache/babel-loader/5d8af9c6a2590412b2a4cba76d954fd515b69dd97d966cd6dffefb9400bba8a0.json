{"ast":null,"code":"import { defineComponent, ref, inject, onMounted, nextTick, watch, provide, computed, openBlock, createElementBlock, normalizeClass, unref, createElementVNode, createVNode, createBlock, createCommentVNode, renderSlot } from 'vue';\nimport { ElInput } from '../../input/index.mjs';\nimport AlphaSlider from './components/alpha-slider.mjs';\nimport HueSlider from './components/hue-slider.mjs';\nimport Predefine from './components/predefine.mjs';\nimport SvPanel from './components/sv-panel.mjs';\nimport { colorPickerPanelProps, colorPickerPanelEmits, ROOT_COMMON_COLOR_INJECTION_KEY, colorPickerPanelContextKey } from './color-picker-panel.mjs';\nimport { useCommonColor } from './composables/use-common-color.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useFormItem } from '../../form/src/hooks/use-form-item.mjs';\nimport { useFormDisabled } from '../../form/src/hooks/use-form-common-props.mjs';\nimport { UPDATE_MODEL_EVENT } from '../../../constants/event.mjs';\nimport { debugWarn } from '../../../utils/error.mjs';\nconst _sfc_main = defineComponent({\n  ...{\n    name: \"ElColorPickerPanel\"\n  },\n  __name: \"color-picker-panel\",\n  props: colorPickerPanelProps,\n  emits: colorPickerPanelEmits,\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    const props = __props;\n    const emit = __emit;\n    const ns = useNamespace(\"color-picker-panel\");\n    const {\n      formItem\n    } = useFormItem();\n    const disabled = useFormDisabled();\n    const hueRef = ref();\n    const svRef = ref();\n    const alphaRef = ref();\n    const inputRef = ref();\n    const customInput = ref(\"\");\n    const {\n      color\n    } = inject(ROOT_COMMON_COLOR_INJECTION_KEY, () => useCommonColor(props, emit), true);\n    function handleConfirm() {\n      color.fromString(customInput.value);\n      if (color.value !== customInput.value) {\n        customInput.value = color.value;\n      }\n    }\n    function handleFocusout() {\n      var _a;\n      if (props.validateEvent) {\n        (_a = formItem == null ? void 0 : formItem.validate) == null ? void 0 : _a.call(formItem, \"blur\").catch(err => debugWarn(err));\n      }\n    }\n    function update() {\n      var _a, _b, _c;\n      (_a = hueRef.value) == null ? void 0 : _a.update();\n      (_b = svRef.value) == null ? void 0 : _b.update();\n      (_c = alphaRef.value) == null ? void 0 : _c.update();\n    }\n    onMounted(() => {\n      if (props.modelValue) {\n        customInput.value = color.value;\n      }\n      nextTick(update);\n    });\n    watch(() => props.modelValue, newVal => {\n      if (newVal !== color.value) {\n        newVal ? color.fromString(newVal) : color.clear();\n      }\n    });\n    watch(() => color.value, val => {\n      emit(UPDATE_MODEL_EVENT, val);\n      customInput.value = val;\n      if (props.validateEvent) {\n        formItem == null ? void 0 : formItem.validate(\"change\").catch(err => debugWarn(err));\n      }\n    });\n    provide(colorPickerPanelContextKey, {\n      currentColor: computed(() => color.value)\n    });\n    __expose({\n      color,\n      inputRef,\n      update\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", {\n        class: normalizeClass([unref(ns).b(), unref(ns).is(\"disabled\", unref(disabled)), unref(ns).is(\"border\", _ctx.border)]),\n        onFocusout: handleFocusout\n      }, [createElementVNode(\"div\", {\n        class: normalizeClass(unref(ns).e(\"wrapper\"))\n      }, [createVNode(HueSlider, {\n        ref_key: \"hueRef\",\n        ref: hueRef,\n        class: \"hue-slider\",\n        color: unref(color),\n        vertical: \"\",\n        disabled: unref(disabled)\n      }, null, 8, [\"color\", \"disabled\"]), createVNode(SvPanel, {\n        ref_key: \"svRef\",\n        ref: svRef,\n        color: unref(color),\n        disabled: unref(disabled)\n      }, null, 8, [\"color\", \"disabled\"])], 2), _ctx.showAlpha ? (openBlock(), createBlock(AlphaSlider, {\n        key: 0,\n        ref_key: \"alphaRef\",\n        ref: alphaRef,\n        color: unref(color),\n        disabled: unref(disabled)\n      }, null, 8, [\"color\", \"disabled\"])) : createCommentVNode(\"v-if\", true), _ctx.predefine ? (openBlock(), createBlock(Predefine, {\n        key: 1,\n        ref: \"predefine\",\n        \"enable-alpha\": _ctx.showAlpha,\n        color: unref(color),\n        colors: _ctx.predefine,\n        disabled: unref(disabled)\n      }, null, 8, [\"enable-alpha\", \"color\", \"colors\", \"disabled\"])) : createCommentVNode(\"v-if\", true), createElementVNode(\"div\", {\n        class: normalizeClass(unref(ns).e(\"footer\"))\n      }, [createVNode(unref(ElInput), {\n        ref_key: \"inputRef\",\n        ref: inputRef,\n        modelValue: customInput.value,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => customInput.value = $event),\n        \"validate-event\": false,\n        size: \"small\",\n        disabled: unref(disabled),\n        onChange: handleConfirm\n      }, null, 8, [\"modelValue\", \"disabled\"]), renderSlot(_ctx.$slots, \"footer\")], 2)], 34);\n    };\n  }\n});\nvar ColorPickerPanel = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/color-picker-panel/src/color-picker-panel.vue\"]]);\nexport { ColorPickerPanel as default };","map":{"version":3,"names":["props","__props","emit","__emit","ns","useNamespace","formItem","useFormItem","disabled","useFormDisabled","hueRef","ref","svRef","alphaRef","inputRef","customInput","color","inject","ROOT_COMMON_COLOR_INJECTION_KEY","useCommonColor","handleConfirm","fromString","value","handleFocusout","validateEvent","_a","validate","call","catch","err","debugWarn","update","_b","_c","onMounted","modelValue","nextTick","watch","newVal","clear","val","UPDATE_MODEL_EVENT","provide","colorPickerPanelContextKey","currentColor","computed","__expose","openBlock","createElementBlock","class","normalizeClass","unref","b","is","_ctx","border","onFocusout","createElementVNode","e","createVNode","HueSlider","ref_key","vertical","SvPanel","showAlpha","createBlock","AlphaSlider","key","createCommentVNode","predefine","Predefine","colors","ElInput","_cache","$event","size","onChange","renderSlot","$slots"],"sources":["../../../../../../packages/components/color-picker-panel/src/color-picker-panel.vue"],"sourcesContent":["<template>\n  <div\n    :class=\"[ns.b(), ns.is('disabled', disabled), ns.is('border', border)]\"\n    @focusout=\"handleFocusout\"\n  >\n    <div :class=\"ns.e('wrapper')\">\n      <hue-slider\n        ref=\"hueRef\"\n        class=\"hue-slider\"\n        :color=\"color\"\n        vertical\n        :disabled=\"disabled\"\n      />\n      <sv-panel ref=\"svRef\" :color=\"color\" :disabled=\"disabled\" />\n    </div>\n    <alpha-slider\n      v-if=\"showAlpha\"\n      ref=\"alphaRef\"\n      :color=\"color\"\n      :disabled=\"disabled\"\n    />\n    <predefine\n      v-if=\"predefine\"\n      ref=\"predefine\"\n      :enable-alpha=\"showAlpha\"\n      :color=\"color\"\n      :colors=\"predefine\"\n      :disabled=\"disabled\"\n    />\n    <div :class=\"ns.e('footer')\">\n      <el-input\n        ref=\"inputRef\"\n        v-model=\"customInput\"\n        :validate-event=\"false\"\n        size=\"small\"\n        :disabled=\"disabled\"\n        @change=\"handleConfirm\"\n      />\n      <slot name=\"footer\" />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, inject, nextTick, onMounted, provide, ref, watch } from 'vue'\nimport { ElInput } from '@element-plus/components/input'\nimport { useFormDisabled, useFormItem } from '@element-plus/components/form'\nimport { useNamespace } from '@element-plus/hooks'\nimport { debugWarn } from '@element-plus/utils'\nimport { UPDATE_MODEL_EVENT } from '@element-plus/constants'\nimport AlphaSlider from './components/alpha-slider.vue'\nimport HueSlider from './components/hue-slider.vue'\nimport Predefine from './components/predefine.vue'\nimport SvPanel from './components/sv-panel.vue'\nimport {\n  ROOT_COMMON_COLOR_INJECTION_KEY,\n  colorPickerPanelContextKey,\n  colorPickerPanelEmits,\n  colorPickerPanelProps,\n} from './color-picker-panel'\nimport { useCommonColor } from './composables/use-common-color'\n\nimport type { InputInstance } from '@element-plus/components/input'\n\ndefineOptions({\n  name: 'ElColorPickerPanel',\n})\nconst props = defineProps(colorPickerPanelProps)\nconst emit = defineEmits(colorPickerPanelEmits)\n\nconst ns = useNamespace('color-picker-panel')\nconst { formItem } = useFormItem()\nconst disabled = useFormDisabled()\nconst hueRef = ref<InstanceType<typeof HueSlider>>()\nconst svRef = ref<InstanceType<typeof SvPanel>>()\nconst alphaRef = ref<InstanceType<typeof AlphaSlider>>()\nconst inputRef = ref<InputInstance>()\nconst customInput = ref('')\n\nconst { color } = inject(\n  ROOT_COMMON_COLOR_INJECTION_KEY,\n  () => useCommonColor(props, emit),\n  true\n)\n\nfunction handleConfirm() {\n  color.fromString(customInput.value)\n  if (color.value !== customInput.value) {\n    customInput.value = color.value\n  }\n}\n\nfunction handleFocusout() {\n  if (props.validateEvent) {\n    formItem?.validate?.('blur').catch((err) => debugWarn(err))\n  }\n}\n\nfunction update() {\n  hueRef.value?.update()\n  svRef.value?.update()\n  alphaRef.value?.update()\n}\n\nonMounted(() => {\n  if (props.modelValue) {\n    customInput.value = color.value\n  }\n  nextTick(update)\n})\n\nwatch(\n  () => props.modelValue,\n  (newVal) => {\n    if (newVal !== color.value) {\n      newVal ? color.fromString(newVal) : color.clear()\n    }\n  }\n)\n\nwatch(\n  () => color.value,\n  (val) => {\n    emit(UPDATE_MODEL_EVENT, val)\n    customInput.value = val\n    if (props.validateEvent) {\n      formItem?.validate('change').catch((err) => debugWarn(err))\n    }\n  }\n)\n\nprovide(colorPickerPanelContextKey, {\n  currentColor: computed(() => color.value),\n})\n\ndefineExpose({\n  /**\n   * @description current color object\n   */\n  color,\n  /**\n   * @description custom input ref\n   */\n  inputRef,\n  /**\n   * @description update sub components\n   */\n  update,\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}