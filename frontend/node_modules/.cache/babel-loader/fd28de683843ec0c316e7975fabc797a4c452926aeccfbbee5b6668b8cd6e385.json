{"ast":null,"code":"import { triggerEvent } from '../../../../utils/dom/aria.mjs';\nimport { getEventCode } from '../../../../utils/dom/event.mjs';\nimport { EVENT_CODE } from '../../../../constants/aria.mjs';\nclass SubMenu {\n  constructor(parent, domNode) {\n    this.parent = parent;\n    this.domNode = domNode;\n    this.subIndex = 0;\n    this.subIndex = 0;\n    this.init();\n  }\n  init() {\n    this.subMenuItems = this.domNode.querySelectorAll(\"li\");\n    this.addListeners();\n  }\n  gotoSubIndex(idx) {\n    if (idx === this.subMenuItems.length) {\n      idx = 0;\n    } else if (idx < 0) {\n      idx = this.subMenuItems.length - 1;\n    }\n    this.subMenuItems[idx].focus();\n    this.subIndex = idx;\n  }\n  addListeners() {\n    const parentNode = this.parent.domNode;\n    Array.prototype.forEach.call(this.subMenuItems, el => {\n      el.addEventListener(\"keydown\", event => {\n        const code = getEventCode(event);\n        let prevDef = false;\n        switch (code) {\n          case EVENT_CODE.down:\n            {\n              this.gotoSubIndex(this.subIndex + 1);\n              prevDef = true;\n              break;\n            }\n          case EVENT_CODE.up:\n            {\n              this.gotoSubIndex(this.subIndex - 1);\n              prevDef = true;\n              break;\n            }\n          case EVENT_CODE.tab:\n            {\n              triggerEvent(parentNode, \"mouseleave\");\n              break;\n            }\n          case EVENT_CODE.enter:\n          case EVENT_CODE.numpadEnter:\n          case EVENT_CODE.space:\n            {\n              prevDef = true;\n              event.currentTarget.click();\n              break;\n            }\n        }\n        if (prevDef) {\n          event.preventDefault();\n          event.stopPropagation();\n        }\n        return false;\n      });\n    });\n  }\n}\nexport { SubMenu as default };","map":{"version":3,"names":["SubMenu","constructor","parent","domNode","subIndex","init","subMenuItems","querySelectorAll","addListeners","gotoSubIndex","idx","length","focus","parentNode","Array","prototype","forEach","call","el","addEventListener","event","code","getEventCode","prevDef","EVENT_CODE","down","up","tab","triggerEvent","enter","numpadEnter","space","currentTarget","click","preventDefault","stopPropagation"],"sources":["../../../../../../../packages/components/menu/src/utils/submenu.ts"],"sourcesContent":["// @ts-nocheck\nimport { getEventCode, triggerEvent } from '@element-plus/utils'\nimport { EVENT_CODE } from '@element-plus/constants'\n\nimport type MenuItem from './menu-item'\n\nclass SubMenu {\n  public subMenuItems: NodeList\n  public subIndex = 0\n  constructor(\n    public parent: MenuItem,\n    public domNode: ParentNode\n  ) {\n    this.subIndex = 0\n    this.init()\n  }\n\n  init(): void {\n    this.subMenuItems = this.domNode.querySelectorAll('li')\n    this.addListeners()\n  }\n\n  gotoSubIndex(idx: number): void {\n    if (idx === this.subMenuItems.length) {\n      idx = 0\n    } else if (idx < 0) {\n      idx = this.subMenuItems.length - 1\n    }\n    ;(this.subMenuItems[idx] as HTMLElement).focus()\n    this.subIndex = idx\n  }\n\n  addListeners(): void {\n    const parentNode = this.parent.domNode\n    Array.prototype.forEach.call(this.subMenuItems, (el: Element) => {\n      el.addEventListener('keydown', (event: KeyboardEvent) => {\n        const code = getEventCode(event)\n        let prevDef = false\n\n        switch (code) {\n          case EVENT_CODE.down: {\n            this.gotoSubIndex(this.subIndex + 1)\n            prevDef = true\n            break\n          }\n          case EVENT_CODE.up: {\n            this.gotoSubIndex(this.subIndex - 1)\n            prevDef = true\n            break\n          }\n          case EVENT_CODE.tab: {\n            triggerEvent(parentNode as HTMLElement, 'mouseleave')\n            break\n          }\n          case EVENT_CODE.enter:\n          case EVENT_CODE.numpadEnter:\n          case EVENT_CODE.space: {\n            prevDef = true\n            ;(event.currentTarget as HTMLElement).click()\n            break\n          }\n        }\n        if (prevDef) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n        return false\n      })\n    })\n  }\n}\n\nexport default SubMenu\n"],"mappings":";;;AAMA,MAAMA,OAAQ;EAGZC,YACSC,MAAA,EACAC,OACP;IAFO,KAAAD,MAAA,GAAAA,MAAA;IACA,KAAAC,OAAA,GAAAA,OAAA;IAHT,KAAOC,QAAW;IAKhB,KAAKA,QAAW;IAChB,KAAKC,IAAK;EAAA;EAGZA,IAAaA,CAAA;IACX,KAAKC,YAAe,QAAKH,OAAQ,CAAAI,gBAAA,CAAiB,IAAI;IACtD,KAAKC,YAAa;EAAA;EAGpBC,aAAaC,GAAmB;IAC1B,IAAAA,GAAA,KAAQ,IAAK,CAAAJ,YAAA,CAAaK,MAAQ;MAC9BD,GAAA;IAAA,CACR,UAAWA,GAAA,GAAM,CAAG;MACZA,GAAA,QAAKJ,YAAA,CAAaK,MAAS;IAAA;IAEjC,KAAKL,YAAa,CAAAI,GAAA,EAAqBE,KAAM;IAC/C,KAAKR,QAAW,GAAAM,GAAA;EAAA;EAGlBF,YAAqBA,CAAA;IACb,MAAAK,UAAA,GAAa,KAAKX,MAAO,CAAAC,OAAA;IAC/BW,KAAA,CAAMC,SAAA,CAAUC,OAAQ,CAAAC,IAAA,CAAK,IAAK,CAAAX,YAAA,EAAeY,EAAgB;MAC5DA,EAAA,CAAAC,gBAAA,CAAiB,SAAW,EAACC,KAAyB;QACjD,MAAAC,IAAA,GAAOC,YAAA,CAAaF,KAAK;QAC/B,IAAIG,OAAU;QAEN,QAAAF,IAAA;UAAA,KACDG,UAAA,CAAWC,IAAM;YAAA;cACf,KAAAhB,YAAA,CAAa,IAAK,CAAAL,QAAA,GAAW,CAAC;cACzBmB,OAAA;cACV;YAAA;UACF,KACKC,UAAA,CAAWE,EAAI;YAAA;cACb,KAAAjB,YAAA,CAAa,IAAK,CAAAL,QAAA,GAAW,CAAC;cACzBmB,OAAA;cACV;YAAA;UACF,KACKC,UAAA,CAAWG,GAAK;YAAA;cACnBC,YAAA,CAAaf,UAAA,EAA2B,YAAY;cACpD;YAAA;UACF,KACKW,UAAW,CAAAK,KAAA;UAAA,KACXL,UAAW,CAAAM,WAAA;UAAA,KACXN,UAAA,CAAWO,KAAO;YAAA;cACXR,OAAA;cACRH,KAAA,CAAMY,aAAA,CAA8BC,KAAM;cAC5C;YAAA;QACF;QAEF,IAAIV,OAAS;UACXH,KAAA,CAAMc,cAAe;UACrBd,KAAA,CAAMe,eAAgB;QAAA;QAEjB;MAAA,CACR;IAAA,CACF;EAAA;AAEL","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}