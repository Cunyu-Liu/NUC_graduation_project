{"ast":null,"code":"import \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport { ref, getCurrentInstance, inject, computed, unref, provide } from 'vue';\nimport { configProviderContextKey } from '../constants.mjs';\nimport { useNamespace, defaultNamespace, namespaceContextKey } from '../../../../hooks/use-namespace/index.mjs';\nimport { useZIndex, defaultInitialZIndex, zIndexContextKey } from '../../../../hooks/use-z-index/index.mjs';\nimport { useLocale, localeContextKey } from '../../../../hooks/use-locale/index.mjs';\nimport { SIZE_INJECTION_KEY } from '../../../../hooks/use-size/index.mjs';\nimport { emptyValuesContextKey } from '../../../../hooks/use-empty-values/index.mjs';\nimport { debugWarn } from '../../../../utils/error.mjs';\nimport { keysOf } from '../../../../utils/objects.mjs';\nconst globalConfig = ref();\nfunction useGlobalConfig(key, defaultValue = void 0) {\n  const config = getCurrentInstance() ? inject(configProviderContextKey, globalConfig) : globalConfig;\n  if (key) {\n    return computed(() => {\n      var _a, _b;\n      return (_b = (_a = config.value) == null ? void 0 : _a[key]) != null ? _b : defaultValue;\n    });\n  } else {\n    return config;\n  }\n}\nfunction useGlobalComponentSettings(block, sizeFallback) {\n  const config = useGlobalConfig();\n  const ns = useNamespace(block, computed(() => {\n    var _a;\n    return ((_a = config.value) == null ? void 0 : _a.namespace) || defaultNamespace;\n  }));\n  const locale = useLocale(computed(() => {\n    var _a;\n    return (_a = config.value) == null ? void 0 : _a.locale;\n  }));\n  const zIndex = useZIndex(computed(() => {\n    var _a;\n    return ((_a = config.value) == null ? void 0 : _a.zIndex) || defaultInitialZIndex;\n  }));\n  const size = computed(() => {\n    var _a;\n    return unref(sizeFallback) || ((_a = config.value) == null ? void 0 : _a.size) || \"\";\n  });\n  provideGlobalConfig(computed(() => unref(config) || {}));\n  return {\n    ns,\n    locale,\n    zIndex,\n    size\n  };\n}\nconst provideGlobalConfig = (config, app, global = false) => {\n  var _a;\n  const inSetup = !!getCurrentInstance();\n  const oldConfig = inSetup ? useGlobalConfig() : void 0;\n  const provideFn = (_a = app == null ? void 0 : app.provide) != null ? _a : inSetup ? provide : void 0;\n  if (!provideFn) {\n    debugWarn(\"provideGlobalConfig\", \"provideGlobalConfig() can only be used inside setup().\");\n    return;\n  }\n  const context = computed(() => {\n    const cfg = unref(config);\n    if (!(oldConfig == null ? void 0 : oldConfig.value)) return cfg;\n    return mergeConfig(oldConfig.value, cfg);\n  });\n  provideFn(configProviderContextKey, context);\n  provideFn(localeContextKey, computed(() => context.value.locale));\n  provideFn(namespaceContextKey, computed(() => context.value.namespace));\n  provideFn(zIndexContextKey, computed(() => context.value.zIndex));\n  provideFn(SIZE_INJECTION_KEY, {\n    size: computed(() => context.value.size || \"\")\n  });\n  provideFn(emptyValuesContextKey, computed(() => ({\n    emptyValues: context.value.emptyValues,\n    valueOnClear: context.value.valueOnClear\n  })));\n  if (global || !globalConfig.value) {\n    globalConfig.value = context.value;\n  }\n  return context;\n};\nconst mergeConfig = (a, b) => {\n  const keys = [... /* @__PURE__ */new Set([...keysOf(a), ...keysOf(b)])];\n  const obj = {};\n  for (const key of keys) {\n    obj[key] = b[key] !== void 0 ? b[key] : a[key];\n  }\n  return obj;\n};\nexport { provideGlobalConfig, useGlobalComponentSettings, useGlobalConfig };","map":{"version":3,"names":["globalConfig","ref","useGlobalConfig","key","defaultValue","config","getCurrentInstance","inject","configProviderContextKey","computed","_a","_b","value","useGlobalComponentSettings","block","sizeFallback","ns","useNamespace","namespace","defaultNamespace","locale","useLocale","zIndex","useZIndex","defaultInitialZIndex","size","unref","provideGlobalConfig","app","global","inSetup","oldConfig","provideFn","provide","debugWarn","context","cfg","mergeConfig","localeContextKey","namespaceContextKey","zIndexContextKey","SIZE_INJECTION_KEY","emptyValuesContextKey","emptyValues","valueOnClear","a","b","keys","Set","keysOf","obj"],"sources":["../../../../../../../packages/components/config-provider/src/hooks/use-global-config.ts"],"sourcesContent":["import { computed, getCurrentInstance, inject, provide, ref, unref } from 'vue'\nimport { debugWarn, keysOf } from '@element-plus/utils'\nimport {\n  SIZE_INJECTION_KEY,\n  defaultInitialZIndex,\n  defaultNamespace,\n  emptyValuesContextKey,\n  localeContextKey,\n  namespaceContextKey,\n  useLocale,\n  useNamespace,\n  useZIndex,\n  zIndexContextKey,\n} from '@element-plus/hooks'\nimport { configProviderContextKey } from '../constants'\n\nimport type { MaybeRef } from '@vueuse/core'\nimport type { App, Ref } from 'vue'\nimport type { ConfigProviderContext } from '../constants'\n\n// this is meant to fix global methods like `ElMessage(opts)`, this way we can inject current locale\n// into the component as default injection value.\n// refer to: https://github.com/element-plus/element-plus/issues/2610#issuecomment-887965266\nconst globalConfig = ref<ConfigProviderContext>()\n\nexport function useGlobalConfig<\n  K extends keyof ConfigProviderContext,\n  D extends ConfigProviderContext[K],\n>(\n  key: K,\n  defaultValue?: D\n): Ref<Exclude<ConfigProviderContext[K], undefined> | D>\nexport function useGlobalConfig(): Ref<ConfigProviderContext>\nexport function useGlobalConfig(\n  key?: keyof ConfigProviderContext,\n  defaultValue = undefined\n) {\n  const config = getCurrentInstance()\n    ? inject(configProviderContextKey, globalConfig)\n    : globalConfig\n  if (key) {\n    return computed(() => config.value?.[key] ?? defaultValue)\n  } else {\n    return config\n  }\n}\n\n// for components like `ElMessage` `ElNotification` `ElMessageBox`.\nexport function useGlobalComponentSettings(\n  block: string,\n  sizeFallback?: MaybeRef<ConfigProviderContext['size']>\n) {\n  const config = useGlobalConfig()\n\n  const ns = useNamespace(\n    block,\n    computed(() => config.value?.namespace || defaultNamespace)\n  )\n\n  const locale = useLocale(computed(() => config.value?.locale))\n  const zIndex = useZIndex(\n    computed(() => config.value?.zIndex || defaultInitialZIndex)\n  )\n  const size = computed(() => unref(sizeFallback) || config.value?.size || '')\n  provideGlobalConfig(computed(() => unref(config) || {}))\n\n  return {\n    ns,\n    locale,\n    zIndex,\n    size,\n  }\n}\n\nexport const provideGlobalConfig = (\n  config: MaybeRef<ConfigProviderContext>,\n  app?: App,\n  global = false\n) => {\n  const inSetup = !!getCurrentInstance()\n  const oldConfig = inSetup ? useGlobalConfig() : undefined\n\n  const provideFn = app?.provide ?? (inSetup ? provide : undefined)\n  if (!provideFn) {\n    debugWarn(\n      'provideGlobalConfig',\n      'provideGlobalConfig() can only be used inside setup().'\n    )\n    return\n  }\n\n  const context = computed(() => {\n    const cfg = unref(config)\n    if (!oldConfig?.value) return cfg\n    return mergeConfig(oldConfig.value, cfg)\n  })\n  provideFn(configProviderContextKey, context)\n  provideFn(\n    localeContextKey,\n    computed(() => context.value.locale)\n  )\n  provideFn(\n    namespaceContextKey,\n    computed(() => context.value.namespace)\n  )\n  provideFn(\n    zIndexContextKey,\n    computed(() => context.value.zIndex)\n  )\n\n  provideFn(SIZE_INJECTION_KEY, {\n    size: computed(() => context.value.size || ''),\n  })\n\n  provideFn(\n    emptyValuesContextKey,\n    computed(() => ({\n      emptyValues: context.value.emptyValues,\n      valueOnClear: context.value.valueOnClear,\n    }))\n  )\n\n  if (global || !globalConfig.value) {\n    globalConfig.value = context.value\n  }\n  return context\n}\n\nconst mergeConfig = (\n  a: ConfigProviderContext,\n  b: ConfigProviderContext\n): ConfigProviderContext => {\n  const keys = [...new Set([...keysOf(a), ...keysOf(b)])]\n  const obj: Record<string, any> = {}\n  for (const key of keys) {\n    obj[key] = b[key] !== undefined ? b[key] : a[key]\n  }\n  return obj\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}