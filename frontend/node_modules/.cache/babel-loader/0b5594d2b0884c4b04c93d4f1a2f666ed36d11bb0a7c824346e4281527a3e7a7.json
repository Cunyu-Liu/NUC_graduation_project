{"ast":null,"code":"import { defineComponent, inject, ref, onMounted, onBeforeUnmount, onUpdated, watch, computed, createVNode, Fragment, nextTick } from 'vue';\nimport { useResizeObserver } from '@vueuse/core';\nimport { formContextKey, formItemContextKey } from './constants.mjs';\nimport { throwError } from '../../../utils/error.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nconst COMPONENT_NAME = \"ElLabelWrap\";\nvar FormLabelWrap = defineComponent({\n  name: COMPONENT_NAME,\n  props: {\n    isAutoWidth: Boolean,\n    updateAll: Boolean\n  },\n  setup(props, {\n    slots\n  }) {\n    const formContext = inject(formContextKey, void 0);\n    const formItemContext = inject(formItemContextKey);\n    if (!formItemContext) throwError(COMPONENT_NAME, \"usage: <el-form-item><label-wrap /></el-form-item>\");\n    const ns = useNamespace(\"form\");\n    const el = ref();\n    const computedWidth = ref(0);\n    const getLabelWidth = () => {\n      var _a;\n      if ((_a = el.value) == null ? void 0 : _a.firstElementChild) {\n        const width = window.getComputedStyle(el.value.firstElementChild).width;\n        return Math.ceil(Number.parseFloat(width));\n      } else {\n        return 0;\n      }\n    };\n    const updateLabelWidth = (action = \"update\") => {\n      nextTick(() => {\n        if (slots.default && props.isAutoWidth) {\n          if (action === \"update\") {\n            computedWidth.value = getLabelWidth();\n          } else if (action === \"remove\") {\n            formContext == null ? void 0 : formContext.deregisterLabelWidth(computedWidth.value);\n          }\n        }\n      });\n    };\n    const updateLabelWidthFn = () => updateLabelWidth(\"update\");\n    onMounted(() => {\n      updateLabelWidthFn();\n    });\n    onBeforeUnmount(() => {\n      updateLabelWidth(\"remove\");\n    });\n    onUpdated(() => updateLabelWidthFn());\n    watch(computedWidth, (val, oldVal) => {\n      if (props.updateAll) {\n        formContext == null ? void 0 : formContext.registerLabelWidth(val, oldVal);\n      }\n    });\n    useResizeObserver(computed(() => {\n      var _a, _b;\n      return (_b = (_a = el.value) == null ? void 0 : _a.firstElementChild) != null ? _b : null;\n    }), updateLabelWidthFn);\n    return () => {\n      var _a, _b;\n      if (!slots) return null;\n      const {\n        isAutoWidth\n      } = props;\n      if (isAutoWidth) {\n        const autoLabelWidth = formContext == null ? void 0 : formContext.autoLabelWidth;\n        const hasLabel = formItemContext == null ? void 0 : formItemContext.hasLabel;\n        const style = {};\n        if (hasLabel && autoLabelWidth && autoLabelWidth !== \"auto\") {\n          const marginWidth = Math.max(0, Number.parseInt(autoLabelWidth, 10) - computedWidth.value);\n          const labelPosition = formItemContext.labelPosition || formContext.labelPosition;\n          const marginPosition = labelPosition === \"left\" ? \"marginRight\" : \"marginLeft\";\n          if (marginWidth) {\n            style[marginPosition] = `${marginWidth}px`;\n          }\n        }\n        return createVNode(\"div\", {\n          \"ref\": el,\n          \"class\": [ns.be(\"item\", \"label-wrap\")],\n          \"style\": style\n        }, [(_a = slots.default) == null ? void 0 : _a.call(slots)]);\n      } else {\n        return createVNode(Fragment, {\n          \"ref\": el\n        }, [(_b = slots.default) == null ? void 0 : _b.call(slots)]);\n      }\n    };\n  }\n});\nexport { FormLabelWrap as default };","map":{"version":3,"names":["COMPONENT_NAME","FormLabelWrap","defineComponent","name","props","isAutoWidth","Boolean","updateAll","setup","slots","formContext","inject","formContextKey","formItemContext","formItemContextKey","throwError","ns","useNamespace","el","ref","computedWidth","getLabelWidth","_a","value","firstElementChild","width","window","getComputedStyle","Math","ceil","Number","parseFloat","updateLabelWidth","action","nextTick","default","deregisterLabelWidth","updateLabelWidthFn","onMounted","onBeforeUnmount","onUpdated","watch","val","oldVal","registerLabelWidth","useResizeObserver","computed","_b","autoLabelWidth","hasLabel","style","marginWidth","max","parseInt","labelPosition","marginPosition","createVNode","be","call","Fragment"],"sources":["../../../../../../packages/components/form/src/form-label-wrap.tsx"],"sourcesContent":["import {\n  Fragment,\n  computed,\n  defineComponent,\n  inject,\n  nextTick,\n  onBeforeUnmount,\n  onMounted,\n  onUpdated,\n  ref,\n  watch,\n} from 'vue'\nimport { useResizeObserver } from '@vueuse/core'\nimport { throwError } from '@element-plus/utils'\nimport { useNamespace } from '@element-plus/hooks'\nimport { formContextKey, formItemContextKey } from './constants'\n\nimport type { CSSProperties } from 'vue'\n\nconst COMPONENT_NAME = 'ElLabelWrap'\nexport default defineComponent({\n  name: COMPONENT_NAME,\n  props: {\n    isAutoWidth: Boolean,\n    updateAll: Boolean,\n  },\n\n  setup(props, { slots }) {\n    const formContext = inject(formContextKey, undefined)\n    const formItemContext = inject(formItemContextKey)\n    if (!formItemContext)\n      throwError(\n        COMPONENT_NAME,\n        'usage: <el-form-item><label-wrap /></el-form-item>'\n      )\n\n    const ns = useNamespace('form')\n\n    const el = ref<HTMLElement>()\n    const computedWidth = ref(0)\n\n    const getLabelWidth = () => {\n      if (el.value?.firstElementChild) {\n        const width = window.getComputedStyle(el.value.firstElementChild).width\n        return Math.ceil(Number.parseFloat(width))\n      } else {\n        return 0\n      }\n    }\n\n    const updateLabelWidth = (action: 'update' | 'remove' = 'update') => {\n      nextTick(() => {\n        if (slots.default && props.isAutoWidth) {\n          if (action === 'update') {\n            computedWidth.value = getLabelWidth()\n          } else if (action === 'remove') {\n            formContext?.deregisterLabelWidth(computedWidth.value)\n          }\n        }\n      })\n    }\n    const updateLabelWidthFn = () => updateLabelWidth('update')\n\n    onMounted(() => {\n      updateLabelWidthFn()\n    })\n    onBeforeUnmount(() => {\n      updateLabelWidth('remove')\n    })\n    onUpdated(() => updateLabelWidthFn())\n\n    watch(computedWidth, (val, oldVal) => {\n      if (props.updateAll) {\n        formContext?.registerLabelWidth(val, oldVal)\n      }\n    })\n\n    useResizeObserver(\n      computed(\n        () => (el.value?.firstElementChild ?? null) as HTMLElement | null\n      ),\n      updateLabelWidthFn\n    )\n\n    return () => {\n      if (!slots) return null\n\n      const { isAutoWidth } = props\n      if (isAutoWidth) {\n        const autoLabelWidth = formContext?.autoLabelWidth\n        const hasLabel = formItemContext?.hasLabel\n        const style: CSSProperties = {}\n        if (hasLabel && autoLabelWidth && autoLabelWidth !== 'auto') {\n          const marginWidth = Math.max(\n            0,\n            Number.parseInt(autoLabelWidth, 10) - computedWidth.value\n          )\n          const labelPosition =\n            formItemContext.labelPosition || formContext.labelPosition\n\n          const marginPosition =\n            labelPosition === 'left' ? 'marginRight' : 'marginLeft'\n\n          if (marginWidth) {\n            style[marginPosition] = `${marginWidth}px`\n          }\n        }\n        return (\n          <div ref={el} class={[ns.be('item', 'label-wrap')]} style={style}>\n            {slots.default?.()}\n          </div>\n        )\n      } else {\n        return <Fragment ref={el}>{slots.default?.()}</Fragment>\n      }\n    }\n  },\n})\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}