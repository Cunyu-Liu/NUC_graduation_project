{"ast":null,"code":"import { ref, unref } from 'vue';\nimport { useEventListener } from '@vueuse/core';\nimport { cAF, rAF } from '../../../../utils/raf.mjs';\nconst useGridTouch = (windowRef, states, scrollTo, estimatedTotalWidth, estimatedTotalHeight, parsedWidth, parsedHeight) => {\n  const touchStartX = ref(0);\n  const touchStartY = ref(0);\n  let frameHandle;\n  let deltaX = 0;\n  let deltaY = 0;\n  const handleTouchStart = event => {\n    cAF(frameHandle);\n    touchStartX.value = event.touches[0].clientX;\n    touchStartY.value = event.touches[0].clientY;\n    deltaX = 0;\n    deltaY = 0;\n  };\n  const handleTouchMove = event => {\n    event.preventDefault();\n    cAF(frameHandle);\n    deltaX += touchStartX.value - event.touches[0].clientX;\n    deltaY += touchStartY.value - event.touches[0].clientY;\n    touchStartX.value = event.touches[0].clientX;\n    touchStartY.value = event.touches[0].clientY;\n    frameHandle = rAF(() => {\n      const maxScrollLeft = estimatedTotalWidth.value - unref(parsedWidth);\n      const maxScrollTop = estimatedTotalHeight.value - unref(parsedHeight);\n      const safeScrollLeft = Math.min(states.value.scrollLeft + deltaX, maxScrollLeft);\n      const safeScrollTop = Math.min(states.value.scrollTop + deltaY, maxScrollTop);\n      scrollTo({\n        scrollLeft: safeScrollLeft,\n        scrollTop: safeScrollTop\n      });\n      deltaX = 0;\n      deltaY = 0;\n    });\n  };\n  useEventListener(windowRef, \"touchstart\", handleTouchStart, {\n    passive: true\n  });\n  useEventListener(windowRef, \"touchmove\", handleTouchMove, {\n    passive: false\n  });\n  return {\n    touchStartX,\n    touchStartY,\n    handleTouchStart,\n    handleTouchMove\n  };\n};\nexport { useGridTouch };","map":{"version":3,"names":["useGridTouch","windowRef","states","scrollTo","estimatedTotalWidth","estimatedTotalHeight","parsedWidth","parsedHeight","touchStartX","ref","touchStartY","frameHandle","deltaX","deltaY","handleTouchStart","event","cAF","value","touches","clientX","clientY","handleTouchMove","preventDefault","rAF","maxScrollLeft","unref","maxScrollTop","safeScrollLeft","Math","min","scrollLeft","safeScrollTop","scrollTop","useEventListener","passive"],"sources":["../../../../../../../packages/components/virtual-list/src/hooks/use-grid-touch.ts"],"sourcesContent":["import { ref, unref } from 'vue'\nimport { useEventListener } from '@vueuse/core'\nimport { cAF, rAF } from '@element-plus/utils'\n\nimport type { ComputedRef, Ref } from 'vue'\nimport type { GridScrollOptions, GridStates } from '../types'\n\nexport const useGridTouch = (\n  windowRef: Ref<HTMLElement | undefined>,\n  states: Ref<GridStates>,\n  scrollTo: (scrollOptions: GridScrollOptions) => void,\n  estimatedTotalWidth: ComputedRef<number>,\n  estimatedTotalHeight: ComputedRef<number>,\n  parsedWidth: ComputedRef<number>,\n  parsedHeight: ComputedRef<number>\n) => {\n  const touchStartX = ref(0)\n  const touchStartY = ref(0)\n  let frameHandle: number | undefined\n  let deltaX = 0\n  let deltaY = 0\n\n  const handleTouchStart = (event: TouchEvent) => {\n    cAF(frameHandle!)\n    touchStartX.value = event.touches[0].clientX\n    touchStartY.value = event.touches[0].clientY\n    deltaX = 0\n    deltaY = 0\n  }\n\n  const handleTouchMove = (event: TouchEvent) => {\n    event.preventDefault()\n    cAF(frameHandle!)\n\n    deltaX += touchStartX.value - event.touches[0].clientX\n    deltaY += touchStartY.value - event.touches[0].clientY\n    touchStartX.value = event.touches[0].clientX\n    touchStartY.value = event.touches[0].clientY\n\n    frameHandle = rAF(() => {\n      const maxScrollLeft = estimatedTotalWidth.value - unref(parsedWidth)\n      const maxScrollTop = estimatedTotalHeight.value - unref(parsedHeight)\n\n      const safeScrollLeft = Math.min(\n        states.value.scrollLeft + deltaX,\n        maxScrollLeft\n      )\n      const safeScrollTop = Math.min(\n        states.value.scrollTop + deltaY,\n        maxScrollTop\n      )\n\n      scrollTo({\n        scrollLeft: safeScrollLeft,\n        scrollTop: safeScrollTop,\n      })\n\n      deltaX = 0\n      deltaY = 0\n    })\n  }\n\n  useEventListener(windowRef, 'touchstart', handleTouchStart, {\n    passive: true,\n  })\n  useEventListener(windowRef, 'touchmove', handleTouchMove, {\n    passive: false,\n  })\n\n  return {\n    touchStartX,\n    touchStartY,\n    handleTouchStart,\n    handleTouchMove,\n  }\n}\n"],"mappings":";;;AAOa,MAAAA,YAAA,GAAeA,CAC1BC,SACA,EAAAC,MAAA,EACAC,QAAA,EACAC,mBACA,EAAAC,oBAAA,EACAC,WAAA,EACAC,YACG;EACG,MAAAC,WAAA,GAAcC,GAAA,CAAI,CAAC;EACnB,MAAAC,WAAA,GAAcD,GAAA,CAAI,CAAC;EACrB,IAAAE,WAAA;EACJ,IAAIC,MAAS;EACb,IAAIC,MAAS;EAEP,MAAAC,gBAAA,GAAoBC,KAAsB;IAC9CC,GAAA,CAAIL,WAAY;IACJH,WAAA,CAAAS,KAAA,GAAQF,KAAM,CAAAG,OAAA,CAAQ,CAAG,EAAAC,OAAA;IACzBT,WAAA,CAAAO,KAAA,GAAQF,KAAM,CAAAG,OAAA,CAAQ,CAAG,EAAAE,OAAA;IAC5BR,MAAA;IACAC,MAAA;EAAA,CACX;EAEM,MAAAQ,eAAA,GAAmBN,KAAsB;IAC7CA,KAAA,CAAMO,cAAe;IACrBN,GAAA,CAAIL,WAAY;IAEhBC,MAAA,IAAUJ,WAAY,CAAAS,KAAA,GAAQF,KAAM,CAAAG,OAAA,CAAQ,CAAG,EAAAC,OAAA;IAC/CN,MAAA,IAAUH,WAAY,CAAAO,KAAA,GAAQF,KAAM,CAAAG,OAAA,CAAQ,CAAG,EAAAE,OAAA;IACnCZ,WAAA,CAAAS,KAAA,GAAQF,KAAM,CAAAG,OAAA,CAAQ,CAAG,EAAAC,OAAA;IACzBT,WAAA,CAAAO,KAAA,GAAQF,KAAM,CAAAG,OAAA,CAAQ,CAAG,EAAAE,OAAA;IAErCT,WAAA,GAAcY,GAAA,CAAI,MAAM;MACtB,MAAMC,aAAgB,GAAApB,mBAAA,CAAoBa,KAAQ,GAAAQ,KAAA,CAAMnB,WAAW;MACnE,MAAMoB,YAAe,GAAArB,oBAAA,CAAqBY,KAAQ,GAAAQ,KAAA,CAAMlB,YAAY;MAEpE,MAAMoB,cAAA,GAAiBC,IAAK,CAAAC,GAAA,CAC1B3B,MAAA,CAAOe,KAAA,CAAMa,UAAa,GAAAlB,MAAA,EAC1BY,aAAA,CACF;MACA,MAAMO,aAAA,GAAgBH,IAAK,CAAAC,GAAA,CACzB3B,MAAA,CAAOe,KAAA,CAAMe,SAAY,GAAAnB,MAAA,EACzBa,YAAA,CACF;MAESvB,QAAA;QACP2B,UAAY,EAAAH,cAAA;QACZK,SAAW,EAAAD;MAAA,CACZ;MAEQnB,MAAA;MACAC,MAAA;IAAA,CACV;EAAA,CACH;EAEiBoB,gBAAA,CAAAhC,SAAA,EAAW,cAAca,gBAAkB;IAC1DoB,OAAS;EAAA,CACV;EACgBD,gBAAA,CAAAhC,SAAA,EAAW,aAAaoB,eAAiB;IACxDa,OAAS;EAAA,CACV;EAEM;IACL1B,WAAA;IACAE,WAAA;IACAI,gBAAA;IACAO;EAAA,CACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}