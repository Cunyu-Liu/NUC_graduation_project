{"ast":null,"code":"import { shallowReactive } from 'vue';\nconst placementInstances = shallowReactive({});\nconst getOrCreatePlacementInstances = placement => {\n  if (!placementInstances[placement]) {\n    placementInstances[placement] = shallowReactive([]);\n  }\n  return placementInstances[placement];\n};\nconst getInstance = (id, placement) => {\n  const instances = placementInstances[placement] || [];\n  const idx = instances.findIndex(instance => instance.id === id);\n  const current = instances[idx];\n  let prev;\n  if (idx > 0) {\n    prev = instances[idx - 1];\n  }\n  return {\n    current,\n    prev\n  };\n};\nconst getLastOffset = (id, placement) => {\n  const {\n    prev\n  } = getInstance(id, placement);\n  if (!prev) return 0;\n  return prev.vm.exposed.bottom.value;\n};\nconst getOffsetOrSpace = (id, offset, placement) => {\n  const instances = placementInstances[placement] || [];\n  const idx = instances.findIndex(instance => instance.id === id);\n  return idx > 0 ? 16 : offset;\n};\nexport { getInstance, getLastOffset, getOffsetOrSpace, getOrCreatePlacementInstances, placementInstances };","map":{"version":3,"names":["placementInstances","shallowReactive","getOrCreatePlacementInstances","placement","getInstance","id","instances","idx","findIndex","instance","current","prev","getLastOffset","vm","exposed","bottom","value","getOffsetOrSpace","offset"],"sources":["../../../../../../packages/components/message/src/instance.ts"],"sourcesContent":["import { shallowReactive } from 'vue'\n\nimport type { ComponentInternalInstance, VNode } from 'vue'\nimport type { Mutable } from '@element-plus/utils'\nimport type { MessageHandler, MessagePlacement, MessageProps } from './message'\n\nexport type MessageContext = {\n  id: string\n  vnode: VNode\n  handler: MessageHandler\n  vm: ComponentInternalInstance\n  props: Mutable<MessageProps>\n}\n\nexport const placementInstances = shallowReactive(\n  {} as Record<MessagePlacement, MessageContext[]>\n)\n\nexport const getOrCreatePlacementInstances = (placement: MessagePlacement) => {\n  if (!placementInstances[placement]) {\n    placementInstances[placement] = shallowReactive([])\n  }\n  return placementInstances[placement]\n}\n\nexport const getInstance = (id: string, placement: MessagePlacement) => {\n  const instances = placementInstances[placement] || []\n  const idx = instances.findIndex((instance) => instance.id === id)\n  const current = instances[idx]\n  let prev: MessageContext | undefined\n  if (idx > 0) {\n    prev = instances[idx - 1]\n  }\n  return { current, prev }\n}\n\nexport const getLastOffset = (\n  id: string,\n  placement: MessagePlacement\n): number => {\n  const { prev } = getInstance(id, placement)\n  if (!prev) return 0\n  return prev.vm.exposed!.bottom.value\n}\n\nexport const getOffsetOrSpace = (\n  id: string,\n  offset: number,\n  placement: MessagePlacement\n) => {\n  const instances = placementInstances[placement] || []\n  const idx = instances.findIndex((instance) => instance.id === id)\n  return idx > 0 ? 16 : offset\n}\n"],"mappings":";AAcO,MAAMA,kBAAqB,GAAAC,eAAA,CAChC,EACF;AAEa,MAAAC,6BAAA,GAAiCC,SAAgC;EACxE,KAACH,kBAAA,CAAmBG,SAAY;IACfH,kBAAA,CAAAG,SAAA,IAAaF,eAAgB,GAAE;EAAA;EAEpD,OAAOD,kBAAmB,CAAAG,SAAA;AAC5B;AAEa,MAAAC,WAAA,GAAcA,CAACC,EAAA,EAAYF,SAAgC;EAChE,MAAAG,SAAA,GAAYN,kBAAmB,CAAAG,SAAA,KAAc,EAAC;EACpD,MAAMI,GAAA,GAAMD,SAAU,CAAAE,SAAA,CAAWC,QAAa,IAAAA,QAAA,CAASJ,EAAA,KAAOA,EAAE;EAChE,MAAMK,OAAA,GAAUJ,SAAU,CAAAC,GAAA;EACtB,IAAAI,IAAA;EACJ,IAAIJ,GAAA,GAAM,CAAG;IACXI,IAAA,GAAOL,SAAA,CAAUC,GAAM;EAAA;EAElB;IAAEG,OAAA;IAASC;EAAK;AACzB;AAEa,MAAAC,aAAA,GAAgBA,CAC3BP,EAAA,EACAF,SACW;EACX,MAAM;IAAEQ;EAAA,CAAS,GAAAP,WAAA,CAAYC,EAAA,EAAIF,SAAS;EAC1C,IAAI,CAACQ,IAAA,EAAa;EACX,OAAAA,IAAA,CAAKE,EAAG,CAAAC,OAAA,CAASC,MAAO,CAAAC,KAAA;AACjC;AAEO,MAAMC,gBAAmB,GAAAA,CAC9BZ,EACA,EAAAa,MAAA,EACAf,SACG;EACG,MAAAG,SAAA,GAAYN,kBAAmB,CAAAG,SAAA,KAAc,EAAC;EACpD,MAAMI,GAAA,GAAMD,SAAU,CAAAE,SAAA,CAAWC,QAAa,IAAAA,QAAA,CAASJ,EAAA,KAAOA,EAAE;EACzD,OAAAE,GAAA,GAAM,IAAI,EAAK,GAAAW,MAAA;AACxB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}