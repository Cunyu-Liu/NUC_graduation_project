{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"files\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_table_column = _resolveComponent(\"el-table-column\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_table = _resolveComponent(\"el-table\");\n  const _component_el_empty = _resolveComponent(\"el-empty\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[2] || (_cache[2] = _createElementVNode(\"h2\", null, \"论文管理\", -1 /* CACHED */)), _createVNode(_component_el_card, null, {\n    default: _withCtx(() => [_createVNode(_component_el_table, {\n      data: $setup.files,\n      style: {\n        \"width\": \"100%\"\n      }\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_table_column, {\n        prop: \"title\",\n        label: \"论文标题\",\n        \"min-width\": \"300\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"year\",\n        label: \"年份\",\n        width: \"100\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"venue\",\n        label: \"发表期刊/会议\",\n        width: \"200\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"created_at\",\n        label: \"上传时间\",\n        formatter: $setup.formatTime,\n        width: \"180\"\n      }, null, 8 /* PROPS */, [\"formatter\"]), _createVNode(_component_el_table_column, {\n        label: \"操作\",\n        width: \"200\"\n      }, {\n        default: _withCtx(scope => [_createVNode(_component_el_button, {\n          size: \"small\",\n          onClick: $event => $setup.analyzeFile(scope.row)\n        }, {\n          default: _withCtx(() => [...(_cache[0] || (_cache[0] = [_createElementVNode(\"i\", {\n            class: \"el-icon-video-play\"\n          }, null, -1 /* CACHED */), _createTextVNode(\" 分析 \", -1 /* CACHED */)]))]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n          size: \"small\",\n          type: \"danger\",\n          onClick: $event => $setup.deleteFile(scope.row)\n        }, {\n          default: _withCtx(() => [...(_cache[1] || (_cache[1] = [_createElementVNode(\"i\", {\n            class: \"el-icon-delete\"\n          }, null, -1 /* CACHED */), _createTextVNode(\" 删除 \", -1 /* CACHED */)]))]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"data\"]), $setup.files.length === 0 ? (_openBlock(), _createBlock(_component_el_empty, {\n      key: 0,\n      description: \"暂无论文，请先上传PDF文件\"\n    })) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_createVNode","_component_el_card","_component_el_table","data","$setup","files","style","_component_el_table_column","prop","label","width","formatter","formatTime","default","_withCtx","scope","_component_el_button","size","onClick","$event","analyzeFile","row","_cache","type","deleteFile","length","_createBlock","_component_el_empty","description"],"sources":["/Users/liucunyu/Documents/all_code/NUC_graduation_project/frontend/src/views/Files.vue"],"sourcesContent":["<template>\n  <div class=\"files\">\n    <h2>论文管理</h2>\n\n    <el-card>\n      <el-table :data=\"files\" style=\"width: 100%\">\n        <el-table-column prop=\"title\" label=\"论文标题\" min-width=\"300\" />\n        <el-table-column prop=\"year\" label=\"年份\" width=\"100\" />\n        <el-table-column prop=\"venue\" label=\"发表期刊/会议\" width=\"200\" />\n        <el-table-column prop=\"created_at\" label=\"上传时间\" :formatter=\"formatTime\" width=\"180\" />\n        <el-table-column label=\"操作\" width=\"200\">\n          <template #default=\"scope\">\n            <el-button size=\"small\" @click=\"analyzeFile(scope.row)\">\n              <i class=\"el-icon-video-play\"></i> 分析\n            </el-button>\n            <el-button size=\"small\" type=\"danger\" @click=\"deleteFile(scope.row)\">\n              <i class=\"el-icon-delete\"></i> 删除\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <el-empty v-if=\"files.length === 0\" description=\"暂无论文，请先上传PDF文件\" />\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport { ElMessage, ElMessageBox } from 'element-plus'\n\nexport default {\n  name: 'Files',\n  setup() {\n    const store = useStore()\n    const router = useRouter()\n\n    const files = computed(() => store.state.files)\n\n    const formatTime = (row, column, time) => {\n      if (!time) return '-'\n      return new Date(time).toLocaleString('zh-CN')\n    }\n\n    const analyzeFile = (paper) => {\n      router.push({ path: '/analyze', query: { paperId: paper.id } })\n    }\n\n    const deleteFile = async (paper) => {\n      try {\n        await ElMessageBox.confirm(\n          `确定要删除论文 \"${paper.title || '未命名'}\" 吗？`,\n          '确认删除',\n          {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }\n        )\n\n        const success = await store.dispatch('deleteFile', paper.id)\n        if (success) {\n          ElMessage.success('删除成功')\n        } else {\n          ElMessage.error('删除失败')\n        }\n      } catch {\n        // 用户取消\n      }\n    }\n\n    onMounted(() => {\n      store.dispatch('fetchFiles')\n    })\n\n    return {\n      files,\n      formatTime,\n      analyzeFile,\n      deleteFile\n    }\n  }\n}\n</script>\n\n<style scoped>\n.files {\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\nh2 {\n  margin-bottom: 20px;\n  color: #303133;\n}\n</style>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAO;;;;;;;uBAAlBC,mBAAA,CAuBM,OAvBNC,UAuBM,G,0BAtBJC,mBAAA,CAAa,YAAT,MAAI,qBAERC,YAAA,CAmBUC,kBAAA;sBAlBR,MAeW,CAfXD,YAAA,CAeWE,mBAAA;MAfAC,IAAI,EAAEC,MAAA,CAAAC,KAAK;MAAEC,KAAmB,EAAnB;QAAA;MAAA;;wBACtB,MAA6D,CAA7DN,YAAA,CAA6DO,0BAAA;QAA5CC,IAAI,EAAC,OAAO;QAACC,KAAK,EAAC,MAAM;QAAC,WAAS,EAAC;UACrDT,YAAA,CAAsDO,0BAAA;QAArCC,IAAI,EAAC,MAAM;QAACC,KAAK,EAAC,IAAI;QAACC,KAAK,EAAC;UAC9CV,YAAA,CAA4DO,0BAAA;QAA3CC,IAAI,EAAC,OAAO;QAACC,KAAK,EAAC,SAAS;QAACC,KAAK,EAAC;UACpDV,YAAA,CAAsFO,0BAAA;QAArEC,IAAI,EAAC,YAAY;QAACC,KAAK,EAAC,MAAM;QAAEE,SAAS,EAAEP,MAAA,CAAAQ,UAAU;QAAEF,KAAK,EAAC;8CAC9EV,YAAA,CASkBO,0BAAA;QATDE,KAAK,EAAC,IAAI;QAACC,KAAK,EAAC;;QACrBG,OAAO,EAAAC,QAAA,CAGJC,KAHW,KACvBf,YAAA,CAEYgB,oBAAA;UAFDC,IAAI,EAAC,OAAO;UAAEC,OAAK,EAAAC,MAAA,IAAEf,MAAA,CAAAgB,WAAW,CAACL,KAAK,CAACM,GAAG;;4BACnD,MAAkC,KAAAC,MAAA,QAAAA,MAAA,OAAlCvB,mBAAA,CAAkC;YAA/BH,KAAK,EAAC;UAAoB,2B,iBAAK,MACpC,mB;;wCACAI,YAAA,CAEYgB,oBAAA;UAFDC,IAAI,EAAC,OAAO;UAACM,IAAI,EAAC,QAAQ;UAAEL,OAAK,EAAAC,MAAA,IAAEf,MAAA,CAAAoB,UAAU,CAACT,KAAK,CAACM,GAAG;;4BAChE,MAA8B,KAAAC,MAAA,QAAAA,MAAA,OAA9BvB,mBAAA,CAA8B;YAA3BH,KAAK,EAAC;UAAgB,2B,iBAAK,MAChC,mB;;;;;;iCAKUQ,MAAA,CAAAC,KAAK,CAACoB,MAAM,U,cAA5BC,YAAA,CAAmEC,mBAAA;;MAA/BC,WAAW,EAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}