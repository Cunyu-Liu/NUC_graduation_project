{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_upload = _resolveComponent(\"el-upload\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  return _openBlock(), _createBlock(_component_el_dialog, {\n    modelValue: $setup.visible,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.visible = $event),\n    title: \"上传PDF论文\",\n    width: \"500px\",\n    \"close-on-click-modal\": false\n  }, {\n    footer: _withCtx(() => [_createVNode(_component_el_button, {\n      onClick: _cache[0] || (_cache[0] = $event => $setup.visible = false)\n    }, {\n      default: _withCtx(() => [...(_cache[5] || (_cache[5] = [_createTextVNode(\"关闭\", -1 /* CACHED */)]))]),\n      _: 1 /* STABLE */\n    })]),\n    default: _withCtx(() => [_createVNode(_component_el_upload, {\n      class: \"upload-demo\",\n      drag: \"\",\n      action: \"/api/upload\",\n      \"on-success\": $setup.handleSuccess,\n      \"on-error\": $setup.handleError,\n      \"before-upload\": $setup.beforeUpload,\n      \"file-list\": $setup.fileList,\n      accept: \".pdf\",\n      limit: 5,\n      multiple: \"\"\n    }, {\n      tip: _withCtx(() => [...(_cache[2] || (_cache[2] = [_createElementVNode(\"div\", {\n        class: \"el-upload__tip\"\n      }, \" 只支持PDF格式，单个文件不超过50MB \", -1 /* CACHED */)]))]),\n      default: _withCtx(() => [_cache[3] || (_cache[3] = _createElementVNode(\"i\", {\n        class: \"el-icon-upload\"\n      }, null, -1 /* CACHED */)), _cache[4] || (_cache[4] = _createElementVNode(\"div\", {\n        class: \"el-upload__text\"\n      }, [_createTextVNode(\" 将PDF文件拖到此处，或\"), _createElementVNode(\"em\", null, \"点击上传\")], -1 /* CACHED */))]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"on-success\", \"on-error\", \"before-upload\", \"file-list\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]);\n}","map":{"version":3,"names":["_createBlock","_component_el_dialog","$setup","visible","$event","title","width","footer","_withCtx","_createVNode","_component_el_button","onClick","_cache","_component_el_upload","class","drag","action","handleSuccess","handleError","beforeUpload","fileList","accept","limit","multiple","tip","_createElementVNode"],"sources":["/Users/liucunyu/Documents/all_code/NUC_graduation_project/frontend/src/components/UploadDialog.vue"],"sourcesContent":["<template>\n  <el-dialog\n    v-model=\"visible\"\n    title=\"上传PDF论文\"\n    width=\"500px\"\n    :close-on-click-modal=\"false\"\n  >\n    <el-upload\n      class=\"upload-demo\"\n      drag\n    action=\"/api/upload\"\n    :on-success=\"handleSuccess\"\n    :on-error=\"handleError\"\n    :before-upload=\"beforeUpload\"\n    :file-list=\"fileList\"\n    accept=\".pdf\"\n    :limit=\"5\"\n    multiple\n    >\n      <i class=\"el-icon-upload\"></i>\n      <div class=\"el-upload__text\">\n        将PDF文件拖到此处，或<em>点击上传</em>\n      </div>\n      <template #tip>\n        <div class=\"el-upload__tip\">\n          只支持PDF格式，单个文件不超过50MB\n        </div>\n      </template>\n    </el-upload>\n\n    <template #footer>\n      <el-button @click=\"visible = false\">关闭</el-button>\n    </template>\n  </el-dialog>\n</template>\n\n<script>\nimport { computed, ref } from 'vue'\nimport { useStore } from 'vuex'\nimport { ElMessage } from 'element-plus'\n\nexport default {\n  name: 'UploadDialog',\n  setup(_, { emit }) {\n    const store = useStore()\n    const fileList = ref([])\n\n    const visible = computed({\n      get: () => store.state.showUploadDialog,\n      set: (val) => store.commit('SHOW_UPLOAD_DIALOG', val)\n    })\n\n    const beforeUpload = (file) => {\n      const isPDF = file.type === 'application/pdf'\n      const isLt50M = file.size / 1024 / 1024 < 50\n\n      if (!isPDF) {\n        ElMessage.error('只能上传PDF文件!')\n        return false\n      }\n      if (!isLt50M) {\n        ElMessage.error('文件大小不能超过50MB!')\n        return false\n      }\n      return true\n    }\n\n    const handleSuccess = (response, file) => {\n      if (response.success) {\n        ElMessage.success(`${file.name} 上传成功`)\n        emit('uploaded', response.data)\n        fileList.value = []\n      } else {\n        ElMessage.error(response.error || '上传失败')\n      }\n    }\n\n    const handleError = (error) => {\n      console.error('上传错误:', error)\n      if (error.message && error.message.includes('403')) {\n        ElMessage.error('上传失败：权限错误，请检查后端CORS配置')\n      } else if (error.message && error.message.includes('Network Error')) {\n        ElMessage.error('网络错误：请检查后端服务是否启动（端口5001）')\n      } else {\n        ElMessage.error('上传失败: ' + (error.message || '未知错误'))\n      }\n    }\n\n    return {\n      visible,\n      fileList,\n      beforeUpload,\n      handleSuccess,\n      handleError\n    }\n  }\n}\n</script>\n\n<style scoped>\n.upload-demo {\n  text-align: center;\n}\n\n.el-icon-upload {\n  font-size: 67px;\n  color: #409eff;\n  margin: 20px 0;\n}\n\n.el-upload__text {\n  font-size: 14px;\n  color: #606266;\n}\n\n.el-upload__text em {\n  color: #409eff;\n  font-style: normal;\n}\n</style>\n"],"mappings":";;;;;uBACEA,YAAA,CAgCYC,oBAAA;gBA/BDC,MAAA,CAAAC,OAAO;+DAAPD,MAAA,CAAAC,OAAO,GAAAC,MAAA;IAChBC,KAAK,EAAC,SAAS;IACfC,KAAK,EAAC,OAAO;IACZ,sBAAoB,EAAE;;IAyBZC,MAAM,EAAAC,QAAA,CACf,MAAkD,CAAlDC,YAAA,CAAkDC,oBAAA;MAAtCC,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAR,MAAA,IAAEF,MAAA,CAAAC,OAAO;;wBAAU,MAAE,KAAAS,MAAA,QAAAA,MAAA,O,iBAAF,IAAE,mB;;;sBAxBxC,MAqBY,CArBZH,YAAA,CAqBYI,oBAAA;MApBVC,KAAK,EAAC,aAAa;MACnBC,IAAI,EAAJ,EAAI;MACNC,MAAM,EAAC,aAAa;MACnB,YAAU,EAAEd,MAAA,CAAAe,aAAa;MACzB,UAAQ,EAAEf,MAAA,CAAAgB,WAAW;MACrB,eAAa,EAAEhB,MAAA,CAAAiB,YAAY;MAC3B,WAAS,EAAEjB,MAAA,CAAAkB,QAAQ;MACpBC,MAAM,EAAC,MAAM;MACZC,KAAK,EAAE,CAAC;MACTC,QAAQ,EAAR;;MAMaC,GAAG,EAAAhB,QAAA,CACZ,MAEM,KAAAI,MAAA,QAAAA,MAAA,OAFNa,mBAAA,CAEM;QAFDX,KAAK,EAAC;MAAgB,GAAC,wBAE5B,mB;wBAPF,MAA8B,C,0BAA9BW,mBAAA,CAA8B;QAA3BX,KAAK,EAAC;MAAgB,4B,0BACzBW,mBAAA,CAEM;QAFDX,KAAK,EAAC;MAAiB,I,iBAAC,eACf,GAAAW,mBAAA,CAAa,YAAT,MAAI,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}