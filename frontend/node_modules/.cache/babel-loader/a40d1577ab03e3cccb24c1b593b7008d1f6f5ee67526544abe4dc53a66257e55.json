{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport { Plus, VideoPlay, Refresh, ArrowUp, ArrowDown, Delete, CircleCheck, CircleClose, Loading, Timer, Bottom, ArrowRight, Download, Save } from '@element-plus/icons-vue';\nimport api from '@/api';\n\n// 状态\n\nexport default {\n  __name: 'ChainWorkflow',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const showAddNode = ref(false);\n    const showSaveWorkflow = ref(false);\n    const workflowName = ref('');\n    const workflowDescription = ref('');\n    const currentNode = ref(null);\n    const isExecuting = ref(false);\n    const executionProgress = ref(0);\n    const executionStatus = ref('');\n    const executionTime = ref(0);\n    const currentExecutingNode = ref(null);\n    const executionResults = ref([]);\n\n    // 链式节点\n    const chainNodes = ref([]);\n\n    // 新节点配置\n    const newNode = ref({\n      type: 'analysis',\n      name: '',\n      template: ''\n    });\n\n    // 可用模板\n    const availableTemplates = [{\n      label: '生成摘要',\n      value: 'summary',\n      type: 'analysis'\n    }, {\n      label: '提取要点',\n      value: 'keypoints',\n      type: 'analysis'\n    }, {\n      label: '识别研究空白',\n      value: 'gaps',\n      type: 'analysis'\n    }, {\n      label: '主题分析',\n      value: 'topic',\n      type: 'analysis'\n    }, {\n      label: '生成代码',\n      value: 'code',\n      type: 'generation'\n    }, {\n      label: '生成报告',\n      value: 'report',\n      type: 'generation'\n    }, {\n      label: '文献综述',\n      value: 'review',\n      type: 'generation'\n    }, {\n      label: '质量评估',\n      value: 'quality',\n      type: 'evaluation'\n    }, {\n      label: '创新性评估',\n      value: 'innovation',\n      type: 'evaluation'\n    }, {\n      label: '方法评估',\n      value: 'method',\n      type: 'evaluation'\n    }, {\n      label: '数据清洗',\n      value: 'clean',\n      type: 'transform'\n    }, {\n      label: '格式转换',\n      value: 'format',\n      type: 'transform'\n    }];\n\n    // 计算属性\n    const previousNodes = computed(() => {\n      if (!currentNode.value) return [];\n      const index = chainNodes.value.findIndex(n => n.id === currentNode.value.id);\n      return chainNodes.value.slice(0, index);\n    });\n    const availableVariables = computed(() => {\n      const vars = [{\n        name: '{{input}}',\n        description: '当前节点的输入内容'\n      }, {\n        name: '{{original}}',\n        description: '原始输入内容'\n      }];\n      previousNodes.value.forEach((node, idx) => {\n        vars.push({\n          name: `{{step${idx + 1}}}`,\n          description: `${node.name} 的输出`\n        });\n      });\n      return vars;\n    });\n\n    // 方法\n    const getNodeTypeLabel = type => {\n      const labels = {\n        analysis: '分析',\n        generation: '生成',\n        evaluation: '评估',\n        transform: '转换'\n      };\n      return labels[type] || type;\n    };\n    const getNodeTypeTag = type => {\n      const tags = {\n        analysis: 'primary',\n        generation: 'success',\n        evaluation: 'warning',\n        transform: 'info'\n      };\n      return tags[type] || '';\n    };\n    const addNode = () => {\n      if (!newNode.value.name) {\n        ElMessage.warning('请输入节点名称');\n        return;\n      }\n      const template = availableTemplates.find(t => t.value === newNode.value.template);\n      const node = {\n        id: Date.now(),\n        name: newNode.value.name,\n        type: newNode.value.type,\n        template: newNode.value.template,\n        prompt: getDefaultPrompt(newNode.value.template),\n        model: 'glm-4-plus',\n        temperature: 0.7,\n        maxTokens: 4000,\n        inputSource: chainNodes.value.length === 0 ? 'original' : chainNodes.value[chainNodes.value.length - 1].id,\n        outputFormat: 'text',\n        conditional: false,\n        condition: '',\n        status: 'pending'\n      };\n      chainNodes.value.push(node);\n      currentNode.value = node;\n      showAddNode.value = false;\n\n      // 重置新节点表单\n      newNode.value = {\n        type: 'analysis',\n        name: '',\n        template: ''\n      };\n    };\n    const getDefaultPrompt = template => {\n      const prompts = {\n        summary: '请对以下内容生成一份简洁的摘要：\\n\\n{{input}}',\n        keypoints: '请从以下内容中提取核心要点：\\n\\n{{input}}',\n        gaps: '请分析以下内容，识别研究空白：\\n\\n{{input}}',\n        topic: '请分析以下内容的主题：\\n\\n{{input}}',\n        code: '请根据以下需求生成代码：\\n\\n{{input}}',\n        report: '请根据以下内容生成报告：\\n\\n{{input}}',\n        review: '请对以下内容进行综述：\\n\\n{{input}}',\n        quality: '请评估以下内容的质量：\\n\\n{{input}}',\n        innovation: '请评估以下内容的创新性：\\n\\n{{input}}',\n        method: '请评估以下方法的合理性：\\n\\n{{input}}',\n        clean: '请清洗以下数据：\\n\\n{{input}}',\n        format: '请将以下内容转换为标准格式：\\n\\n{{input}}'\n      };\n      return prompts[template] || '请处理以下内容：\\n\\n{{input}}';\n    };\n    const removeNode = index => {\n      chainNodes.value.splice(index, 1);\n      if (currentNode.value && chainNodes.value.findIndex(n => n.id === currentNode.value.id) === -1) {\n        currentNode.value = chainNodes.value[0] || null;\n      }\n    };\n    const moveNode = (index, direction) => {\n      const newIndex = index + direction;\n      if (newIndex >= 0 && newIndex < chainNodes.value.length) {\n        const temp = chainNodes.value[index];\n        chainNodes.value[index] = chainNodes.value[newIndex];\n        chainNodes.value[newIndex] = temp;\n      }\n    };\n    const selectNode = node => {\n      currentNode.value = node;\n    };\n    const applyTemplate = template => {\n      if (currentNode.value && template) {\n        currentNode.value.prompt = getDefaultPrompt(template);\n      }\n    };\n    const workflowInput = ref('');\n    const executeChain = async () => {\n      if (chainNodes.value.length === 0) {\n        ElMessage.warning('请先添加工作流节点');\n        return;\n      }\n\n      // 如果没有输入内容，提示用户\n      if (!workflowInput.value.trim()) {\n        ElMessage.warning('请输入工作流处理内容');\n        return;\n      }\n      isExecuting.value = true;\n      executionProgress.value = 0;\n      executionStatus.value = '';\n      executionResults.value = [];\n      const startTime = Date.now();\n      try {\n        // 重置所有节点状态\n        chainNodes.value.forEach(node => {\n          node.status = 'pending';\n          node.output = null;\n          node.error = null;\n        });\n\n        // 准备节点配置\n        const nodesConfig = chainNodes.value.map(node => ({\n          id: node.id,\n          name: node.name,\n          type: node.type,\n          prompt: node.prompt,\n          model: node.model,\n          temperature: node.temperature,\n          maxTokens: node.maxTokens,\n          inputSource: node.inputSource,\n          outputFormat: node.outputFormat,\n          conditional: node.conditional,\n          condition: node.condition\n        }));\n\n        // 调用后端 API\n        const response = await api.executeWorkflow(nodesConfig, {\n          content: workflowInput.value\n        });\n        if (response.success) {\n          // 更新执行结果\n          executionResults.value = response.data.results.map((result, index) => ({\n            nodeName: result.node_name,\n            nodeType: result.node_type,\n            input: result.input_preview || '',\n            output: result.full_output || result.output_preview || '',\n            success: result.status === 'completed',\n            error: result.error,\n            expanded: index === response.data.results.length - 1\n          }));\n\n          // 更新节点状态\n          response.data.results.forEach((result, index) => {\n            if (chainNodes.value[index]) {\n              chainNodes.value[index].status = result.status;\n              chainNodes.value[index].output = result.full_output;\n              chainNodes.value[index].error = result.error;\n            }\n          });\n          executionProgress.value = 100;\n          executionStatus.value = 'success';\n          executionTime.value = response.data.total_time * 1000;\n          ElMessage.success(`工作流执行完成，耗时 ${response.data.total_time.toFixed(2)}s`);\n        } else {\n          throw new Error(response.error || '执行失败');\n        }\n      } catch (error) {\n        console.error('工作流执行错误:', error);\n        executionStatus.value = 'exception';\n        ElMessage.error(`执行失败: ${error.message}`);\n\n        // 标记当前运行的节点为错误状态\n        const runningNode = chainNodes.value.find(n => n.status === 'running');\n        if (runningNode) {\n          runningNode.status = 'error';\n          runningNode.error = error.message;\n        }\n      } finally {\n        isExecuting.value = false;\n        currentExecutingNode.value = null;\n      }\n    };\n\n    // 加载工作流模板\n    const loadTemplate = async templateId => {\n      try {\n        const response = await api.getWorkflowTemplates();\n        if (response.success) {\n          const template = response.data.find(t => t.id === templateId);\n          if (template) {\n            // 清空现有节点\n            chainNodes.value = [];\n\n            // 根据模板创建节点\n            template.nodes.forEach((nodeConfig, index) => {\n              const newNode = {\n                id: `node_${Date.now()}_${index}`,\n                name: nodeConfig.name,\n                type: nodeConfig.type,\n                template: nodeConfig.template,\n                prompt: getDefaultPrompt(nodeConfig.template),\n                model: nodeConfig.model || 'glm-4-plus',\n                temperature: 0.7,\n                maxTokens: 4000,\n                inputSource: index === 0 ? 'original' : chainNodes.value[index - 1]?.id || 'original',\n                outputFormat: 'text',\n                conditional: false,\n                condition: '',\n                status: 'pending'\n              };\n              chainNodes.value.push(newNode);\n            });\n            ElMessage.success(`已加载模板: ${template.name}`);\n          }\n        }\n      } catch (error) {\n        console.error('加载模板失败:', error);\n        ElMessage.error('加载模板失败');\n      }\n    };\n    const resetChain = () => {\n      chainNodes.value.forEach(node => {\n        node.status = 'pending';\n      });\n      executionResults.value = [];\n      executionProgress.value = 0;\n      executionTime.value = 0;\n      ElMessage.success('已重置工作流');\n    };\n    const exportResults = () => {\n      const data = JSON.stringify(executionResults.value, null, 2);\n      const blob = new Blob([data], {\n        type: 'application/json'\n      });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `workflow-results-${Date.now()}.json`;\n      a.click();\n      ElMessage.success('结果已导出');\n    };\n    const saveWorkflow = () => {\n      showSaveWorkflow.value = true;\n    };\n    const confirmSaveWorkflow = async () => {\n      if (!workflowName.value) {\n        ElMessage.warning('请输入工作流名称');\n        return;\n      }\n      try {\n        // 调用 API 保存工作流\n        // await api.saveWorkflow({\n        //   name: workflowName.value,\n        //   description: workflowDescription.value,\n        //   nodes: chainNodes.value\n        // })\n\n        ElMessage.success('工作流保存成功');\n        showSaveWorkflow.value = false;\n      } catch (error) {\n        ElMessage.error('保存失败: ' + error.message);\n      }\n    };\n    const __returned__ = {\n      showAddNode,\n      showSaveWorkflow,\n      workflowName,\n      workflowDescription,\n      currentNode,\n      isExecuting,\n      executionProgress,\n      executionStatus,\n      executionTime,\n      currentExecutingNode,\n      executionResults,\n      chainNodes,\n      newNode,\n      availableTemplates,\n      previousNodes,\n      availableVariables,\n      getNodeTypeLabel,\n      getNodeTypeTag,\n      addNode,\n      getDefaultPrompt,\n      removeNode,\n      moveNode,\n      selectNode,\n      applyTemplate,\n      workflowInput,\n      executeChain,\n      loadTemplate,\n      resetChain,\n      exportResults,\n      saveWorkflow,\n      confirmSaveWorkflow,\n      ref,\n      computed,\n      onMounted,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get Plus() {\n        return Plus;\n      },\n      get VideoPlay() {\n        return VideoPlay;\n      },\n      get Refresh() {\n        return Refresh;\n      },\n      get ArrowUp() {\n        return ArrowUp;\n      },\n      get ArrowDown() {\n        return ArrowDown;\n      },\n      get Delete() {\n        return Delete;\n      },\n      get CircleCheck() {\n        return CircleCheck;\n      },\n      get CircleClose() {\n        return CircleClose;\n      },\n      get Loading() {\n        return Loading;\n      },\n      get Timer() {\n        return Timer;\n      },\n      get Bottom() {\n        return Bottom;\n      },\n      get ArrowRight() {\n        return ArrowRight;\n      },\n      get Download() {\n        return Download;\n      },\n      get Save() {\n        return Save;\n      },\n      get api() {\n        return api;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","ElMessage","Plus","VideoPlay","Refresh","ArrowUp","ArrowDown","Delete","CircleCheck","CircleClose","Loading","Timer","Bottom","ArrowRight","Download","Save","api","showAddNode","showSaveWorkflow","workflowName","workflowDescription","currentNode","isExecuting","executionProgress","executionStatus","executionTime","currentExecutingNode","executionResults","chainNodes","newNode","type","name","template","availableTemplates","label","value","previousNodes","index","findIndex","n","id","slice","availableVariables","vars","description","forEach","node","idx","push","getNodeTypeLabel","labels","analysis","generation","evaluation","transform","getNodeTypeTag","tags","addNode","warning","find","t","Date","now","prompt","getDefaultPrompt","model","temperature","maxTokens","inputSource","length","outputFormat","conditional","condition","status","prompts","summary","keypoints","gaps","topic","code","report","review","quality","innovation","method","clean","format","removeNode","splice","moveNode","direction","newIndex","temp","selectNode","applyTemplate","workflowInput","executeChain","trim","startTime","output","error","nodesConfig","map","response","executeWorkflow","content","success","data","results","result","nodeName","node_name","nodeType","node_type","input","input_preview","full_output","output_preview","expanded","total_time","toFixed","Error","console","message","runningNode","loadTemplate","templateId","getWorkflowTemplates","nodes","nodeConfig","resetChain","exportResults","JSON","stringify","blob","Blob","url","URL","createObjectURL","a","document","createElement","href","download","click","saveWorkflow","confirmSaveWorkflow"],"sources":["/Users/liucunyu/Documents/all_code/NUC_graduation_project/frontend/src/views/ChainWorkflow.vue"],"sourcesContent":["<template>\n  <div class=\"chain-workflow-container\">\n    <!-- 左侧：输入和配置面板 -->\n    <div class=\"chain-input-panel\">\n      <div class=\"panel-header\">\n        <h2>输入内容</h2>\n      </div>\n      \n      <div class=\"input-section\">\n        <el-input\n          v-model=\"workflowInput\"\n          type=\"textarea\"\n          :rows=\"10\"\n          placeholder=\"输入要处理的论文内容、研究问题或其他文本...\"\n          resize=\"none\"\n        />\n      </div>\n      \n      <div class=\"templates-section\">\n        <h3>快速加载模板</h3>\n        <div class=\"template-buttons\">\n          <el-button size=\"small\" @click=\"loadTemplate('summary')\">论文分析</el-button>\n          <el-button size=\"small\" @click=\"loadTemplate('review')\">文献综述</el-button>\n          <el-button size=\"small\" @click=\"loadTemplate('code')\">代码生成</el-button>\n          <el-button size=\"small\" @click=\"loadTemplate('topic')\">主题研究</el-button>\n        </div>\n      </div>\n    </div>\n\n    <!-- 中间：链式配置面板 -->\n    <div class=\"chain-config-panel\">\n      <div class=\"panel-header\">\n        <h2>链式工作流配置</h2>\n        <el-tooltip content=\"添加节点\">\n          <el-button type=\"primary\" circle @click=\"showAddNode = true\">\n            <el-icon><Plus /></el-icon>\n          </el-button>\n        </el-tooltip>\n      </div>\n\n      <!-- 节点列表 -->\n      <div class=\"nodes-list\">\n        <div\n          v-for=\"(node, index) in chainNodes\"\n          :key=\"node.id\"\n          class=\"chain-node\"\n          :class=\"{ \n            'active': currentNode?.id === node.id,\n            'completed': node.status === 'completed',\n            'running': node.status === 'running',\n            'error': node.status === 'error'\n          }\"\n          @click=\"selectNode(node)\"\n        >\n          <div class=\"node-index\">{{ index + 1 }}</div>\n          <div class=\"node-info\">\n            <div class=\"node-name\">{{ node.name }}</div>\n            <div class=\"node-type\">{{ getNodeTypeLabel(node.type) }}</div>\n          </div>\n          <div class=\"node-status\">\n            <el-icon v-if=\"node.status === 'completed'\" class=\"status-icon success\"><CircleCheck /></el-icon>\n            <el-icon v-else-if=\"node.status === 'running'\" class=\"status-icon running\"><Loading /></el-icon>\n            <el-icon v-else-if=\"node.status === 'error'\" class=\"status-icon error\"><CircleClose /></el-icon>\n            <el-icon v-else class=\"status-icon pending\"><Timer /></el-icon>\n          </div>\n          <div class=\"node-actions\">\n            <el-icon class=\"action-btn\" @click.stop=\"moveNode(index, -1)\" v-if=\"index > 0\"><ArrowUp /></el-icon>\n            <el-icon class=\"action-btn\" @click.stop=\"moveNode(index, 1)\" v-if=\"index < chainNodes.length - 1\"><ArrowDown /></el-icon>\n            <el-icon class=\"action-btn delete\" @click.stop=\"removeNode(index)\"><Delete /></el-icon>\n          </div>\n        </div>\n\n        <!-- 空状态 -->\n        <el-empty v-if=\"chainNodes.length === 0\" description=\"暂无节点，点击右上角添加\" />\n      </div>\n\n      <!-- 连接箭头 -->\n      <div v-if=\"chainNodes.length > 1\" class=\"chain-connections\">\n        <div\n          v-for=\"i in chainNodes.length - 1\"\n          :key=\"i\"\n          class=\"connection-line\"\n        >\n          <el-icon><Bottom /></el-icon>\n        </div>\n      </div>\n\n      <!-- 执行按钮 -->\n      <div class=\"panel-footer\">\n        <el-button \n          type=\"primary\" \n          size=\"large\" \n          class=\"execute-btn\"\n          :loading=\"isExecuting\"\n          :disabled=\"chainNodes.length === 0\"\n          @click=\"executeChain\"\n        >\n          <el-icon><VideoPlay /></el-icon>\n          执行链式调用\n        </el-button>\n        <el-button size=\"large\" @click=\"resetChain\">\n          <el-icon><Refresh /></el-icon>\n          重置\n        </el-button>\n      </div>\n    </div>\n\n    <!-- 中间：节点配置详情 -->\n    <div class=\"node-config-panel\" v-if=\"currentNode\">\n      <div class=\"panel-header\">\n        <h3>{{ currentNode.name }}</h3>\n        <el-tag :type=\"getNodeTypeTag(currentNode.type)\">\n          {{ getNodeTypeLabel(currentNode.type) }}\n        </el-tag>\n      </div>\n\n      <el-form label-width=\"100px\" class=\"node-form\">\n        <!-- 节点名称 -->\n        <el-form-item label=\"节点名称\">\n          <el-input v-model=\"currentNode.name\" placeholder=\"输入节点名称\" />\n        </el-form-item>\n\n        <!-- 输入源 -->\n        <el-form-item label=\"输入源\">\n          <el-select v-model=\"currentNode.inputSource\" style=\"width: 100%\">\n            <el-option label=\"原始输入\" value=\"original\" />\n            <el-option \n              v-for=\"(node, idx) in previousNodes\" \n              :key=\"node.id\"\n              :label=\"`步骤 ${idx + 1}: ${node.name}`\"\n              :value=\"node.id\"\n            />\n          </el-select>\n        </el-form-item>\n\n        <!-- 提示词模板 -->\n        <el-form-item label=\"提示词模板\">\n          <el-select \n            v-model=\"currentNode.template\" \n            placeholder=\"选择预设模板\"\n            style=\"width: 100%\"\n            @change=\"applyTemplate\"\n          >\n            <el-option-group label=\"分析类\">\n              <el-option label=\"生成摘要\" value=\"summary\" />\n              <el-option label=\"提取要点\" value=\"keypoints\" />\n              <el-option label=\"识别研究空白\" value=\"gaps\" />\n              <el-option label=\"主题分析\" value=\"topic\" />\n            </el-option-group>\n            <el-option-group label=\"生成类\">\n              <el-option label=\"生成代码\" value=\"code\" />\n              <el-option label=\"生成报告\" value=\"report\" />\n              <el-option label=\"文献综述\" value=\"review\" />\n            </el-option-group>\n            <el-option-group label=\"评估类\">\n              <el-option label=\"质量评估\" value=\"quality\" />\n              <el-option label=\"创新性评估\" value=\"innovation\" />\n              <el-option label=\"方法评估\" value=\"method\" />\n            </el-option-group>\n          </el-select>\n        </el-form-item>\n\n        <!-- 自定义提示词 -->\n        <el-form-item label=\"自定义提示\">\n          <el-input\n            v-model=\"currentNode.prompt\"\n            type=\"textarea\"\n            :rows=\"6\"\n            placeholder=\"输入自定义提示词，使用 {{input}} 引用输入内容\"\n          />\n        </el-form-item>\n\n        <!-- 模型配置 -->\n        <el-form-item label=\"模型\">\n          <el-select v-model=\"currentNode.model\" style=\"width: 100%\">\n            <el-option label=\"GLM-4-Plus\" value=\"glm-4-plus\" />\n            <el-option label=\"GLM-4-Flash\" value=\"glm-4-flash\" />\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"温度\">\n          <el-slider v-model=\"currentNode.temperature\" :min=\"0\" :max=\"1\" :step=\"0.1\" show-stops />\n        </el-form-item>\n\n        <el-form-item label=\"最大长度\">\n          <el-input-number v-model=\"currentNode.maxTokens\" :min=\"500\" :max=\"8000\" :step=\"500\" />\n        </el-form-item>\n\n        <!-- 输出处理 -->\n        <el-form-item label=\"输出格式\">\n          <el-radio-group v-model=\"currentNode.outputFormat\">\n            <el-radio label=\"text\">纯文本</el-radio>\n            <el-radio label=\"json\">JSON</el-radio>\n            <el-radio label=\"markdown\">Markdown</el-radio>\n          </el-radio-group>\n        </el-form-item>\n\n        <!-- 条件分支 -->\n        <el-form-item label=\"条件执行\">\n          <el-switch v-model=\"currentNode.conditional\" />\n        </el-form-item>\n\n        <el-form-item v-if=\"currentNode.conditional\" label=\"条件表达式\">\n          <el-input\n            v-model=\"currentNode.condition\"\n            placeholder=\"例如: input.score > 0.8\"\n          />\n        </el-form-item>\n      </el-form>\n\n      <!-- 变量预览 -->\n      <div class=\"variables-preview\">\n        <div class=\"preview-title\">可用变量</div>\n        <div class=\"variable-list\">\n          <el-tag v-for=\"variable in availableVariables\" :key=\"variable.name\" size=\"small\" class=\"variable-tag\">\n            {{ variable.name }}: {{ variable.description }}\n          </el-tag>\n        </div>\n      </div>\n    </div>\n\n    <!-- 右侧：执行结果 -->\n    <div class=\"execution-panel\">\n      <div class=\"panel-header\">\n        <h3>执行结果</h3>\n        <div class=\"execution-stats\" v-if=\"executionTime > 0\">\n          <el-tag size=\"small\" type=\"info\">\n            <el-icon><Timer /></el-icon>\n            {{ executionTime }}ms\n          </el-tag>\n        </div>\n      </div>\n\n      <!-- 进度条 -->\n      <div v-if=\"isExecuting\" class=\"execution-progress\">\n        <el-progress \n          :percentage=\"executionProgress\" \n          :status=\"executionStatus\"\n          :stroke-width=\"8\"\n        />\n        <div class=\"current-step\">正在执行: {{ currentExecutingNode?.name }}</div>\n      </div>\n\n      <!-- 结果列表 -->\n      <div class=\"results-list\" v-else>\n        <div\n          v-for=\"(result, index) in executionResults\"\n          :key=\"index\"\n          class=\"result-item\"\n          :class=\"{ 'expanded': result.expanded }\"\n        >\n          <div class=\"result-header\" @click=\"result.expanded = !result.expanded\">\n            <div class=\"result-title\">\n              <span class=\"step-number\">步骤 {{ index + 1 }}</span>\n              <span class=\"node-name\">{{ result.nodeName }}</span>\n            </div>\n            <div class=\"result-meta\">\n              <el-tag size=\"small\" :type=\"result.success ? 'success' : 'danger'\">\n                {{ result.success ? '成功' : '失败' }}\n              </el-tag>\n              <el-icon class=\"expand-icon\"><ArrowDown v-if=\"result.expanded\" /><ArrowRight v-else /></el-icon>\n            </div>\n          </div>\n          \n          <div v-if=\"result.expanded\" class=\"result-content\">\n            <div class=\"result-section\">\n              <div class=\"section-title\">输入</div>\n              <pre class=\"section-content input\">{{ result.input }}</pre>\n            </div>\n            <div class=\"result-section\">\n              <div class=\"section-title\">输出</div>\n              <pre class=\"section-content output\">{{ result.output }}</pre>\n            </div>\n            <div v-if=\"result.error\" class=\"result-section\">\n              <div class=\"section-title\">错误</div>\n              <pre class=\"section-content error\">{{ result.error }}</pre>\n            </div>\n          </div>\n        </div>\n\n        <!-- 空状态 -->\n        <el-empty v-if=\"executionResults.length === 0\" description=\"尚未执行，请配置工作流并点击执行\" />\n      </div>\n\n      <!-- 操作按钮 -->\n      <div class=\"panel-footer\" v-if=\"executionResults.length > 0\">\n        <el-button @click=\"exportResults\">\n          <el-icon><Download /></el-icon>\n          导出结果\n        </el-button>\n        <el-button type=\"primary\" @click=\"saveWorkflow\">\n          <el-icon><Save /></el-icon>\n          保存工作流\n        </el-button>\n      </div>\n    </div>\n\n    <!-- 添加节点对话框 -->\n    <el-dialog v-model=\"showAddNode\" title=\"添加节点\" width=\"500px\">\n      <el-form label-width=\"80px\">\n        <el-form-item label=\"节点类型\">\n          <el-radio-group v-model=\"newNode.type\">\n            <el-radio-button label=\"analysis\">分析</el-radio-button>\n            <el-radio-button label=\"generation\">生成</el-radio-button>\n            <el-radio-button label=\"evaluation\">评估</el-radio-button>\n            <el-radio-button label=\"transform\">转换</el-radio-button>\n          </el-radio-group>\n        </el-form-item>\n        \n        <el-form-item label=\"节点名称\">\n          <el-input v-model=\"newNode.name\" placeholder=\"输入节点名称\" />\n        </el-form-item>\n\n        <el-form-item label=\"模板\">\n          <el-select v-model=\"newNode.template\" placeholder=\"选择预设模板\" style=\"width: 100%\">\n            <el-option\n              v-for=\"template in availableTemplates\"\n              :key=\"template.value\"\n              :label=\"template.label\"\n              :value=\"template.value\"\n            />\n          </el-select>\n        </el-form-item>\n      </el-form>\n      \n      <template #footer>\n        <el-button @click=\"showAddNode = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"addNode\">确定</el-button>\n      </template>\n    </el-dialog>\n\n    <!-- 保存工作流对话框 -->\n    <el-dialog v-model=\"showSaveWorkflow\" title=\"保存工作流\" width=\"400px\">\n      <el-form label-width=\"80px\">\n        <el-form-item label=\"名称\">\n          <el-input v-model=\"workflowName\" placeholder=\"输入工作流名称\" />\n        </el-form-item>\n        <el-form-item label=\"描述\">\n          <el-input v-model=\"workflowDescription\" type=\"textarea\" :rows=\"3\" placeholder=\"输入工作流描述\" />\n        </el-form-item>\n      </el-form>\n      \n      <template #footer>\n        <el-button @click=\"showSaveWorkflow = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmSaveWorkflow\">保存</el-button>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport {\n  Plus, VideoPlay, Refresh, ArrowUp, ArrowDown, Delete,\n  CircleCheck, CircleClose, Loading, Timer, Bottom,\n  ArrowRight,\n  Download, Save\n} from '@element-plus/icons-vue'\nimport api from '@/api'\n\n// 状态\nconst showAddNode = ref(false)\nconst showSaveWorkflow = ref(false)\nconst workflowName = ref('')\nconst workflowDescription = ref('')\nconst currentNode = ref(null)\nconst isExecuting = ref(false)\nconst executionProgress = ref(0)\nconst executionStatus = ref('')\nconst executionTime = ref(0)\nconst currentExecutingNode = ref(null)\nconst executionResults = ref([])\n\n// 链式节点\nconst chainNodes = ref([])\n\n// 新节点配置\nconst newNode = ref({\n  type: 'analysis',\n  name: '',\n  template: ''\n})\n\n// 可用模板\nconst availableTemplates = [\n  { label: '生成摘要', value: 'summary', type: 'analysis' },\n  { label: '提取要点', value: 'keypoints', type: 'analysis' },\n  { label: '识别研究空白', value: 'gaps', type: 'analysis' },\n  { label: '主题分析', value: 'topic', type: 'analysis' },\n  { label: '生成代码', value: 'code', type: 'generation' },\n  { label: '生成报告', value: 'report', type: 'generation' },\n  { label: '文献综述', value: 'review', type: 'generation' },\n  { label: '质量评估', value: 'quality', type: 'evaluation' },\n  { label: '创新性评估', value: 'innovation', type: 'evaluation' },\n  { label: '方法评估', value: 'method', type: 'evaluation' },\n  { label: '数据清洗', value: 'clean', type: 'transform' },\n  { label: '格式转换', value: 'format', type: 'transform' }\n]\n\n// 计算属性\nconst previousNodes = computed(() => {\n  if (!currentNode.value) return []\n  const index = chainNodes.value.findIndex(n => n.id === currentNode.value.id)\n  return chainNodes.value.slice(0, index)\n})\n\nconst availableVariables = computed(() => {\n  const vars = [\n    { name: '{{input}}', description: '当前节点的输入内容' },\n    { name: '{{original}}', description: '原始输入内容' }\n  ]\n  \n  previousNodes.value.forEach((node, idx) => {\n    vars.push({\n      name: `{{step${idx + 1}}}`,\n      description: `${node.name} 的输出`\n    })\n  })\n  \n  return vars\n})\n\n// 方法\nconst getNodeTypeLabel = (type) => {\n  const labels = {\n    analysis: '分析',\n    generation: '生成',\n    evaluation: '评估',\n    transform: '转换'\n  }\n  return labels[type] || type\n}\n\nconst getNodeTypeTag = (type) => {\n  const tags = {\n    analysis: 'primary',\n    generation: 'success',\n    evaluation: 'warning',\n    transform: 'info'\n  }\n  return tags[type] || ''\n}\n\nconst addNode = () => {\n  if (!newNode.value.name) {\n    ElMessage.warning('请输入节点名称')\n    return\n  }\n  \n  const template = availableTemplates.find(t => t.value === newNode.value.template)\n  \n  const node = {\n    id: Date.now(),\n    name: newNode.value.name,\n    type: newNode.value.type,\n    template: newNode.value.template,\n    prompt: getDefaultPrompt(newNode.value.template),\n    model: 'glm-4-plus',\n    temperature: 0.7,\n    maxTokens: 4000,\n    inputSource: chainNodes.value.length === 0 ? 'original' : chainNodes.value[chainNodes.value.length - 1].id,\n    outputFormat: 'text',\n    conditional: false,\n    condition: '',\n    status: 'pending'\n  }\n  \n  chainNodes.value.push(node)\n  currentNode.value = node\n  showAddNode.value = false\n  \n  // 重置新节点表单\n  newNode.value = { type: 'analysis', name: '', template: '' }\n}\n\nconst getDefaultPrompt = (template) => {\n  const prompts = {\n    summary: '请对以下内容生成一份简洁的摘要：\\n\\n{{input}}',\n    keypoints: '请从以下内容中提取核心要点：\\n\\n{{input}}',\n    gaps: '请分析以下内容，识别研究空白：\\n\\n{{input}}',\n    topic: '请分析以下内容的主题：\\n\\n{{input}}',\n    code: '请根据以下需求生成代码：\\n\\n{{input}}',\n    report: '请根据以下内容生成报告：\\n\\n{{input}}',\n    review: '请对以下内容进行综述：\\n\\n{{input}}',\n    quality: '请评估以下内容的质量：\\n\\n{{input}}',\n    innovation: '请评估以下内容的创新性：\\n\\n{{input}}',\n    method: '请评估以下方法的合理性：\\n\\n{{input}}',\n    clean: '请清洗以下数据：\\n\\n{{input}}',\n    format: '请将以下内容转换为标准格式：\\n\\n{{input}}'\n  }\n  return prompts[template] || '请处理以下内容：\\n\\n{{input}}'\n}\n\nconst removeNode = (index) => {\n  chainNodes.value.splice(index, 1)\n  if (currentNode.value && chainNodes.value.findIndex(n => n.id === currentNode.value.id) === -1) {\n    currentNode.value = chainNodes.value[0] || null\n  }\n}\n\nconst moveNode = (index, direction) => {\n  const newIndex = index + direction\n  if (newIndex >= 0 && newIndex < chainNodes.value.length) {\n    const temp = chainNodes.value[index]\n    chainNodes.value[index] = chainNodes.value[newIndex]\n    chainNodes.value[newIndex] = temp\n  }\n}\n\nconst selectNode = (node) => {\n  currentNode.value = node\n}\n\nconst applyTemplate = (template) => {\n  if (currentNode.value && template) {\n    currentNode.value.prompt = getDefaultPrompt(template)\n  }\n}\n\nconst workflowInput = ref('')\n\nconst executeChain = async () => {\n  if (chainNodes.value.length === 0) {\n    ElMessage.warning('请先添加工作流节点')\n    return\n  }\n  \n  // 如果没有输入内容，提示用户\n  if (!workflowInput.value.trim()) {\n    ElMessage.warning('请输入工作流处理内容')\n    return\n  }\n  \n  isExecuting.value = true\n  executionProgress.value = 0\n  executionStatus.value = ''\n  executionResults.value = []\n  \n  const startTime = Date.now()\n  \n  try {\n    // 重置所有节点状态\n    chainNodes.value.forEach(node => {\n      node.status = 'pending'\n      node.output = null\n      node.error = null\n    })\n    \n    // 准备节点配置\n    const nodesConfig = chainNodes.value.map(node => ({\n      id: node.id,\n      name: node.name,\n      type: node.type,\n      prompt: node.prompt,\n      model: node.model,\n      temperature: node.temperature,\n      maxTokens: node.maxTokens,\n      inputSource: node.inputSource,\n      outputFormat: node.outputFormat,\n      conditional: node.conditional,\n      condition: node.condition\n    }))\n    \n    // 调用后端 API\n    const response = await api.executeWorkflow(nodesConfig, {\n      content: workflowInput.value\n    })\n    \n    if (response.success) {\n      // 更新执行结果\n      executionResults.value = response.data.results.map((result, index) => ({\n        nodeName: result.node_name,\n        nodeType: result.node_type,\n        input: result.input_preview || '',\n        output: result.full_output || result.output_preview || '',\n        success: result.status === 'completed',\n        error: result.error,\n        expanded: index === response.data.results.length - 1\n      }))\n      \n      // 更新节点状态\n      response.data.results.forEach((result, index) => {\n        if (chainNodes.value[index]) {\n          chainNodes.value[index].status = result.status\n          chainNodes.value[index].output = result.full_output\n          chainNodes.value[index].error = result.error\n        }\n      })\n      \n      executionProgress.value = 100\n      executionStatus.value = 'success'\n      executionTime.value = response.data.total_time * 1000\n      \n      ElMessage.success(`工作流执行完成，耗时 ${response.data.total_time.toFixed(2)}s`)\n    } else {\n      throw new Error(response.error || '执行失败')\n    }\n    \n  } catch (error) {\n    console.error('工作流执行错误:', error)\n    executionStatus.value = 'exception'\n    ElMessage.error(`执行失败: ${error.message}`)\n    \n    // 标记当前运行的节点为错误状态\n    const runningNode = chainNodes.value.find(n => n.status === 'running')\n    if (runningNode) {\n      runningNode.status = 'error'\n      runningNode.error = error.message\n    }\n  } finally {\n    isExecuting.value = false\n    currentExecutingNode.value = null\n  }\n}\n\n// 加载工作流模板\nconst loadTemplate = async (templateId) => {\n  try {\n    const response = await api.getWorkflowTemplates()\n    if (response.success) {\n      const template = response.data.find(t => t.id === templateId)\n      if (template) {\n        // 清空现有节点\n        chainNodes.value = []\n        \n        // 根据模板创建节点\n        template.nodes.forEach((nodeConfig, index) => {\n          const newNode = {\n            id: `node_${Date.now()}_${index}`,\n            name: nodeConfig.name,\n            type: nodeConfig.type,\n            template: nodeConfig.template,\n            prompt: getDefaultPrompt(nodeConfig.template),\n            model: nodeConfig.model || 'glm-4-plus',\n            temperature: 0.7,\n            maxTokens: 4000,\n            inputSource: index === 0 ? 'original' : chainNodes.value[index - 1]?.id || 'original',\n            outputFormat: 'text',\n            conditional: false,\n            condition: '',\n            status: 'pending'\n          }\n          chainNodes.value.push(newNode)\n        })\n        \n        ElMessage.success(`已加载模板: ${template.name}`)\n      }\n    }\n  } catch (error) {\n    console.error('加载模板失败:', error)\n    ElMessage.error('加载模板失败')\n  }\n}\n\nconst resetChain = () => {\n  chainNodes.value.forEach(node => {\n    node.status = 'pending'\n  })\n  executionResults.value = []\n  executionProgress.value = 0\n  executionTime.value = 0\n  ElMessage.success('已重置工作流')\n}\n\nconst exportResults = () => {\n  const data = JSON.stringify(executionResults.value, null, 2)\n  const blob = new Blob([data], { type: 'application/json' })\n  const url = URL.createObjectURL(blob)\n  const a = document.createElement('a')\n  a.href = url\n  a.download = `workflow-results-${Date.now()}.json`\n  a.click()\n  ElMessage.success('结果已导出')\n}\n\nconst saveWorkflow = () => {\n  showSaveWorkflow.value = true\n}\n\nconst confirmSaveWorkflow = async () => {\n  if (!workflowName.value) {\n    ElMessage.warning('请输入工作流名称')\n    return\n  }\n  \n  try {\n    // 调用 API 保存工作流\n    // await api.saveWorkflow({\n    //   name: workflowName.value,\n    //   description: workflowDescription.value,\n    //   nodes: chainNodes.value\n    // })\n    \n    ElMessage.success('工作流保存成功')\n    showSaveWorkflow.value = false\n  } catch (error) {\n    ElMessage.error('保存失败: ' + error.message)\n  }\n}\n</script>\n\n<style scoped>\n.chain-workflow-container {\n  display: flex;\n  height: calc(100vh - 64px);\n  background: #f5f7fa;\n}\n\n/* 左侧配置面板 */\n.chain-config-panel {\n  width: 320px;\n  background: #fff;\n  border-right: 1px solid #e4e7ed;\n  display: flex;\n  flex-direction: column;\n}\n\n.panel-header {\n  padding: 16px 20px;\n  border-bottom: 1px solid #e4e7ed;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.panel-header h2 {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.panel-header h3 {\n  margin: 0;\n  font-size: 15px;\n  font-weight: 500;\n}\n\n.nodes-list {\n  flex: 1;\n  overflow-y: auto;\n  padding: 12px;\n  position: relative;\n}\n\n.chain-node {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px;\n  background: #fff;\n  border: 2px solid #e4e7ed;\n  border-radius: 8px;\n  margin-bottom: 8px;\n  cursor: pointer;\n  transition: all 0.3s;\n}\n\n.chain-node:hover {\n  border-color: #409eff;\n  box-shadow: 0 2px 8px rgba(64, 158, 255, 0.15);\n}\n\n.chain-node.active {\n  border-color: #409eff;\n  background: #f0f9ff;\n}\n\n.chain-node.completed {\n  border-color: #67c23a;\n}\n\n.chain-node.running {\n  border-color: #e6a23c;\n  animation: pulse 1.5s infinite;\n}\n\n.chain-node.error {\n  border-color: #f56c6c;\n}\n\n@keyframes pulse {\n  0%, 100% { opacity: 1; }\n  50% { opacity: 0.7; }\n}\n\n.node-index {\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  background: #409eff;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 12px;\n  font-weight: 600;\n}\n\n.node-info {\n  flex: 1;\n  min-width: 0;\n}\n\n.node-name {\n  font-size: 14px;\n  font-weight: 500;\n  color: #303133;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.node-type {\n  font-size: 12px;\n  color: #909399;\n  margin-top: 2px;\n}\n\n.node-status {\n  display: flex;\n  align-items: center;\n}\n\n.status-icon {\n  font-size: 18px;\n}\n\n.status-icon.success {\n  color: #67c23a;\n}\n\n.status-icon.running {\n  color: #e6a23c;\n}\n\n.status-icon.error {\n  color: #f56c6c;\n}\n\n.status-icon.pending {\n  color: #c0c4cc;\n}\n\n.node-actions {\n  display: flex;\n  gap: 4px;\n  opacity: 0;\n  transition: opacity 0.2s;\n}\n\n.chain-node:hover .node-actions {\n  opacity: 1;\n}\n\n.action-btn {\n  font-size: 14px;\n  color: #909399;\n  cursor: pointer;\n  padding: 2px;\n  border-radius: 4px;\n  transition: all 0.2s;\n}\n\n.action-btn:hover {\n  background: #f5f7fa;\n  color: #409eff;\n}\n\n.action-btn.delete:hover {\n  color: #f56c6c;\n}\n\n.chain-connections {\n  position: absolute;\n  left: 32px;\n  top: 40px;\n  display: flex;\n  flex-direction: column;\n  gap: 44px;\n  pointer-events: none;\n  color: #c0c4cc;\n}\n\n.connection-line {\n  font-size: 16px;\n}\n\n.panel-footer {\n  padding: 16px 20px;\n  border-top: 1px solid #e4e7ed;\n  display: flex;\n  gap: 12px;\n}\n\n.execute-btn {\n  flex: 1;\n}\n\n/* 中间配置面板 */\n.node-config-panel {\n  width: 400px;\n  background: #fff;\n  border-right: 1px solid #e4e7ed;\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n}\n\n.node-form {\n  padding: 20px;\n}\n\n.variables-preview {\n  padding: 0 20px 20px;\n}\n\n.preview-title {\n  font-size: 13px;\n  color: #606266;\n  margin-bottom: 8px;\n}\n\n.variable-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n}\n\n.variable-tag {\n  cursor: help;\n}\n\n/* 右侧执行面板 */\n.execution-panel {\n  flex: 1;\n  background: #fff;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n\n.execution-stats {\n  display: flex;\n  gap: 8px;\n}\n\n.execution-progress {\n  padding: 20px;\n  border-bottom: 1px solid #e4e7ed;\n}\n\n.current-step {\n  text-align: center;\n  margin-top: 8px;\n  color: #606266;\n  font-size: 13px;\n}\n\n.results-list {\n  flex: 1;\n  overflow-y: auto;\n  padding: 16px;\n}\n\n.result-item {\n  border: 1px solid #e4e7ed;\n  border-radius: 8px;\n  margin-bottom: 12px;\n  overflow: hidden;\n}\n\n.result-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  background: #f5f7fa;\n  cursor: pointer;\n  transition: background 0.2s;\n}\n\n.result-header:hover {\n  background: #e4e7ed;\n}\n\n.result-title {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.step-number {\n  font-size: 12px;\n  color: #909399;\n  background: #fff;\n  padding: 2px 8px;\n  border-radius: 4px;\n}\n\n.node-name {\n  font-weight: 500;\n  color: #303133;\n}\n\n.result-meta {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.expand-icon {\n  color: #909399;\n  transition: transform 0.2s;\n}\n\n.result-content {\n  padding: 16px;\n}\n\n.result-section {\n  margin-bottom: 16px;\n}\n\n.result-section:last-child {\n  margin-bottom: 0;\n}\n\n.section-title {\n  font-size: 12px;\n  color: #909399;\n  margin-bottom: 8px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.section-content {\n  background: #f5f7fa;\n  padding: 12px;\n  border-radius: 6px;\n  font-size: 13px;\n  line-height: 1.6;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  font-family: 'Monaco', 'Menlo', monospace;\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.section-content.input {\n  background: #ecf5ff;\n  color: #409eff;\n}\n\n.section-content.output {\n  background: #f0f9ff;\n  color: #303133;\n}\n\n.section-content.error {\n  background: #fef0f0;\n  color: #f56c6c;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}