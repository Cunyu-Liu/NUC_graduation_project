{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.every.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { defineComponent, inject, ref, computed, watch, nextTick, onBeforeUnmount, openBlock, createElementBlock, normalizeClass, unref, normalizeStyle, createCommentVNode } from 'vue';\nimport { useResizeObserver } from '@vueuse/core';\nimport { tabsRootContextKey } from './constants.mjs';\nimport { tabBarProps } from './tab-bar.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { capitalize } from '../../../utils/strings.mjs';\nimport { throwError } from '../../../utils/error.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { isUndefined } from '../../../utils/types.mjs';\nconst COMPONENT_NAME = \"ElTabBar\";\nconst _sfc_main = defineComponent({\n  ...{\n    name: COMPONENT_NAME\n  },\n  __name: \"tab-bar\",\n  props: tabBarProps,\n  setup(__props, {\n    expose: __expose\n  }) {\n    const props = __props;\n    const rootTabs = inject(tabsRootContextKey);\n    if (!rootTabs) throwError(COMPONENT_NAME, \"<el-tabs><el-tab-bar /></el-tabs>\");\n    const ns = useNamespace(\"tabs\");\n    const barRef = ref();\n    const barStyle = ref();\n    const renderActiveBar = computed(() => {\n      var _a;\n      return isUndefined(rootTabs.props.defaultValue) || Boolean((_a = barStyle.value) == null ? void 0 : _a.transform);\n    });\n    const getBarStyle = () => {\n      let offset = 0;\n      let tabSize = 0;\n      const sizeName = [\"top\", \"bottom\"].includes(rootTabs.props.tabPosition) ? \"width\" : \"height\";\n      const sizeDir = sizeName === \"width\" ? \"x\" : \"y\";\n      const position = sizeDir === \"x\" ? \"left\" : \"top\";\n      props.tabs.every(tab => {\n        if (isUndefined(tab.paneName)) return false;\n        const $el = props.tabRefs[tab.paneName];\n        if (!$el) return false;\n        if (!tab.active) {\n          return true;\n        }\n        offset = $el[`offset${capitalize(position)}`];\n        tabSize = $el[`client${capitalize(sizeName)}`];\n        const tabStyles = window.getComputedStyle($el);\n        if (sizeName === \"width\") {\n          tabSize -= Number.parseFloat(tabStyles.paddingLeft) + Number.parseFloat(tabStyles.paddingRight);\n          offset += Number.parseFloat(tabStyles.paddingLeft);\n        }\n        return false;\n      });\n      return {\n        [sizeName]: `${tabSize}px`,\n        transform: `translate${capitalize(sizeDir)}(${offset}px)`\n      };\n    };\n    const update = () => barStyle.value = getBarStyle();\n    const tabObservers = [];\n    const observerTabs = () => {\n      tabObservers.forEach(observer => observer.stop());\n      tabObservers.length = 0;\n      Object.values(props.tabRefs).forEach(tab => {\n        tabObservers.push(useResizeObserver(tab, update));\n      });\n    };\n    watch(() => props.tabs, async () => {\n      await nextTick();\n      update();\n      observerTabs();\n    }, {\n      immediate: true\n    });\n    const barObserver = useResizeObserver(barRef, () => update());\n    onBeforeUnmount(() => {\n      tabObservers.forEach(observer => observer.stop());\n      tabObservers.length = 0;\n      barObserver.stop();\n    });\n    __expose({\n      ref: barRef,\n      update\n    });\n    return (_ctx, _cache) => {\n      return renderActiveBar.value ? (openBlock(), createElementBlock(\"div\", {\n        key: 0,\n        ref_key: \"barRef\",\n        ref: barRef,\n        class: normalizeClass([unref(ns).e(\"active-bar\"), unref(ns).is(unref(rootTabs).props.tabPosition)]),\n        style: normalizeStyle(barStyle.value)\n      }, null, 6)) : createCommentVNode(\"v-if\", true);\n    };\n  }\n});\nvar TabBar = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/tabs/src/tab-bar.vue\"]]);\nexport { TabBar as default };","map":{"version":3,"names":["COMPONENT_NAME","props","__props","rootTabs","inject","tabsRootContextKey","throwError","ns","useNamespace","barRef","ref","barStyle","renderActiveBar","computed","isUndefined","defaultValue","Boolean","_a","value","transform","getBarStyle","offset","tabSize","sizeName","includes","tabPosition","sizeDir","position","tabs","every","tab","paneName","$el","tabRefs","active","capitalize","tabStyles","window","getComputedStyle","Number","parseFloat","paddingLeft","paddingRight","update","tabObservers","observerTabs","forEach","observer","stop","length","Object","values","push","useResizeObserver","watch","nextTick","immediate","barObserver","onBeforeUnmount","__expose","openBlock","createElementBlock","key","ref_key","class","normalizeClass","unref","e","is","style","normalizeStyle"],"sources":["../../../../../../packages/components/tabs/src/tab-bar.vue"],"sourcesContent":["<template>\n  <div\n    v-if=\"renderActiveBar\"\n    ref=\"barRef\"\n    :class=\"[ns.e('active-bar'), ns.is(rootTabs!.props.tabPosition)]\"\n    :style=\"barStyle\"\n  />\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, inject, nextTick, onBeforeUnmount, ref, watch } from 'vue'\nimport { useResizeObserver } from '@vueuse/core'\nimport { capitalize, isUndefined, throwError } from '@element-plus/utils'\nimport { useNamespace } from '@element-plus/hooks'\nimport { tabsRootContextKey } from './constants'\nimport { tabBarProps } from './tab-bar'\n\nimport type { CSSProperties } from 'vue'\n\nconst COMPONENT_NAME = 'ElTabBar'\ndefineOptions({\n  name: COMPONENT_NAME,\n})\nconst props = defineProps(tabBarProps)\n\nconst rootTabs = inject(tabsRootContextKey)\nif (!rootTabs) throwError(COMPONENT_NAME, '<el-tabs><el-tab-bar /></el-tabs>')\n\nconst ns = useNamespace('tabs')\n\nconst barRef = ref<HTMLDivElement>()\nconst barStyle = ref<CSSProperties>()\n/**\n * when defaultValue is not set, the bar is always shown.\n *\n * when defaultValue is set, the bar will be hidden until style is calculated\n * to avoid the bar showing in the wrong position on initial render.\n */\nconst renderActiveBar = computed(\n  () =>\n    isUndefined(rootTabs.props.defaultValue) ||\n    Boolean(barStyle.value?.transform)\n)\n\nconst getBarStyle = (): CSSProperties => {\n  let offset = 0\n  let tabSize = 0\n\n  const sizeName = ['top', 'bottom'].includes(rootTabs.props.tabPosition)\n    ? 'width'\n    : 'height'\n  const sizeDir = sizeName === 'width' ? 'x' : 'y'\n  const position = sizeDir === 'x' ? 'left' : 'top'\n\n  props.tabs.every((tab) => {\n    if (isUndefined(tab.paneName)) return false\n    const $el = props.tabRefs[tab.paneName]\n    if (!$el) return false\n\n    if (!tab.active) {\n      return true\n    }\n\n    offset = $el[`offset${capitalize(position)}`]\n    tabSize = $el[`client${capitalize(sizeName)}`]\n\n    const tabStyles = window.getComputedStyle($el)\n\n    if (sizeName === 'width') {\n      tabSize -=\n        Number.parseFloat(tabStyles.paddingLeft) +\n        Number.parseFloat(tabStyles.paddingRight)\n      offset += Number.parseFloat(tabStyles.paddingLeft)\n    }\n    return false\n  })\n\n  return {\n    [sizeName]: `${tabSize}px`,\n    transform: `translate${capitalize(sizeDir)}(${offset}px)`,\n  }\n}\n\nconst update = () => (barStyle.value = getBarStyle())\n\nconst tabObservers = [] as ReturnType<typeof useResizeObserver>[]\nconst observerTabs = () => {\n  tabObservers.forEach((observer) => observer.stop())\n  tabObservers.length = 0\n\n  Object.values(props.tabRefs).forEach((tab) => {\n    tabObservers.push(useResizeObserver(tab, update))\n  })\n}\n\nwatch(\n  () => props.tabs,\n  async () => {\n    await nextTick()\n    update()\n\n    observerTabs()\n  },\n  { immediate: true }\n)\nconst barObserver = useResizeObserver(barRef, () => update())\n\nonBeforeUnmount(() => {\n  tabObservers.forEach((observer) => observer.stop())\n  tabObservers.length = 0\n  barObserver.stop()\n})\n\ndefineExpose({\n  /** @description tab root html element */\n  ref: barRef,\n  /** @description method to manually update tab bar style */\n  update,\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}