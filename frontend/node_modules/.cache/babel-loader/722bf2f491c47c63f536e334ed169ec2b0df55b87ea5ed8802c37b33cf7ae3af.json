{"ast":null,"code":"import { isAndroid } from '../browser.mjs';\nimport { EVENT_CODE } from '../../constants/aria.mjs';\nconst composeEventHandlers = (theirsHandler, oursHandler, {\n  checkForDefaultPrevented = true\n} = {}) => {\n  const handleEvent = event => {\n    const shouldPrevent = theirsHandler == null ? void 0 : theirsHandler(event);\n    if (checkForDefaultPrevented === false || !shouldPrevent) {\n      return oursHandler == null ? void 0 : oursHandler(event);\n    }\n  };\n  return handleEvent;\n};\nconst whenMouse = handler => {\n  return e => e.pointerType === \"mouse\" ? handler(e) : void 0;\n};\nconst getEventCode = event => {\n  if (event.code && event.code !== \"Unidentified\") return event.code;\n  const key = getEventKey(event);\n  if (key) {\n    if (Object.values(EVENT_CODE).includes(key)) return key;\n    switch (key) {\n      case \" \":\n        return EVENT_CODE.space;\n      default:\n        return \"\";\n    }\n  }\n  return \"\";\n};\nconst getEventKey = event => {\n  let key = event.key && event.key !== \"Unidentified\" ? event.key : \"\";\n  if (!key && event.type === \"keyup\" && isAndroid()) {\n    const target = event.target;\n    key = target.value.charAt(target.selectionStart - 1);\n  }\n  return key;\n};\nexport { composeEventHandlers, getEventCode, getEventKey, whenMouse };","map":{"version":3,"names":["composeEventHandlers","theirsHandler","oursHandler","checkForDefaultPrevented","handleEvent","event","shouldPrevent","whenMouse","handler","e","pointerType","getEventCode","code","key","getEventKey","Object","values","EVENT_CODE","includes","space","type","isAndroid","target","value","charAt","selectionStart"],"sources":["../../../../../packages/utils/dom/event.ts"],"sourcesContent":["import { EVENT_CODE } from '@element-plus/constants'\nimport { isAndroid } from '../browser'\n\nexport const composeEventHandlers = <E>(\n  theirsHandler?: (event: E) => boolean | void,\n  oursHandler?: (event: E) => void,\n  { checkForDefaultPrevented = true } = {}\n) => {\n  const handleEvent = (event: E) => {\n    const shouldPrevent = theirsHandler?.(event)\n\n    if (checkForDefaultPrevented === false || !shouldPrevent) {\n      return oursHandler?.(event)\n    }\n  }\n  return handleEvent\n}\n\ntype WhenMouseHandler = (e: PointerEvent) => any\nexport const whenMouse = (handler: WhenMouseHandler): WhenMouseHandler => {\n  return (e: PointerEvent) =>\n    e.pointerType === 'mouse' ? handler(e) : undefined\n}\n\nexport const getEventCode = (event: KeyboardEvent): string => {\n  if (event.code && event.code !== 'Unidentified') return event.code\n  // On android, event.code is always '' (see https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/code#browser_compatibility)\n  const key = getEventKey(event)\n\n  if (key) {\n    if (Object.values(EVENT_CODE).includes(key)) return key\n\n    switch (key) {\n      case ' ':\n        return EVENT_CODE.space\n      default:\n        return ''\n    }\n  }\n\n  return ''\n}\n\nexport const getEventKey = (event: KeyboardEvent): string => {\n  let key = event.key && event.key !== 'Unidentified' ? event.key : ''\n\n  // On Android, event.key and event.code may not be useful when entering characters or space\n  // So here we directly get the last character of the input\n  // **only takes effect in the keyup event**\n  if (!key && event.type === 'keyup' && isAndroid()) {\n    const target = event.target as HTMLInputElement\n    key = target.value.charAt(target.selectionStart! - 1)\n  }\n\n  return key\n}\n"],"mappings":";;AAGa,MAAAA,oBAAA,GAAuBA,CAClCC,aACA,EAAAC,WAAA,EACA;EAAEC,wBAA2B;AAAA,CAAS,KACnC;EACG,MAAAC,WAAA,GAAeC,KAAa;IAChC,MAAMC,aAAA,GAAgBL,aAAgB,oBAAAA,aAAA,CAAAI,KAAA;IAElC,IAAAF,wBAAA,KAA6B,KAAS,KAACG,aAAe;MACxD,OAAOJ,WAAc,oBAAAA,WAAA,CAAAG,KAAA;IAAA;EACvB,CACF;EACO,OAAAD,WAAA;AACT;AAGa,MAAAG,SAAA,GAAaC,OAAgD;EACxE,OAAQC,CACN,IAAAA,CAAA,CAAEC,WAAA,KAAgB,OAAU,GAAAF,OAAA,CAAQC,CAAC,CAAI;AAC7C;AAEa,MAAAE,YAAA,GAAgBN,KAAiC;EACxD,IAAAA,KAAA,CAAMO,IAAQ,IAAAP,KAAA,CAAMO,IAAS,qBAAgB,OAAOP,KAAM,CAAAO,IAAA;EAExD,MAAAC,GAAA,GAAMC,WAAA,CAAYT,KAAK;EAE7B,IAAIQ,GAAK;IACP,IAAIE,MAAO,CAAAC,MAAA,CAAOC,UAAU,EAAEC,QAAA,CAASL,GAAG,GAAU,OAAAA,GAAA;IAE5C,QAAAA,GAAA;MACD;QACH,OAAOI,UAAW,CAAAE,KAAA;MAAA;QAEX;IAAA;EAAA;EAIN;AACT;AAEa,MAAAL,WAAA,GAAeT,KAAiC;EAC3D,IAAIQ,GAAA,GAAMR,KAAM,CAAAQ,GAAA,IAAOR,KAAA,CAAMQ,GAAQ,sBAAiBR,KAAA,CAAMQ,GAAM;EAKlE,IAAI,CAACA,GAAO,IAAAR,KAAA,CAAMe,IAAS,gBAAWC,SAAA,EAAa;IACjD,MAAMC,MAAA,GAASjB,KAAM,CAAAiB,MAAA;IACrBT,GAAA,GAAMS,MAAO,CAAAC,KAAA,CAAMC,MAAO,CAAAF,MAAA,CAAOG,cAAA,GAAkB,CAAC;EAAA;EAG/C,OAAAZ,GAAA;AACT","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}